{
  "Detection": [
    "Technique",
    "Technique",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection called \"Rundll32 Execution\" was generated due to the execution of rundll32.exe on kxwn.lock.",
    "A Technique alert detection called \"Rundll32 Not Running DLL\" was generated due to rundll32.exe executing kxwn.lock, which did not have a .dll extension.",
    "An MSSP detection occurred for rundll32.exe executing kxwn.lock.",
    "Telemetry showed rundll32.exe executing kxwn.lock."
  ],
  "Procedure": "Executed Run key persistence payload on user login using RunDll32",
  "Step": "20.A.1",
  "TacticGroup": "Execution",
  "Technique": "T1085",
  "TechniqueName": "Rundll32"
}
{
  "Detection": [
    "General",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Configuration Change (Detections)",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A General alert detection called \"User Directory File Write\" was generated due to the file monkey.png being written to the user's desktop.",
    "An MSSP detection occurred containing evidence of rcs.3aka3.doc creating the monkey.png.",
    "Telemetry showed rcs.3aka3.doc creating monkey.png."
  ],
  "Procedure": "Dropped stage 2 payload (monkey.png) to disk",
  "Step": "3.A.1",
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "TechniqueName": "Remote File Copy"
}
{
  "Detection": [
    "General",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "A General alert detection was generated for a ZIP archive being written to disk. ",
    "An MSSP detection occurred containing evidence of  file write of the ZIP by PowerShell. ",
    "Telemetry showed the file write of the ZIP by PowerShell. The detection was correlated to a parent alert for a PowerShell process."
  ],
  "Procedure": "Dropped additional tools (SysinternalsSuite.zip) to disk over C2 channel (192.168.0.5)",
  "Step": "4.A.1",
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "TechniqueName": "Remote File Copy"
}
{
  "Detection": [
    "Technique",
    "Technique",
    "General",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert",
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection called \"File Write to Network Share\" was generated due to a file write event for python.exe to a remote network share.",
    "A Technique alert detection called \"WebDav Network Request\" was generated due to a WebDav user-agent used to GET python.exe from a WebDav network share.",
    "A General alert detection was generated for classifying python.exe as malware, which also showed it was written by PowerShell to a remote network share.",
    "An MSSP detection showed the file write event of python.exe.",
    "Telemetry showed the file write event of python.exe."
  ],
  "Procedure": "Copied python.exe payload from a WebDAV share (192.168.0.4) to remote host Scranton (10.0.1.4)",
  "Step": "8.B.1",
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "TechniqueName": "Remote File Copy"
}
{
  "Detection": [
    "General",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Configuration Change (Detections)",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A General alert detection called \"Temp Directory PE Write\" was generated due to python.exe writing rar.exe to C:\\Windows\\Temp.",
    "An MSSP detection occurred for python.exe creating rar.exe.",
    "Telemetry showed file write event for python.exe creating rar.exe."
  ],
  "Procedure": "Dropped rar.exe to disk on remote host Scranton (10.0.1.4)\u00a0",
  "Step": "9.A.1",
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "TechniqueName": "Remote File Copy"
}
{
  "Detection": [
    "General",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Configuration Change (Detections)",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A General alert detection called \"Temp Directory PE Write\" was generated due to python.exe writing sdelete64.exe to C:\\Windows\\Temp.",
    "A MSSP detection occurred for python.exe creating sdelete64.exe.",
    "Telemetry showed File Write event for python.exe creating sdelete64.exe"
  ],
  "Procedure": "Dropped sdelete.exe to disk on remote host Scranton (10.0.1.4)\u00a0",
  "Step": "9.A.2",
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "TechniqueName": "Remote File Copy"
}
{
  "Detection": [
    "Technique",
    "Technique",
    "Technique",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert",
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection called \"PowerShell File Write\" was generated for PowerShell writing m.exe to disk.",
    "A Technique alert detection called \"PowerShell URL Request\" was generated due to a URL request from PowerShell for m.exe.",
    "A Technique alert detection was generated for suspicious PowerShell usage with encoded commands associated with download cradles.",
    "An MSSP detection contained evidence of the creation of m.exe in the System32 folder.",
    "Telemetry showed the PowerShell command to download m.exe. Telemetry also showed the file write event for m.exe into the System32 folder."
  ],
  "Procedure": "Downloaded and dropped Mimikatz (m.exe) to disk",
  "Step": "14.B.3",
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "TechniqueName": "Remote File Copy"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "An MSSP detection contained evidence of the write of m.exe to the System32 directory by wsmprovhost.exe.",
    "Telemetry showed the file write of m.exe to System32 directory by wsmprovhost.exe. The detection was correlated to parent alert on the wsmprovhost.exe."
  ],
  "Procedure": "Dropped Mimikatz (m.exe) to disk on the domain controller host NewYork (10.0.0.4) over a WinRM connection",
  "Step": "16.D.1",
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "TechniqueName": "Remote File Copy"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "A MSSP detection occurred for the Deletion of the registry value.",
    "Telemetry showed the deletion of the command subkey. This was correlated with a prior detection of the PowerShell parent process."
  ],
  "Procedure": "Modified the Registry to remove artifacts of COM hijacking",
  "Step": "3.C.1",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1112",
  "TechniqueName": "Modify Registry"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred for the deletion of the command subkey Registry value. ",
    "Telemetry showed PowerShell command to delete the Registry value."
  ],
  "Procedure": "Modified the Registry to remove artifacts of COM hijacking using PowerShell",
  "Step": "14.A.3",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1112",
  "TechniqueName": "Modify Registry"
}
{
  "Detection": [
    "Technique",
    "General",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection called \"PowerShell Execution\" was generated due to powershell.exe spawning from cmd.exe.",
    "A General alert detection was generated for cmd.exe spawning a child process.",
    "An MSSP detection occurred for powershell.exe spawning from cmd.exe.",
    "Telemetry showed powershell.exe spawning from cmd.exe."
  ],
  "Procedure": "Spawned interactive powershell.exe",
  "Step": "1.B.2",
  "TacticGroup": "Execution",
  "Technique": "T1086",
  "TechniqueName": "PowerShell"
}
{
  "Detection": [
    "Technique",
    "General",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert"
  ],
  "DetectionText": [
    "A Technique alert detection called \"PowerShell Execution\" was generated due to the execution of powershell.exe, which was used to execute powershell.exe.",
    "A General alert detection for PowerShell child process was generated for powershell.exe spawning a child process.",
    "Telemetry showed a new powershell.exe spawning from powershell.exe. "
  ],
  "Procedure": "Spawned interactive powershell.exe",
  "Step": "4.A.2",
  "TacticGroup": "Execution",
  "Technique": "T1086",
  "TechniqueName": "PowerShell"
}
{
  "Detection": [
    "Technique",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "A Technique alert detection called \"PowerShell Execution\" was generated due to python.exe spawning powershell.exe.",
    "A MSSP detection occurred for python.exe executing powershell.exe.",
    "Telemetery showed python.exe executing powershell.exe. This event was correlated to prior detection for the python.exe process."
  ],
  "Procedure": "Spawned interactive powershell.exe",
  "Step": "9.B.1",
  "TacticGroup": "Execution",
  "Technique": "T1086",
  "TechniqueName": "PowerShell"
}
{
  "Detection": [
    "Technique",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection called \"POWERSHELL.EXE IEX ENCODED COMMAND (METHODOLOGY)\" was generated due to encoded PowerShell IEX execution.",
    "An MSSP detection occurred for the PowerShell stager executing (IEX) from schemas.",
    "Telemetry showed powershell.exe spawned from a PowerShell stager."
  ],
  "Procedure": "Executed PowerShell stager payload",
  "Step": "11.A.12",
  "TacticGroup": "Execution",
  "Technique": "T1086",
  "TechniqueName": "PowerShell"
}
{
  "Detection": [
    "Technique",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection called \"PowerShell Network Connection\" was generated due to the SYSTEM level PowerShell spawned from wmiprvse.exe making a network connection.",
    "An MSSP detection occurred for a SYSTEM-level PowerShell spawned from the WindowsParentalControlMigration WMI event subscription.",
    "Telemetry showed SYSTEM-level PowerShell spawned from wmiprvse.exe."
  ],
  "Procedure": "Executed PowerShell payload from WMI event subscription persistence",
  "Step": "20.A.3",
  "TacticGroup": "Execution",
  "Technique": "T1086",
  "TechniqueName": "PowerShell"
}
{
  "Detection": [
    "Technique",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection called \"PsExec Execution\" was generated due to PSEXESVC.exe spawning the child process python.exe.",
    "An MSSP detection occurred containing evidence of python.exe being spawned by PSEXESVC.exe.",
    "Telemetry showed python.exe spawned by PSEXESVC.exe."
  ],
  "Procedure": "Executed python.exe using PSExec",
  "Step": "8.C.3",
  "TacticGroup": "Execution",
  "Technique": "T1035",
  "TechniqueName": "Service Execution"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "Executed persistent service (javamtsup) on system startup",
  "Step": "10.A.1",
  "TacticGroup": "Execution",
  "Technique": "T1035",
  "TechniqueName": "Service Execution"
}
{
  "Detection": [
    "Technique",
    "General",
    "General",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Configuration Change (Detections)",
    "Alert",
    "Alert",
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "A Technique alert detection called \"Web Service C2\" was generated due to an abnormal application making requests for common web services.",
    "A General alert detection was generated for execution of the \"net use\" command.",
    "A General alert detection was generated for WebDav activity when mapping the OneDrive URL.",
    "An MSSP detection occurred for net.exe connecting to a OneDrive URL.",
    "Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. This detection was correlated to a parent alert for a PowerShell process than ran net.exe."
  ],
  "Procedure": "Mapped a network drive to an online OneDrive account using PowerShell",
  "Step": "18.A.1",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1102",
  "TechniqueName": "Web Service"
}
{
  "Detection": [
    "General",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A General alert detection was generated for LDAP connection from Nashua (10.0.1.6) to NewYork (10.0.0.4) over port 389.",
    "An MSSP detection occurred for PowerShell being used to enumerate Active Directory hosts.",
    "Telemetry showed powershell.exe establishing a connection to NewYork (10.0.0.4) over TCP port 389. "
  ],
  "Procedure": "Enumerated remote systems using LDAP queries",
  "Step": "8.A.1",
  "TacticGroup": "Discovery",
  "Technique": "T1018",
  "TechniqueName": "Remote System Discovery"
}
{
  "Detection": [
    "General",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "A General alert detection was generated for PowerShell making a LDAP network connections over port 389 to the domain controller NewYork (10.0.0.4)",
    "Telemetry showed PowerShell making a network connection over port 389 to the domain controller NewYork (10.0.0.4). "
  ],
  "Procedure": "Enumerated the domain controller host NewYork (10.0.0.4) using LDAP queries",
  "Step": "16.A.1",
  "TacticGroup": "Discovery",
  "Technique": "T1018",
  "TechniqueName": "Remote System Discovery"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of the successful logon of Pam on Scranton (10.0.1.4).",
    "Telemetry showed an account logged on to Scranton (10.0.1.4) as user Pam."
  ],
  "Procedure": "Logged on to remote host Scranton (10.0.1.4) using\u00a0valid credentials for user Pam",
  "Step": "8.C.1",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1078",
  "TechniqueName": "Valid Accounts"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection contained evidence of the successful logon of MScott on NewYork (10.0.0.4).",
    "Telemetry showed a successful logon on NewYork (10.0.0.4) as user MScott."
  ],
  "Procedure": "Logged on to the domain controller host NewYork (10.0.0.4) using\u00a0valid credentials for user MScott\u00a0",
  "Step": "16.C.2",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1078",
  "TechniqueName": "Valid Accounts"
}
{
  "Detection": [
    "Technique",
    "General",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection called \"RTL OVERRIDE ATTACK (METHODOLOGY)\" was generated due to rcs.3aka3.doc containing a RTLO character with an MZ header value.",
    "A General alert detection was generated for Generic.Exploit.Shellcode on rcs.3aka3.doc.",
    "A MSSP detection occurred for the RTLO character in rcs.3aka.doc."
  ],
  "Procedure": "Used unicode right-to-left override (RTLO) character to obfuscate file name rcs.3aka3.doc (originally cod.3aka.scr)",
  "Step": "1.A.2",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1036",
  "TechniqueName": "Masquerading"
}
{
  "Detection": [
    "Technique",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Configuration Change (Detections)",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection called \"Sysinternals Masquerade\" was generated due to the process accesschk.exe executing without accepting the EULA.",
    "An MSSP detection occurred indicating that accesschk.exe is not the legitimate Sysinternals tool.",
    "Telemetry showed hash of accesschk.exe which can be used to verify it is not the legitimate Sysinternals tool."
  ],
  "Procedure": "Masqueraded a Chrome password dump tool as accesscheck.exe, a legitimate Sysinternals tool",
  "Step": "6.A.3",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1036",
  "TechniqueName": "Masquerading"
}
{
  "Detection": [
    "MSSP",
    "None"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred for the rcs.3aka3.doc process using rc4 encryption for network communication.",
    "No detection capability demonstrated for this procedure, though data showed rcs.3aka3.doc loading cryptographic libraries."
  ],
  "Procedure": "Used RC4 stream cipher to encrypt C2 (192.168.0.5) traffic",
  "Step": "1.A.4",
  "TacticGroup": "Command and Control",
  "Technique": "T1032",
  "TechniqueName": "Standard Cryptographic Protocol"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [
    "Residual Artifact"
  ],
  "DetectionText": [
    "No detection capability demonstrated for this procedure, though process memory for the PowerShell process indicated the data exchange was over HTTPS."
  ],
  "Procedure": "Used HTTPS to encrypt C2 (192.168.0.5) traffic",
  "Step": "3.B.5",
  "TacticGroup": "Command and Control",
  "Technique": "T1032",
  "TechniqueName": "Standard Cryptographic Protocol"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "Used HTTPS to encrypt C2 (192.168.0.4) traffic",
  "Step": "11.A.15",
  "TacticGroup": "Command and Control",
  "Technique": "T1032",
  "TechniqueName": "Standard Cryptographic Protocol"
}
{
  "Detection": [
    "Technique",
    "General",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert",
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "A Technique alert detection called \"Startup Folder Persistence\" was generated due to the creation of a file in the Start Menu Startup folder.",
    "A General alert detection was generated due to a suspicious LNK file. ",
    "An MSSP detection occurred for the creation of the hostui.lnk file in the Startup folder.",
    "Telemetry showed PowerShell creating the hostui.lnk file in the Startup folder. The event was correlated to a parent detection for PowerShell."
  ],
  "Procedure": "Created a LNK file (hostui.lnk) in the Startup folder that executes on login",
  "Step": "5.B.1",
  "TacticGroup": "Persistence",
  "Technique": "T1060",
  "TechniqueName": "Registry Run Keys / Startup Folder"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure, though execution of hostui.bat was observed."
  ],
  "Procedure": "Executed LNK payload (hostui.lnk) in Startup Folder on user login",
  "Step": "10.B.1",
  "TacticGroup": "Persistence",
  "Technique": "T1060",
  "TechniqueName": "Registry Run Keys / Startup Folder"
}
{
  "Detection": [
    "Technique",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection called \"Run Key Persistence\" was generated due to the modification of \"run\" Registry persistence keys.",
    "An MSSP detection contained evidence of the Webcache subkey added to the Registry to establish persistence.",
    "Telemetry showed powershell.exe adding Run key persistence into the Registry."
  ],
  "Procedure": "Established Registry Run key persistence using PowerShell",
  "Step": "11.A.11",
  "TacticGroup": "Persistence",
  "Technique": "T1060",
  "TechniqueName": "Registry Run Keys / Startup Folder"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection was generated containing evidence of observed UPX packing on a Python payload.",
    "Telemetry showed that python.exe had entropy, indicating the file was packed."
  ],
  "Procedure": "python.exe payload was packed with UPX",
  "Step": "8.B.2",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1045",
  "TechniqueName": "Software Packing"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred for the addition of the DelegateExecute Registry Value.",
    "Telemetry showed the addition of the DelegateExecute Registry Value."
  ],
  "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell",
  "Step": "3.B.1",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1122",
  "TechniqueName": "Component Object Model Hijacking"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    " An MSSP detection occurred for the addition of the DelegateExecute Registry value.",
    "Telemetry showed the addition of the DelegateExecute Registry value."
  ],
  "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell",
  "Step": "14.A.1",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1122",
  "TechniqueName": "Component Object Model Hijacking"
}
{
  "Detection": [
    "Technique",
    "General",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert",
    "Configuration Change (Detections)",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection called \"Execution from User Directory\" was generated due to the rcs.3aka3.doc process executing from a user's desktop.",
    "A General alert detection was generated for a new application in AppCompat, indicating an application executing for the first time.",
    "An MSSP detection occurred for user Pam executing rcs.3aka3.doc.",
    "Telemetry showed explorer.exe executing rcs.3aka3.doc."
  ],
  "Procedure": "User Pam executed payload rcs.3aka3.doc",
  "Step": "1.A.1",
  "TacticGroup": "Execution",
  "Technique": "T1204",
  "TechniqueName": "User Execution"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection was generated containing evidence user Oscar executed 37486-the-shockingtruth-about-election-rigging-in-america.rtf.lnk.",
    "Telemetry showed explorer.exe executing powershell.exe. "
  ],
  "Procedure": "User Oscar executed payload 37486-the-shocking-truth-about-election-rigging-in-america.rtf.lnk",
  "Step": "11.A.1",
  "TacticGroup": "Execution",
  "Technique": "T1204",
  "TechniqueName": "User Execution"
}
{
  "Detection": [
    "Technique",
    "General",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection called \"Service Persistence\" was generated due to the modification of Windows service Registry keys when the javamtsup service was created.",
    "A General alert detection was generated for javamtsup.exe being classified as malware.",
    "An MSSP detection occurred for the creation of the javamtsup service.",
    "Telemetry showed PowerShell created the new service javamtsup."
  ],
  "Procedure": "Created a new service (javamtsup) that executes a service binary (javamtsup.exe) at system startup",
  "Step": "5.A.1",
  "TacticGroup": "Persistence",
  "Technique": "T1050",
  "TechniqueName": "New Service"
}
{
  "Detection": [
    "Technique",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Configuration Change (Detections)",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection called \"PowerShell System.Drawing Load\" was generated due to powershell.exe loading System.Drawing.ni.dll, indicating possible Screen Capture.",
    "An MSSP detection occurred containing evidence of powershell.exe executing Invoke-ScreenCapture to capture screen shots.",
    "Telemetry showed powershell.exe executing CopyFromScreen from System.Drawing.dll."
  ],
  "Procedure": "Captured and saved screenshots using PowerShell",
  "Step": "7.A.1",
  "TacticGroup": "Collection",
  "Technique": "T1113",
  "TechniqueName": "Screen Capture"
}
{
  "Detection": [
    "Technique",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "A Technique alert detection called \"CMD Execution\" was generated due to cmd.exe spawning from rcs.3aka3.doc.",
    "An MSSP detection occurred for cmd.exe spawning from rcs.3aka3.doc\u200b.",
    "Telemetry showed rcs.3aka3.doc spawning from cmd.exe\u200b. This was correlated to a parent alert on rcs.3aka3.doc."
  ],
  "Procedure": "Spawned interactive cmd.exe",
  "Step": "1.B.1",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "TechniqueName": "Command-Line Interface"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of powershell.exe executing Get-Clipboard.",
    "Telemetry showed powershell.exe executing Get-Clipboard."
  ],
  "Procedure": "Captured clipboard contents using PowerShell",
  "Step": "7.A.2",
  "TacticGroup": "Collection",
  "Technique": "T1115",
  "TechniqueName": "Clipboard Data"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A MSSP detection occurred for powershell.exe executing: $env:USERDOMAIN.",
    "Telemetry showed powershell.exe executing: $env:USERDOMAIN."
  ],
  "Procedure": "Enumerated the current domain name using PowerShell",
  "Step": "4.C.4",
  "TacticGroup": "Discovery",
  "Technique": "T1016",
  "TechniqueName": "System Network Configuration Discovery"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred for the PowerShell gwmi query for Win32_ComputerSystem.",
    "Telemetry showed powershell.exe gwmi query for Win32_ComputerSystem."
  ],
  "Procedure": "Checked that the computer is joined to a domain using PowerShell",
  "Step": "11.A.7",
  "TacticGroup": "Discovery",
  "Technique": "T1016",
  "TechniqueName": "System Network Configuration Discovery"
}
{
  "Detection": [
    "General",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Configuration Change (Detections)"
  ],
  "DetectionText": [
    "A General alert detection was generated for PowerShell loading netapi32.dll, which contains functions for user and group discovery, including NetWkstaGetInfo.",
    "Telemetry showed PowerShell calling the NetWkstaGetInfo API."
  ],
  "Procedure": "Enumerated the domain name using the NetWkstaGetInfo API",
  "Step": "13.B.1",
  "TacticGroup": "Discovery",
  "Technique": "T1016",
  "TechniqueName": "System Network Configuration Discovery"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence Invoke-Exfil was used to compress and encrypt data for exfiltration.",
    "Telemetry showed powershell.exe executing Compress-7Zip with arguments for encryption."
  ],
  "Procedure": "Encrypted data from the user's Downloads directory using PowerShell",
  "Step": "7.B.3",
  "TacticGroup": "Exfiltration",
  "Technique": "T1022",
  "TechniqueName": "Data Encrypted"
}
{
  "Detection": [
    "Technique",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection called \"Encrypted RAR Archive Command\" \"T1022\" was generated when rar.exe used \"-hp\" command-line arguments.",
    "An MSSP detection contained evidence of execution of rar.exe with command line arguments to encrypt working.zip.",
    "Telemetry showed powershell.exe executing rar.exe with command-line arguments."
  ],
  "Procedure": "Encrypted staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe",
  "Step": "9.B.6",
  "TacticGroup": "Exfiltration",
  "Technique": "T1022",
  "TechniqueName": "Data Encrypted"
}
{
  "Detection": [
    "General",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A General alert detection was generated for a non-standard process loading the Windows credential management library vaultcli.dll.",
    "An MSSP detection occurred for Invoke-Mimikatz (kerberos::golden) to create and inject a golden ticket into the current session.",
    "Telemetry showed the contents of the Invoke-Mimikatz script along with PowerShell executing Invoke-Mimikatz to create and inject a golden ticket into current session."
  ],
  "Procedure": "Created Kerberos Golden Ticket using\u00a0Invoke-Mimikatz",
  "Step": "20.B.1",
  "TacticGroup": "Lateral Movement",
  "Technique": "T1097",
  "TechniqueName": "Pass the Ticket"
}
{
  "Detection": [
    "General",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A General detection was generated for PowerShell making a network connection.",
    "An MSSP detection occurred for powershell.exe connecting to 192.168.0.5 on TCP 443."
  ],
  "Procedure": "Established C2 channel (192.168.0.5) via PowerShell payload over TCP port 443",
  "Step": "3.B.3",
  "TacticGroup": "Command and Control",
  "Technique": "T1043",
  "TechniqueName": "Commonly Used Port"
}
{
  "Detection": [
    "General",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A General alert detection was generated for PowerShell making a network connection.",
    "An MSSP detection occurred for PowerShell making network connection to C2 (192.168.0.4) over port 443.",
    "Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over TCP port 443."
  ],
  "Procedure": "Established C2 channel (192.168.0.4) via PowerShell payload over port 443",
  "Step": "11.A.13",
  "TacticGroup": "Command and Control",
  "Technique": "T1043",
  "TechniqueName": "Commonly Used Port"
}
{
  "Detection": [
    "Technique",
    "General",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection called \"WinRM Network Connection\" was generated due to a connection to remote host Scranton (10.0.1.4) over port 5985.",
    "A General alert detection was generated for PowerShell making a URL request, which contained indications the network connection was using WinRM.",
    "An MSSP detection occurred for the WinRM connection to remote host Scranton (10.0.1.4) over port 5985.",
    "Telemetry showed a connection to Scranton (10.0.1.4) over port 5985."
  ],
  "Procedure": "Established WinRM connection to remote host Scranton (10.0.1.4)",
  "Step": "8.A.2",
  "TacticGroup": "Execution",
  "Technique": "T1028",
  "TechniqueName": "Windows Remote Management"
}
{
  "Detection": [
    "Technique",
    "General",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection called \"WinRM Network Connection\" was generated for powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985.",
    "A General alert detection was generated for a PowerShell URL request to NewYork (10.0.0.4) on port 5895.",
    "An MSSP detection contained evidence of a WinRM connection on NewYork (10.0.0.4).",
    "Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985."
  ],
  "Procedure": "Established a WinRM connection to the domain controller host NewYork (10.0.0.4) ",
  "Step": "16.C.1",
  "TacticGroup": "Execution",
  "Technique": "T1028",
  "TechniqueName": "Windows Remote Management"
}
{
  "Detection": [
    "Technique",
    "General",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection called \"WinRM Network Connection\" was generated for PowerShell with an open network connection to the remote host Scranton (10.0.1.4) over port 5985.",
    "A General alert detection was generated for PowerShell making a URL request when the WinRM connection was made to Scranton (10.0.1.4) over port 5985.",
    "An MSSP detection occurred for the WinRM session to remote host Scranton (10.0.1.4) over port 5985.",
    "Telemetry showed PowerShell with an open network connection to the remote host Scranton (10.0.1.4) over port 5985."
  ],
  "Procedure": "Established a WinRM connection to the remote host Scranton (10.0.1.4) using the Golden Ticket as credentials",
  "Step": "20.B.2",
  "TacticGroup": "Execution",
  "Technique": "T1028",
  "TechniqueName": "Windows Remote Management"
}
{
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred for accesschk.exe making Windows API call: CryptUnprotectedData."
  ],
  "Procedure": "Executed the CryptUnprotectedData API call to decrypt Chrome passwords",
  "Step": "6.A.2",
  "TacticGroup": "Credential Access",
  "Technique": "T1003",
  "TechniqueName": "Credential Dumping"
}
{
  "Detection": [
    "General",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A General detection in Process Guard Watcher was generated due to powershell.exe injecting into lsass.exe. ",
    "An MSSP detection identified PowerShell injecting into the LSASS process. This activity was labeled as credential harvesting."
  ],
  "Procedure": "Dumped password hashes from the Windows Registry by injecting a malicious DLL into Lsass.exe",
  "Step": "6.C.1",
  "TacticGroup": "Credential Access",
  "Technique": "T1003",
  "TechniqueName": "Credential Dumping"
}
{
  "Detection": [
    "Technique",
    "General",
    "General",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert",
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection called \"MIMIKATZ SUSPICIOUS PROCESS ARGUMENTS A (METHODOLOGY)\" was generated for the execution of m.exe executing with command-line arguments indicative of Mimikatz credential dumping.",
    "A General alert detection called \"Vaultcli.dll Load\" was generated due to a non-standard process, m.exe, loading vaultcli.dll.",
    "A General alert detection was generated for m.exe being Mimikatz malware.",
    "An MSSP detection contained evidence of Mimikatz dumping credentials.",
    "Telemetry showed a process access into lsass.exe."
  ],
  "Procedure": "Dumped plaintext credentials using Mimikatz (m.exe)",
  "Step": "14.B.4",
  "TacticGroup": "Credential Access",
  "Technique": "T1003",
  "TechniqueName": "Credential Dumping"
}
{
  "Detection": [
    "Technique",
    "Technique",
    "General",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert",
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection called \"MIMIKATZ SUSPICIOUS PROCESS ARGUMENTS A (METHODOLOGY)\" was generated due to command line arguments indicating the use of Mimikatz.",
    "A Technique alert detection called \"Vaultcli.dll Load\" was generated due to a non-standard process, m.exe, loading a Windows credential management library (vaultcli.dll).",
    "A General alert detection was generated for m.exe being identified as Mimikatz malware.",
    "An MSSP detection occurred for Mimikatz usage to dump credentials for the krbtgt account."
  ],
  "Procedure": "Dumped the KRBTGT hash on the domain controller host NewYork (10.0.0.4) using Mimikatz (m.exe)",
  "Step": "16.D.2",
  "TacticGroup": "Credential Access",
  "Technique": "T1003",
  "TechniqueName": "Credential Dumping"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred for the PowerShell gwmi query for Win32_BIOS.",
    "Telemetry showed the PowerShell gwmi query for Win32_BIOS."
  ],
  "Procedure": "Checked that the BIOS version and serial number are not associated with VirtualBox or VMware using PowerShell",
  "Step": "11.A.3",
  "TacticGroup": "Discovery",
  "Technique": "T1497",
  "TechniqueName": "Virtualization/Sandbox Evasion"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [
    "Residual Artifact"
  ],
  "DetectionText": [
    "No detection capability demonstrated for this procedure, though process memory for the PowerShell process indicated the data exchange was over HTTPS."
  ],
  "Procedure": "Used HTTPS to transport\u00a0C2 (192.168.0.5) traffic",
  "Step": "3.B.4",
  "TacticGroup": "Command and Control",
  "Technique": "T1071",
  "TechniqueName": "Standard Application Layer Protocol"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "Used HTTPS to transport\u00a0C2 (192.168.0.4) traffic",
  "Step": "11.A.14",
  "TacticGroup": "Command and Control",
  "Technique": "T1071",
  "TechniqueName": "Standard Application Layer Protocol"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A MSSP detection occurred for powershell.exe executing:\u200b Get-WmiObject ...\u200b -Class AntiVirusProduct.",
    "Telemetry showed powershell.exe executing:\u200b Get-WmiObject ...\u200b -Class AntiVirusProduct."
  ],
  "Procedure": "Enumerated anti-virus software using PowerShell",
  "Step": "4.C.7",
  "TacticGroup": "Discovery",
  "Technique": "T1063",
  "TechniqueName": "Security Software Discovery"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A MSSP detection occurred for powershell.exe executing: Get-WmiObject ...\u200b\u200b -Class FireWallProduct.",
    "Telemetry showed powershell.exe executing: Get-WmiObject ...\u200b\u200b -Class FireWallProduct."
  ],
  "Procedure": "Enumerated firewall software using PowerShell",
  "Step": "4.C.8",
  "TacticGroup": "Discovery",
  "Technique": "T1063",
  "TechniqueName": "Security Software Discovery"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing PowerShell gwmi query for AntiVirusProduct.",
    "Telemetry showed the PowerShell gwmi query for AntiVirusProduct."
  ],
  "Procedure": "Enumerated registered AV products using PowerShell",
  "Step": "12.B.1",
  "TacticGroup": "Discovery",
  "Technique": "T1063",
  "TechniqueName": "Security Software Discovery"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A MSSP detection occurred for powershell.exe executing the NetUserGetGroups API.",
    "Telemetry showed powershell.exe executing the NetUserGetGroups API."
  ],
  "Procedure": "Enumerated user's domain group membership via the NetUserGetGroups API",
  "Step": "4.C.9",
  "TacticGroup": "Discovery",
  "Technique": "T1069",
  "TechniqueName": "Permission Groups Discovery"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A MSSP detection occurred for powershell.exe executing the NetUserGetLocalGroups API.",
    "Telemetry showed powershell.exe executing the NetUserGetLocalGroups API."
  ],
  "Procedure": "Enumerated user's local group membership via\u00a0the NetUserGetLocalGroups API",
  "Step": "4.C.11",
  "TacticGroup": "Discovery",
  "Technique": "T1069",
  "TechniqueName": "Permission Groups Discovery"
}
{
  "Detection": [
    "General",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Configuration Change (Detections)",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A General alert detection was generated for PowerShell loading Netapi32.dll.",
    "A MSSP detection occurred for the NetUserGetGroups API function loaded into PowerShell from Netapi32.dll.",
    "Telemetry showed the NetUserGetGroups API function loaded into PowerShell from Netapi32.dll."
  ],
  "Procedure": "Executed API call by reflectively loading Netapi32.dll",
  "Step": "4.C.10",
  "TacticGroup": "Execution",
  "Technique": "T1106",
  "TechniqueName": "Execution through API"
}
{
  "Detection": [
    "General",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Configuration Change (Detections)",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A General alert detection was generated for PowerShell loading Netapi32.dll.",
    "A MSSP detection occurred for the NetUserGetLocalGroups API function loaded into PowerShell from Netapi32.dll.",
    "Telemetry showed the NetUserGetLocalGroups API function loaded into PowerShell from Netapi32.dll."
  ],
  "Procedure": "Executed API call by reflectively loading Netapi32.dll",
  "Step": "4.C.12",
  "TacticGroup": "Execution",
  "Technique": "T1106",
  "TechniqueName": "Execution through API"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure. "
  ],
  "Procedure": "Executed PowerShell payload via the CreateProcessWithToken API",
  "Step": "10.B.2",
  "TacticGroup": "Execution",
  "Technique": "T1106",
  "TechniqueName": "Execution through API"
}
{
  "Detection": [
    "Technique",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Configuration Change (Detections)",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection called \"PowerShell Loading Advapi32.dll\" was generated for PowerShell reflectively loading Advapi32.dll inorder to execute the ConvertSidToStringSid API function.",
    "An MSSP detection occurred for the ConvertSidToStringSid API function loaded into PowerShell from Advapi32.dll.",
    "Telemetry showed PowerShell reflectively loading Advapi32.dll inorder to execute the ConvertSidToStringSid API function."
  ],
  "Procedure": "Executed the ConvertSidToStringSid API call by reflectively loading Advapi32.dll",
  "Step": "16.B.2",
  "TacticGroup": "Execution",
  "Technique": "T1106",
  "TechniqueName": "Execution through API"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell",
  "Step": "2.A.3",
  "TacticGroup": "Collection",
  "Technique": "T1005",
  "TechniqueName": "Data from Local System"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "Read data in the user's Downloads directory using PowerShell",
  "Step": "7.B.1",
  "TacticGroup": "Collection",
  "Technique": "T1005",
  "TechniqueName": "Data from Local System"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell",
  "Step": "9.B.4",
  "TacticGroup": "Collection",
  "Technique": "T1005",
  "TechniqueName": "Data from Local System"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "Read and collected a local file using PowerShell",
  "Step": "17.B.1",
  "TacticGroup": "Collection",
  "Technique": "T1005",
  "TechniqueName": "Data from Local System"
}
{
  "Detection": [
    "Technique",
    "General",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection called \"WebDav Network Request\" was generated due to a WebDav user-agent being used to PUT OfficeSupplies.7z on a WebDav network share.",
    "A General alert detection was generated for the file write of OfficeSupplies.7z to a remote adversary WebDav network share (192.168.0.4).",
    "An MSSP detection occurred containing evidence of OfficeSupplies.7z being uploaded to 192.168.0.4 using WebDav.",
    "Telemetry showed PoweShell Copy-Item to a remote adversary WebDav network share (192.168.0.4)."
  ],
  "Procedure": "Exfiltrated collection (OfficeSupplies.7z) to WebDAV network share using PowerShell",
  "Step": "7.B.4",
  "TacticGroup": "Exfiltration",
  "Technique": "T1048",
  "TechniqueName": "Exfiltration Over Alternative Protocol"
}
{
  "Detection": [
    "General",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "A General detection alert was generated for a file write to a network share.",
    "An MSSP detection occurred for the WindowsParentalControlMigration.tmp file being written to the mapped OneDrive network share.",
    "Telemetry showed PowerShell executing Copy-Item to exfiltrate data to a previously mapped OneDrive account. The detection was correlated to a parent alert on the PowerShell process."
  ],
  "Procedure": "Exfiltrated staged collection to an online OneDrive account using PowerShell",
  "Step": "18.A.2",
  "TacticGroup": "Exfiltration",
  "Technique": "T1048",
  "TechniqueName": "Exfiltration Over Alternative Protocol"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "Read the Chrome SQL database file to extract encrypted credentials",
  "Step": "6.A.1",
  "TacticGroup": "Credential Access",
  "Technique": "T1081",
  "TechniqueName": "Credentials in Files"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred for file timestamp modification on the kxwn.lock file.",
    "Telemetry showed modification of creation, last access, and last write times of kxwn.lock."
  ],
  "Procedure": "Modified the time attributes of the kxwn.lock persistence payload using PowerShell",
  "Step": "12.A.2",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1099",
  "TechniqueName": "Timestomp"
}
{
  "Detection": [
    "Technique",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection called \"Private Key - T1145\" was generated due to the creation of the $RandomFileName.pfx file. ",
    "An MSSP detection was generated for the creation of the $RandomFileName.pfx file. ",
    "Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe. "
  ],
  "Procedure": "Exported a local certificate to a PFX file using PowerShell",
  "Step": "6.B.1",
  "TacticGroup": "Credential Access",
  "Technique": "T1145",
  "TechniqueName": "Private Keys"
}
{
  "Detection": [
    "N/A"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Due to execution inconsistencies Step 19 has been omitted from the evaluation results."
  ],
  "Procedure": "Reflectively injected SDelete binary into PowerShell",
  "Step": "19.A.2",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1055",
  "TechniqueName": "Process Injection"
}
{
  "Detection": [
    "N/A"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Due to execution inconsistencies Step 19 has been omitted from the evaluation results."
  ],
  "Procedure": "Reflectively injected SDelete binary into PowerShell",
  "Step": "19.B.2",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1055",
  "TechniqueName": "Process Injection"
}
{
  "Detection": [
    "N/A"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Due to execution inconsistencies Step 19 has been omitted from the evaluation results."
  ],
  "Procedure": "Reflectively injected SDelete binary into PowerShell",
  "Step": "19.C.2",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1055",
  "TechniqueName": "Process Injection"
}
{
  "Detection": [
    "Technique",
    "General",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection called \"ADS Code Exec (Methodology)\" was generated due to PowerShell's use of command-line arguments associated with executing alternate data streams.",
    "A General alert detection was generated for suspicious usage of PowerShell's Get-Content command.",
    "An MSSP detection contained evidence of PowerShell executing schemas ADS via Get-Content and IEX."
  ],
  "Procedure": "Executed an alternate data stream (ADS) using PowerShell",
  "Step": "11.A.2",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1096",
  "TechniqueName": "NTFS File Attributes"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of the registry query for installed software.",
    "Telemetry showed scriptblock with registry query for installed software."
  ],
  "Procedure": "Enumerated installed software via the Registry (Wow6432 Uninstall key) using PowerShell",
  "Step": "12.C.1",
  "TacticGroup": "Discovery",
  "Technique": "T1012",
  "TechniqueName": "Query Registry"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of the registry query for installed software.",
    "Telemetry showed script block with registry query for installed software."
  ],
  "Procedure": "Enumerated installed software via the Registry (Uninstall key) using PowerShell",
  "Step": "12.C.2",
  "TacticGroup": "Discovery",
  "Technique": "T1012",
  "TechniqueName": "Query Registry"
}
{
  "Detection": [
    "Technique",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection called \"ZIP Archive Created - T1002\" was generated due to Draft.zip being identified as compressed.",
    "An MSSP detection occurred for powershell.exe compressing via Compress-Archive.",
    "Telemetry showed powershell.exe compressing via Compress-Archive."
  ],
  "Procedure": "Compressed and stored files into ZIP (Draft.zip) using PowerShell",
  "Step": "2.A.4",
  "TacticGroup": "Exfiltration",
  "Technique": "T1002",
  "TechniqueName": "Data Compressed"
}
{
  "Detection": [
    "Technique",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "A Technique alert detection called \"7-Zip Archive Created\" was generated due a 7-Zip file being written to disk.",
    "An MSSP detection occurred containing evidence of the file create of OfficeSupplies.7z.",
    "Telemetry showed the file write event for OfficeSupplies.7z. This detection was correlated to a parent alert on the parent PowerShell process."
  ],
  "Procedure": "Compressed\u00a0data from the user's Downloads directory into a ZIP file (OfficeSupplies.7z) using PowerShell",
  "Step": "7.B.2",
  "TacticGroup": "Exfiltration",
  "Technique": "T1002",
  "TechniqueName": "Data Compressed"
}
{
  "Detection": [
    "Technique",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection called \"Rar Execution\" \"T1002\" was generated when powershell.exe executed rar.exe.",
    "An MSSP detection contained evidence of execution of rar.exe with command line arguments to compress working.zip.",
    "Telemetry showed powershell.exe executing rar.exe with command-line arguments."
  ],
  "Procedure": "Compressed staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe",
  "Step": "9.B.7",
  "TacticGroup": "Exfiltration",
  "Technique": "T1002",
  "TechniqueName": "Data Compressed"
}
{
  "Detection": [
    "Technique",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection called \"Zip Archive Created\" was generated due to the creation of the ZIP archive WindowsParentalControlMigration.tmp on disk.",
    "An MSSP detection occurred containing evidence of data compression.",
    "Telemetry showed PowerShell compressing collection via the ZipFile.CreateFromDirectory .NET method."
  ],
  "Procedure": "Compressed a staging directory using PowerShell",
  "Step": "17.C.1",
  "TacticGroup": "Exfiltration",
  "Technique": "T1002",
  "TechniqueName": "Data Compressed"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "Read and downloaded ZIP (Draft.zip) over C2 channel (192.168.0.5 over TCP port 1234)",
  "Step": "2.B.1",
  "TacticGroup": "Exfiltration",
  "Technique": "T1041",
  "TechniqueName": "Exfiltration Over Command and Control Channel"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "Read and downloaded ZIP (working.zip on Desktop) over C2 channel (192.168.0.5 over TCP port 8443)",
  "Step": "9.B.8",
  "TacticGroup": "Exfiltration",
  "Technique": "T1041",
  "TechniqueName": "Exfiltration Over Command and Control Channel"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of powershell.exe executing Get-Process.",
    "Telemetry showed powershell.exe executing Get-Process."
  ],
  "Procedure": "Enumerated current running processes using PowerShell",
  "Step": "4.B.1",
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "TechniqueName": "Process Discovery"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A MSSP detection occurred for powershell.exe executing: $PID.",
    "Telemetry showed powershell.exe executing: $PID."
  ],
  "Procedure": "Enumerated the current process ID using PowerShell",
  "Step": "4.C.5",
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "TechniqueName": "Process Discovery"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred for powershell.exe executing Get-Process.",
    "Telemetry showed powershell.exe executing Get-Process."
  ],
  "Procedure": "Enumerated processes on remote host Scranton (10.0.1.4) using PowerShell",
  "Step": "8.A.3",
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "TechniqueName": "Process Discovery"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred for the PowerShell gwmi query for Win32_Process.",
    "Telemetry showed the PowerShell gwmi query for Win32_Process."
  ],
  "Procedure": "Checked that processes such as procexp.exe, taskmgr.exe, or wireshark.exe are not running using PowerShell",
  "Step": "11.A.8",
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "TechniqueName": "Process Discovery"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed PowerShell calling the CreateToolhelp32Snapshot API."
  ],
  "Procedure": "Enumerated running processes using the CreateToolhelp32Snapshot API",
  "Step": "13.D.1",
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "TechniqueName": "Process Discovery"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred for PowerShell executing Get-Process.",
    "Telemetry showed PowerShell executing Get-Process."
  ],
  "Procedure": "Enumerated and tracked PowerShell processes using PowerShell",
  "Step": "14.B.2",
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "TechniqueName": "Process Discovery"
}
{
  "Detection": [
    "General",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Configuration Change (Detections)",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A General alert detection called \"PowerShell Loading User32.dll\" was generated due to powershell.exe loading user32.dll, indicating possible Input Capture.",
    "An MSSP detection occurred containing evidence of keylogging.",
    "Telemetry showed PowerShell calling the GetAsyncKeyState API."
  ],
  "Procedure": "Captured user keystrokes using the GetAsyncKeyState API",
  "Step": "7.A.3",
  "TacticGroup": "Collection",
  "Technique": "T1056",
  "TechniqueName": "Input Capture"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A MSSP detection occurred for powershell.exe executing: $env:USERNAME.",
    "Telemetry showed powershell.exe executing: $env:USERNAME."
  ],
  "Procedure": "Enumerated the current username using PowerShell",
  "Step": "4.C.2",
  "TacticGroup": "Discovery",
  "Technique": "T1033",
  "TechniqueName": "System Owner/User Discovery"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred for the PowerShell gwmi query for Win32_ComputerSystem.",
    "Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem."
  ],
  "Procedure": "Checked that the username is not related to admin or a generic value (ex: user) using PowerShell",
  "Step": "11.A.6",
  "TacticGroup": "Discovery",
  "Technique": "T1033",
  "TechniqueName": "System Owner/User Discovery"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed PowerShell executing the GetUserNameEx API."
  ],
  "Procedure": "Enumerated the current username using the GetUserNameEx API",
  "Step": "13.C.1",
  "TacticGroup": "Discovery",
  "Technique": "T1033",
  "TechniqueName": "System Owner/User Discovery"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A MSSP detection occurred for PowerShell executing $env:UserName.",
    "Telemetry showed PowerShell script block executing $env:UserName."
  ],
  "Procedure": "Enumerated logged on users using PowerShell",
  "Step": "15.A.1",
  "TacticGroup": "Discovery",
  "Technique": "T1033",
  "TechniqueName": "System Owner/User Discovery"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred for powershell.exe executing the ConvertSidToStringSid API.",
    "Telemetry showed PowerShell executing the ConvertSidToStringSid API function."
  ],
  "Procedure": "Enumerated the domain SID (from current user SID) using\u00a0the ConvertSidToStringSid API",
  "Step": "16.B.1",
  "TacticGroup": "Discovery",
  "Technique": "T1033",
  "TechniqueName": "System Owner/User Discovery"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred for powershell.exe executing ChildItem.",
    "Telemetry showed powershell.exe executing ChildItem."
  ],
  "Procedure": "Searched filesystem for document and media files using PowerShell\u00a0",
  "Step": "2.A.1",
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "TechniqueName": "File and Directory Discovery"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A MSSP detection occurred for powershell.exe executing: $env:TEMP.",
    "Telemetry showed powershell.exe executing: $env:TEMP."
  ],
  "Procedure": "Enumerated user's temporary directory path using PowerShell",
  "Step": "4.C.1",
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "TechniqueName": "File and Directory Discovery"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A MSSP detection occurred for powershell.exe executing ChildItem.",
    "Telemetry showed powershell.exe executing ChildItem."
  ],
  "Procedure": "Searched filesystem for document and media files using PowerShell",
  "Step": "9.B.2",
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "TechniqueName": "File and Directory Discovery"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred for the PowerShell query for current path: (Get-Item -Path \".\\\" -Verbose).FullName.",
    "Telemetry showed PowerShell executing Get-Item for the current path."
  ],
  "Procedure": "Checked that the payload is not inside a folder path that contains \"sample\" or is the length of a hash value using PowerShell",
  "Step": "11.A.9",
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "TechniqueName": "File and Directory Discovery"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred for the PowerShell enumeration of System32.",
    "Telemetry showed the PowerShell enumeration of System32."
  ],
  "Procedure": "Enumerated the System32 directory using PowerShell",
  "Step": "12.A.1",
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "TechniqueName": "File and Directory Discovery"
}
{
  "Detection": [
    "Technique",
    "General",
    "General",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert",
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection called \"Sdelete Command Execution\" was generated due to the execution of sdelete64.exe to delete rcs.3aka3.doc.",
    "A General alert detection was generated for powershell.exe creating the sdelete64.exe child process.",
    "A General alert detection was generated for the execution of a Sysinternals utility.",
    "An MSSP detection occurred containing evidence of sdelete64.exe deleting the file.",
    "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events."
  ],
  "Procedure": "Deleted rcs.3aka3.doc on disk using SDelete",
  "Step": "4.B.2",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1107",
  "TechniqueName": "File Deletion"
}
{
  "Detection": [
    "Technique",
    "General",
    "General",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert",
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection called \"Sdelete Command Execution\" was generated due to the execution of sdelete64.exe to delete Draft.zip.",
    "A General alert detection was generated for powershell.exe creating the sdelete64.exe child process.",
    "A General alert detection was generated for the execution of a Sysinternals utility.",
    "An MSSP detection occurred containing evidence of sdelete64.exe deleting Draft.zip.",
    "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events."
  ],
  "Procedure": "Deleted Draft.zip on disk using SDelete",
  "Step": "4.B.3",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1107",
  "TechniqueName": "File Deletion"
}
{
  "Detection": [
    "Technique",
    "General",
    "General",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert",
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection called \"Sdelete Command Execution\" was generated due to the execution of sdelete64.exe to delete SysinternalsSuite.zip.",
    "A General alert detection was generated for powershell.exe creating the sdelete64.exe child process.",
    "A General alert detection was generated for the execution of a Sysinternals utility.",
    "An MSSP detection occurred containing evidence of sdelete64.exe deleting SysinternalsSuite.zip.",
    "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events."
  ],
  "Procedure": "Deleted SysinternalsSuite.zip on disk using SDelete",
  "Step": "4.B.4",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1107",
  "TechniqueName": "File Deletion"
}
{
  "Detection": [
    "Technique",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection called \"Sdelete Command Execution T1107\" was generated when sdelete64.exe with command-line arguments was used to delete rar.exe.",
    "A MSSP detection occurred for the file deletion of rar.exe.",
    "Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe."
  ],
  "Procedure": "Deleted rar.exe on disk using SDelete",
  "Step": "9.C.1",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1107",
  "TechniqueName": "File Deletion"
}
{
  "Detection": [
    "Technique",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection called \"Sdelete Command Execution T1107\" was generated when sdelete64.exe with command-line arguments was used to delete Desktop\\working.zip.",
    "A MSSP detection occurred for the file deletion of Desktop\\working.zip.",
    "Telemetry showed sdelete64.exe with command-line arguments to delete Desktop\\working.zip."
  ],
  "Procedure": "Deleted working.zip (from Desktop) on disk using SDelete",
  "Step": "9.C.2",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1107",
  "TechniqueName": "File Deletion"
}
{
  "Detection": [
    "Technique",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "A Technique alert detection called \"Sdelete Command Execution T1107\" was generated when sdelete64.exe with command-line arguments was used to delete Roaming\\working.zip.",
    "A MSSP detection occurred for the file deletion of Roaming\\working.zip.",
    "Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip. This event was correlated to a prior detection on the python.exe parent process."
  ],
  "Procedure": "Deleted working.zip (from AppData directory) on disk using SDelete",
  "Step": "9.C.3",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1107",
  "TechniqueName": "File Deletion"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "Deleted SDelete on disk using cmd.exe del command",
  "Step": "9.C.4",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1107",
  "TechniqueName": "File Deletion"
}
{
  "Detection": [
    "N/A"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Due to execution inconsistencies Step 19 has been omitted from the evaluation results."
  ],
  "Procedure": "Deleted Mimikatz (m.exe) on disk using SDelete",
  "Step": "19.A.1",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1107",
  "TechniqueName": "File Deletion"
}
{
  "Detection": [
    "N/A"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Due to execution inconsistencies Step 19 has been omitted from the evaluation results."
  ],
  "Procedure": "Deleted exfiltrated data on disk using SDelete",
  "Step": "19.B.1",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1107",
  "TechniqueName": "File Deletion"
}
{
  "Detection": [
    "N/A"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Due to execution inconsistencies Step 19 has been omitted from the evaluation results."
  ],
  "Procedure": "Deleted staged data on disk using SDelete",
  "Step": "19.C.1",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1107",
  "TechniqueName": "File Deletion"
}
{
  "Detection": [
    "General",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Configuration Change (Detections)",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A General alert detection called \"Unusual Outlook Parent Process\" was generated due to Outlook being launched by a process other than explorer.exe.",
    "An MSSP detection contained evidence of PowerShell collected email information from Outlook.",
    "Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails."
  ],
  "Procedure": "Dumped messages from the local Outlook inbox using PowerShell",
  "Step": "17.A.1",
  "TacticGroup": "Collection",
  "Technique": "T1114",
  "TechniqueName": "Email Collection"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "Manipulated the token of the PowerShell payload via the CreateProcessWithToken API",
  "Step": "10.B.3",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1134",
  "TechniqueName": "Access Token Manipulation"
}
{
  "Detection": [
    "General",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "A General alert detection was generated for PowerShell file write.",
    "An MSSP detection occurred containing evidence of powershell.exe decompressing files via Expand-Archive. ",
    "Telemetry showed PowerShell decompressing the ZIP via Expand-Archive and corresponding file writes. The detection was correlated to a parent alert for a PowerShell process."
  ],
  "Procedure": "Decompressed ZIP (SysinternalsSuite.zip) file using PowerShell",
  "Step": "4.A.3",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1140",
  "TechniqueName": "Deobfuscate/Decode Files or Information"
}
{
  "Detection": [
    "Technique",
    "Technique",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection called \"Certutil Decode\" was generated due to the use of certutil to decode file content.",
    "A Technique alert detection was generated for certutil.exe writing a fake certificate identified as an encoded binary.",
    "A MSSP detection occurred for certutil.exe decoding kxwn.lock.",
    "Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload."
  ],
  "Procedure": "Decoded an embedded DLL payload to disk using certutil.exe",
  "Step": "11.A.10",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1140",
  "TechniqueName": "Deobfuscate/Decode Files or Information"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred for PowerShell Get-WmiInstance reading encoded content from Win32_AuditCode.",
    "Telemetry showed PowerShell reading encoded content from the WMI class. "
  ],
  "Procedure": "Read and decoded Mimikatz output from a WMI class property using PowerShell",
  "Step": "14.B.6",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1140",
  "TechniqueName": "Deobfuscate/Decode Files or Information"
}
{
  "Detection": [
    "Technique",
    "General",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection called \"Net User Add\" was generated for net.exe with the command-line arguments to add the new user Toby.",
    "A General alert detection called WinRM process activity was generated for for wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.",
    "An MSSP detection occurred for the creation of the user Toby on Scranton (10.0.1.4).",
    "Telemetry showed wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby."
  ],
  "Procedure": "Added a new user to the remote host Scranton (10.0.1.4) using net.exe",
  "Step": "20.B.3",
  "TacticGroup": "Persistence",
  "Technique": "T1136",
  "TechniqueName": "Create Account"
}
{
  "Detection": [
    "General",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "A General alert detection was generated for file creation of Draft.zip",
    "An MSSP detection occurred for the file creation of Draft.zip.",
    "Telemetry showed file creation of Draft.zip. This was correlated to prior a detection of the parent PowerShell process."
  ],
  "Procedure": "Staged files for exfiltration into ZIP (Draft.zip) using PowerShell",
  "Step": "2.A.5",
  "TacticGroup": "Collection",
  "Technique": "T1074",
  "TechniqueName": "Data Staged"
}
{
  "Detection": [
    "Technique",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection called \"ZIP Archive Created\" \"T1074\" was generated due to the file creation of the ZIP file working.zip.",
    "A MSSP detection occurred for file create of working.zip.",
    "Telemetry showed a file create event for working.zip."
  ],
  "Procedure": "Staged files for exfiltration into ZIP (working.zip in AppData directory) using PowerShell",
  "Step": "9.B.5",
  "TacticGroup": "Collection",
  "Technique": "T1074",
  "TechniqueName": "Data Staged"
}
{
  "Detection": [
    "General",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated"
  ],
  "DetectionText": [
    "A General alert detection was generated for PowerShell writing the MITRE-ATTACK-EVALS.HTML file to disk.",
    "Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML. This event was correlated to parent alerts relating to the PowerShell process that carried out the file write."
  ],
  "Procedure": "Staged collected file into directory using PowerShell",
  "Step": "17.B.2",
  "TacticGroup": "Collection",
  "Technique": "T1074",
  "TechniqueName": "Data Staged"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection contained evidence of WMI persistence established for user Oscar.",
    "Telemetry showed the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription."
  ],
  "Procedure": "Established WMI event subscription persistence using PowerShell",
  "Step": "15.A.2",
  "TacticGroup": "Persistence",
  "Technique": "T1084",
  "TechniqueName": "Windows Management Instrumentation Event Subscription"
}
{
  "Detection": [
    "Technique",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection called \"WMI Process Creation\" was generated due to wmiprvse.exe executing the PowerShell stager as a child process.",
    "An MSSP detection occurred for the WMI event subscription WindowsParentalControlMigration executing PowerShell upon user logon.",
    "Telemetry showed wmiprvse.exe executing the PowerShell stager."
  ],
  "Procedure": "Executed WMI persistence on user login",
  "Step": "20.A.2",
  "TacticGroup": "Persistence",
  "Technique": "T1084",
  "TechniqueName": "Windows Management Instrumentation Event Subscription"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A MSSP detection occurred for powershell.exe executing: $env:COMPUTERNAME.",
    "Telemetry showed powershell.exe executing: $env:COMPUTERNAME."
  ],
  "Procedure": "Enumerated the computer hostname using PowerShell",
  "Step": "4.C.3",
  "TacticGroup": "Discovery",
  "Technique": "T1082",
  "TechniqueName": "System Information Discovery"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A MSSP detection occurred for powershell.exe executing:\u200b Gwmi Win32_OperatingSystem.",
    "Telemetry showed powershell.exe executing:\u200b Gwmi Win32_OperatingSystem."
  ],
  "Procedure": "Enumerated the OS version using PowerShell",
  "Step": "4.C.6",
  "TacticGroup": "Discovery",
  "Technique": "T1082",
  "TechniqueName": "System Information Discovery"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred for the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.",
    "Telemetry showed the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem."
  ],
  "Procedure": "Enumerated computer manufacturer, model, and version information using PowerShell",
  "Step": "11.A.4",
  "TacticGroup": "Discovery",
  "Technique": "T1082",
  "TechniqueName": "System Information Discovery"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of PowerShell executing the GetComputerNameEx API.",
    "Telemetry showed PowerShell calling the GetComputerNameEx API."
  ],
  "Procedure": "Enumerated the computer name using the GetComputerNameEx API",
  "Step": "13.A.1",
  "TacticGroup": "Discovery",
  "Technique": "T1082",
  "TechniqueName": "System Information Discovery"
}
{
  "Detection": [
    "General",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A General alert detection was generated for network traffic from Nashua (10.0.1.6) to Scranton (10.0.1.4) over a port associated with DCOM RPC traffic.",
    "An MSSP detection occurred containing evidence of an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 445.",
    "Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 445."
  ],
  "Procedure": "Established SMB session to remote host Scranton's (10.0.1.4) IPC$ share using PsExec",
  "Step": "8.C.2",
  "TacticGroup": "Lateral Movement",
  "Technique": "T1077",
  "TechniqueName": "Windows Admin Shares"
}
{
  "Detection": [
    "Technique",
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert"
  ],
  "DetectionText": [
    "A Technique alert detection called \"PowerShell WMI Activity\" was generated for WmiPrvSE.exe executing powershell.exe. ",
    "A Technique alert detection called \"WMI Process Creation\" was generated due to a process being started by WMI.",
    "Telemetry showed WmiPrvSE.exe executing powershell.exe"
  ],
  "Procedure": "Created and executed a WMI class using PowerShell",
  "Step": "14.B.1",
  "TacticGroup": "Execution",
  "Technique": "T1047",
  "TechniqueName": "Windows Management Instrumentation"
}
{
  "Detection": [
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection called \"Sdclt Child Process\" was generated due to sdclt.exe spawning control.exe.",
    "A MSSP detection occurred for a new high integrity PowerShell callback spawned from control.exe\u200b\u200b."
  ],
  "Procedure": "Executed elevated PowerShell payload",
  "Step": "3.B.2",
  "TacticGroup": "Privilege Escalation",
  "Technique": "T1088",
  "TechniqueName": "Bypass User Account Control"
}
{
  "Detection": [
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection called \"Sdclt Child Process\" was generated due to sdclt.exe spawning control.exe.",
    "An MSSP detection contained evidence of High Integrity PowerShell process spawned from control.exe."
  ],
  "Procedure": "Executed elevated PowerShell payload",
  "Step": "14.A.2",
  "TacticGroup": "Privilege Escalation",
  "Technique": "T1088",
  "TechniqueName": "Bypass User Account Control"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of the PowerShell script contained within monkey.png.",
    "Telemetry showed PowerShell extracting and executing the code embedded within monkey.png."
  ],
  "Procedure": "Embedded PowerShell payload in monkey.png using steganography",
  "Step": "3.A.2",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1027",
  "TechniqueName": "Obfuscated Files or Information"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred for PowerShell Set-WmiInstance writing encoded content to Win32_AuditCode.",
    "Telemetry showed PowerShell writing encoded content into the WMI class. "
  ],
  "Procedure": "Encoded and wrote Mimikatz output to a WMI class property using PowerShell",
  "Step": "14.B.5",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1027",
  "TechniqueName": "Obfuscated Files or Information"
}
{
  "Detection": [
    "General",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A General alert detection was generated for PowerShell writing the WindowsParentalControlMigration.tmp file to disk with the GIF89a header present in the textAtLowestOffset field.",
    "An MSSP detection occurred contained evidence that WindowsParentalControlMigration.tmp was a zip archive that had its file header modified to begin with a GIF image header.",
    "Telemetry showed PowerShell appending the GIF file header to the compressed file."
  ],
  "Procedure": "Prepended the GIF file header to a compressed staging file using PowerShell",
  "Step": "17.C.2",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1027",
  "TechniqueName": "Obfuscated Files or Information"
}
{
  "Detection": [
    "Technique",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Configuration Change (Detections)",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection called \"Uncommon Port Connection\" was generated due to  rcs.3aka3.doc connecting to remote port 1234.",
    "An MSSP detection occurred for the rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.",
    "Telemetry showed the rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234."
  ],
  "Procedure": "Established C2 channel (192.168.0.5) via rcs.3aka3.doc payload over TCP port 1234",
  "Step": "1.A.3",
  "TacticGroup": "Command and Control",
  "Technique": "T1065",
  "TechniqueName": "Uncommonly Used Port"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred for the PowerShell gwmi query for Win32_PnPEntity.",
    "Telemetry showed the PowerShell gwmi query for Win32_PnPEntity."
  ],
  "Procedure": "Enumerated devices/adapters to check for presence of VirtualBox driver(s) using PowerShell",
  "Step": "11.A.5",
  "TacticGroup": "Discovery",
  "Technique": "T1120",
  "TechniqueName": "Peripheral Device Discovery"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred for powershell.exe executing ChildItem.",
    "Telemetry showed powershell.exe executing ChildItem."
  ],
  "Procedure": "Scripted search of filesystem for document and media files using PowerShell\u00a0",
  "Step": "2.A.2",
  "TacticGroup": "Collection",
  "Technique": "T1119",
  "TechniqueName": "Automated Collection"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A MSSP detection occurred for powershell.exe executing ChildItem.",
    "Telemetry showed powershell.exe executing ChildItem."
  ],
  "Procedure": "Scripted search of filesystem for document and media files using PowerShell\u00a0",
  "Step": "9.B.3",
  "TacticGroup": "Collection",
  "Technique": "T1119",
  "TechniqueName": "Automated Collection"
}
