{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "The rcs.3aka3.doc process spawning from explorer.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "General",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed explorer.exe executing rcs.3aka3.doc.",
    "A General alert detection (low severity) was generated for rcs.3aka3.doc being identified as a \"rare process executed.\"",
    "An MSSP detection occurred containing evidence of user Pam executing rcs.3aka3.doc."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "User Pam executed payload rcs.3aka3.doc",
  "ScreenshotDatasources": [],
  "Step": "1. Initial Compromise",
  "Substep": "1.A.1",
  "Subtechnique": "T1204.002",
  "Subtechnique_Name": "User Execution: Malicious File",
  "TacticGroup": "Execution",
  "Technique": "T1204",
  "Technique_Name": "User Execution"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Evidence of the right-to-left override character (U+202E) in the rcs.3aka.doc process OR the original filename (cod.3aka.scr)",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed a process \"?cod.3aka\" with filename \"rcs.3aka.doc\", indicative of masquerading.",
    "An MSSP detection occurred showing the original filename: cod.3aka.scr."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Used unicode right-to-left override (RTLO) character to obfuscate file name rcs.3aka3.doc (originally cod.3aka.scr)",
  "ScreenshotDatasources": [],
  "Step": "1. Initial Compromise",
  "Substep": "1.A.2",
  "Subtechnique": "T1036.002",
  "Subtechnique_Name": "Masquerading: Right-to-Left Override",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1036",
  "Technique_Name": "Masquerading"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Established network channel over port 1234",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed a network connection to 192.168.0.5 over port 1234.",
    "An MSSP detection occurred containing evidence of cod.3aka3.scr connecting to 192.168.0.5 on port 1234."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Established C2 channel (192.168.0.5) via rcs.3aka3.doc payload over TCP port 1234",
  "ScreenshotDatasources": [],
  "Step": "1. Initial Compromise",
  "Substep": "1.A.3",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1095",
  "Technique_Name": "Non-Application Layer Protocol"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Evidence that the network data sent over the C2 channel is encrypted",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Used RC4 stream cipher to encrypt C2 (192.168.0.5) traffic",
  "ScreenshotDatasources": [],
  "Step": "1. Initial Compromise",
  "Substep": "1.A.4",
  "Subtechnique": "T1573.001",
  "Subtechnique_Name": "Encrypted Channel: Symmetric Cryptography",
  "TacticGroup": "Command and Control",
  "Technique": "T1573",
  "Technique_Name": "Encrypted Channel"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "cmd.exe spawning from the rcs.3aka3.doc process",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed cmd.exe spawning from rcs.3aka3.doc. The detection was correlated to a parent alert for Abnormal File Modification.",
    "An MSSP detection for an anomalous script occurred containing evidence of cmd spawning from rcs.3aka3.doc."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Spawned interactive cmd.exe",
  "ScreenshotDatasources": [],
  "Step": "1. Initial Compromise",
  "Substep": "1.B.1",
  "Subtechnique": "T1059.003",
  "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe spawning from cmd.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe spawning from cmd.exe. The detection was correlated to a parent alert for Abnormal Process."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Spawned interactive powershell.exe",
  "ScreenshotDatasources": [],
  "Step": "1. Initial Compromise",
  "Substep": "1.B.2",
  "Subtechnique": "T1059.001",
  "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing (Get-)ChildItem",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed the execution of ChildItem.",
    "An MSSP detection occurred containing evidence of the Childitem cmdlet."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Searched filesystem for document and media files using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "2. Collection and Exfiltration",
  "Substep": "2.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "Technique_Name": "File and Directory Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing (Get-)ChildItem",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed the execution of the ChildItem.",
    "An MSSP detection occurred containing evidence of the Childitem."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Scripted search of filesystem for document and media files using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "2. Collection and Exfiltration",
  "Substep": "2.A.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Collection",
  "Technique": "T1119",
  "Technique_Name": "Automated Collection"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe reading files in C:\\Users\\Pam\\",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "2. Collection and Exfiltration",
  "Substep": "2.A.3",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Collection",
  "Technique": "T1005",
  "Technique_Name": "Data from Local System"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Compress-Archive",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe compressing via Compress-Archive.",
    "An MSSP detection occurred containing evidence of the Compress-Archive cmdlet being executed."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Compressed and stored files into ZIP (Draft.zip) using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "2. Collection and Exfiltration",
  "Substep": "2.A.4",
  "Subtechnique": "T1560.001",
  "Subtechnique_Name": "Archive Collected Data: Archive via Utility",
  "TacticGroup": "Collection",
  "Technique": "T1560",
  "Technique_Name": "Archive Collected Data"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe creating the file draft.zip",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed file creation of Draft.zip."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Staged files for exfiltration into ZIP (Draft.zip) using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "2. Collection and Exfiltration",
  "Substep": "2.A.5",
  "Subtechnique": "T1560.001",
  "Subtechnique_Name": "Archive Collected Data: Archive via Utility",
  "TacticGroup": "Collection",
  "Technique": "T1560",
  "Technique_Name": "Archive Collected Data"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "The rcs.3aka3.doc process reading the file draft.zip while connected to the C2 channel",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Read and downloaded ZIP (Draft.zip) over C2 channel (192.168.0.5 over TCP port 1234)",
  "ScreenshotDatasources": [],
  "Step": "2. Collection and Exfiltration",
  "Substep": "2.B.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Exfiltration",
  "Technique": "T1041",
  "Technique_Name": "Exfiltration Over Command and Control Channel"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "The rcs.3aka3.doc process creating the file monkey.png",
  "Datasources": [],
  "Detection": [
    "General"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated"
  ],
  "DetectionText": [
    "A General alert detection (informational) was generated due to a suspicious download by PowerShell. The detection was correlated to a parent alert for Abnormal File Modification."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Dropped stage 2 payload (monkey.png) to disk",
  "ScreenshotDatasources": [],
  "Step": "3. Deploy Stealth Toolkit",
  "Substep": "3.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Evidence that a PowerShell payload was within monkey.png",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell extracting and executing the code embedded within monkey.png.",
    "An MSSP detection occurred containing evidence of a PowerShell script contained within monkey.png."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Embedded PowerShell payload in monkey.png using steganography",
  "ScreenshotDatasources": [],
  "Step": "3. Deploy Stealth Toolkit",
  "Substep": "3.A.2",
  "Subtechnique": "T1027.003",
  "Subtechnique_Name": "Obfuscated Files or Information: Steganography",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1027",
  "Technique_Name": "Obfuscated Files or Information"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Addition of the DelegateExecute subkey in HKCU\\Software\\Classes\\Folder\\shell\\open\\command",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed a Registry write of the command subkey.",
    "An MSSP detection occurred containing evidence of the addition of the DelegateExecute Registry Value."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "3. Deploy Stealth Toolkit",
  "Substep": "3.B.1",
  "Subtechnique": "T1546.015",
  "Subtechnique_Name": "Event Triggered Execution: Component Object Model Hijacking",
  "TacticGroup": "Privilege Escalation",
  "Technique": "T1546",
  "Technique_Name": "Event Triggered Execution"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "High integrity powershell.exe spawning from control.exe (spawned from sdclt.exe)",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "General",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed control.exe creating a high integrity powershell.exe.",
    "A General alert detection (high severity) was generated due to powershell.exe running with parameters associated with post exploitation payloads.",
    "An MSSP detection occurred for User DMEVALS\\pam launching a command prompt from which the sdclt.exe program was used."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Executed elevated PowerShell payload",
  "ScreenshotDatasources": [],
  "Step": "3. Deploy Stealth Toolkit",
  "Substep": "3.B.2",
  "Subtechnique": "T1548.002",
  "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control",
  "TacticGroup": "Privilege Escalation",
  "Technique": "T1548",
  "Technique_Name": "Abuse Elevation Control Mechanism"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Established network channel over port 443",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed powershell.exe connecting to 192.168.0.5 on port 443."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Established C2 channel (192.168.0.5) via PowerShell payload over TCP port 443",
  "ScreenshotDatasources": [],
  "Step": "3. Deploy Stealth Toolkit",
  "Substep": "3.B.3",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1043",
  "Technique_Name": "Commonly Used Port"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Evidence that the network data sent over the C2 channel is HTTPS",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed PowerShell process exchanging data over HTTPS."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Used HTTPS to transport C2 (192.168.0.5) traffic",
  "ScreenshotDatasources": [],
  "Step": "3. Deploy Stealth Toolkit",
  "Substep": "3.B.4",
  "Subtechnique": "T1071.001",
  "Subtechnique_Name": "Application Layer Protocol: Web Protocols",
  "TacticGroup": "Command and Control",
  "Technique": "T1071",
  "Technique_Name": "Application Layer Protocol"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Evidence that the network data sent over the C2 channel is encrypted",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed PowerShell process exchanging data over HTTPS."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Used HTTPS to encrypt C2 (192.168.0.5) traffic",
  "ScreenshotDatasources": [],
  "Step": "3. Deploy Stealth Toolkit",
  "Substep": "3.B.5",
  "Subtechnique": "T1573.002",
  "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography",
  "TacticGroup": "Command and Control",
  "Technique": "T1573",
  "Technique_Name": "Encrypted Channel"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Deletion of of the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command subkey",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell command to remove DelegateExecute Registry Value.",
    "An MSSP detection occurred for the recursive deletion of the registry key."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Modified the Registry to remove artifacts of COM hijacking",
  "ScreenshotDatasources": [],
  "Step": "3. Deploy Stealth Toolkit",
  "Substep": "3.C.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Defense Evasion",
  "Technique": "T1112",
  "Technique_Name": "Modify Registry"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe creating the file SysinternalsSuite.zip",
  "Datasources": [],
  "Detection": [
    "General"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "A General alert detection (low severity) was generated for PowerShell downloading a significant amount of data using HTTP(S)."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Dropped additional tools (SysinternalsSuite.zip) to disk over C2 channel (192.168.0.5)",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe spawning from powershell.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Alert",
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed a new powershell.exe spawning from powershell.exe. The detection was correlated to a parent alert for a suspicious download by PowerShell.",
    "A Technique alert detection for PowerShell (medium severity) was generated due to a suspicious PowerShell command. The detection was correlated to a parent alert for a suspicious download by PowerShell."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Spawned interactive powershell.exe",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.A.2",
  "Subtechnique": "T1059.001",
  "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Expand-Archive",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell decompressing the ZIP via Expand-Archive and corresponding file writes.",
    "An MSSP detection occurred containing evidence of PowerShell unzipping and moving SysInternals tools."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Decompressed ZIP (SysinternalsSuite.zip) file using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.A.3",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Defense Evasion",
  "Technique": "T1140",
  "Technique_Name": "Deobfuscate/Decode Files or Information"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Get-Process",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed powershell.exe executing Get-Process."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Enumerated current running processes using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.B.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "Technique_Name": "Process Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "sdelete64.exe deleting the file rcs.3aka3.doc",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed sdelete64.exe deleting rcs.3aka3.doc.",
    "A Technique alert detection for file deletion (medium severity) was generated due to sdelete64.exe deleting rcs.3aka3.doc. The detection was correlated to a parent alert for PowerShell.",
    "An MSSP detection occurred containing evidence of sdelete64.exe deleting rcs.3aka3.doc."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Deleted rcs.3aka3.doc on disk using SDelete",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.B.2",
  "Subtechnique": "T1070.004",
  "Subtechnique_Name": "Indicator Removal on Host: File Deletion",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1070",
  "Technique_Name": "Indicator Removal on Host"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "sdelete64.exe deleting the file draft.zip",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed sdelete64.exe deleting Draft.zip.",
    "A Technique alert detection for file deletion (medium severity) was generated due to sdelete64.exe deleting Draft.Zip. The detection was correlated to a parent alert for PowerShell.",
    "An MSSP detection occurred containing evidence of sdelete64.exe deleting Draft.zip"
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Deleted Draft.zip on disk using SDelete",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.B.3",
  "Subtechnique": "T1070.004",
  "Subtechnique_Name": "Indicator Removal on Host: File Deletion",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1070",
  "Technique_Name": "Indicator Removal on Host"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "sdelete64.exe deleting the file SysinternalsSuite.zip",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed sdelete64.exe deleting SysinternalsSuite.zip.",
    "A Technique alert detection (medium severity) for file deletion  was generated due to sdelete64.exe deleting SysinternalsSuite.zip. This was correlated to a previous detection for PowerShell.",
    "An MSSP detection occurred containing evidence of sdelete64.exe deleting SysinternalsSuite.zip"
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Deleted SysinternalsSuite.zip on disk using SDelete",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.B.4",
  "Subtechnique": "T1070.004",
  "Subtechnique_Name": "Indicator Removal on Host: File Deletion",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1070",
  "Technique_Name": "Indicator Removal on Host"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing $env:TEMP",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed powershell.exe executing $env:TEMP."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Enumerated user's temporary directory path using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "Technique_Name": "File and Directory Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing $env:USERNAME",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed powershell.exe executing $env:USERNAME."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Enumerated the current username using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1033",
  "Technique_Name": "System Owner/User Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing $env:COMPUTERNAME",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed powershell.exe executing $env:COMPUTERNAME."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Enumerated the computer hostname using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.3",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1082",
  "Technique_Name": "System Information Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing $env:USERDOMAIN",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed powershell.exe executing $env:USERDOMAIN."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Enumerated the current domain name using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.4",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1016",
  "Technique_Name": "System Network Configuration Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing $PID",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed powershell.exe executing $PID."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Enumerated the current process ID using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.5",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "Technique_Name": "Process Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Gwmi Win32_OperatingSystem",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing: Gwmi Win32_OperatingSystem",
    "A Technique alert detection for \"wmi-enumerating-os\" was generated due to a WMI query for OS version."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Enumerated the OS version using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.6",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1082",
  "Technique_Name": "System Information Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Get-WmiObject ... -Class AntiVirusProduct",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing: Get-WmiObject ... -Class AntiVirusProduct",
    "A Technique alert detection labeled wmi-enumeration-av was generated due to a WMI query for AntivirusProduct."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Enumerated anti-virus software using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.7",
  "Subtechnique": "T1518.001",
  "Subtechnique_Name": "Software Discovery: Security Software Discovery",
  "TacticGroup": "Discovery",
  "Technique": "T1518",
  "Technique_Name": "Software Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Get-WmiObject ... -Class FireWallProduct",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing: Get-WmiObject ... -Class FireWallProduct",
    "A Technique alert detection was generated for WMI being used to query information about firewall products."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Enumerated firewall software using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.8",
  "Subtechnique": "T1518.001",
  "Subtechnique_Name": "Software Discovery: Security Software Discovery",
  "TacticGroup": "Discovery",
  "Technique": "T1518",
  "Technique_Name": "Software Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing the NetUserGetGroups API",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed the NetUserGetGroups API call."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Enumerated user's domain group membership via the NetUserGetGroups API",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.9",
  "Subtechnique": "T1069.002",
  "Subtechnique_Name": "Permission Groups Discovery: Domain Groups",
  "TacticGroup": "Discovery",
  "Technique": "T1069",
  "Technique_Name": "Permission Groups Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "The NetUserGetGroups API function loaded into powershell.exe from Netapi32.dll",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed the NetUserGetGroups API function from Netapi32.dll."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Executed API call by reflectively loading Netapi32.dll",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.10",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Execution",
  "Technique": "T1106",
  "Technique_Name": "Native API"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing the NetUserGetLocalGroups API",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed the NetUserGetLocalGroups API call."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Enumerated user's local group membership via the NetUserGetLocalGroups API",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.11",
  "Subtechnique": "T1069.001",
  "Subtechnique_Name": "Permission Groups Discovery: Local Groups",
  "TacticGroup": "Discovery",
  "Technique": "T1069",
  "Technique_Name": "Permission Groups Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "The NetUserGetLocalGroups API function loaded into powershelle.exe from Netapi32.dll",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed the NetUserGetLocalGroups API function from Netapi32.dll."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Executed API call by reflectively loading Netapi32.dll",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.12",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Execution",
  "Technique": "T1106",
  "Technique_Name": "Native API"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe creating the Javamtsup service",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed a registry event and service creation of javamtsup.",
    "An MSSP detection for Create New Service occurred containing evidence of the javamtsup service being installed."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Created a new service (javamtsup) that executes a service binary (javamtsup.exe) at system startup",
  "ScreenshotDatasources": [],
  "Step": "5. Establish Persistence",
  "Substep": "5.A.1",
  "Subtechnique": "T1543.003",
  "Subtechnique_Name": "Create or Modify System Process: Windows Service",
  "TacticGroup": "Persistence",
  "Technique": "T1543",
  "Technique_Name": "Create or Modify System Process"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe creating the file hostui.lnk in the Startup folder",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "General",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed Startup folder registry modification for hostui.lnk.",
    "A General alert detection (low severity) was generated for a shortcut file (hostui.lnk) being modified. The event was correlated to a parent alert for suspicious powershell.",
    "An MSSP detection occurred containing evidence of the creation of the hostui.lnk file in the Startup folder."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Created a LNK file (hostui.lnk) in the Startup folder that executes on login",
  "ScreenshotDatasources": [],
  "Step": "5. Establish Persistence",
  "Substep": "5.B.1",
  "Subtechnique": "T1547.001",
  "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder",
  "TacticGroup": "Persistence",
  "Technique": "T1547",
  "Technique_Name": "Boot or Logon Autostart Execution"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "accesschk.exe reading files within %APPDATALOCAL%\\Google\\chrome\\user data\\default\\",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Read the Chrome SQL database file to extract encrypted credentials",
  "ScreenshotDatasources": [],
  "Step": "6. Credential Access",
  "Substep": "6.A.1",
  "Subtechnique": "T1552.001",
  "Subtechnique_Name": "Unsecured Credentials: Credentials in Files",
  "TacticGroup": "Credential Access",
  "Technique": "T1552",
  "Technique_Name": "Unsecured Credentials"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "accesschk.exe executing the CryptUnprotectedData API",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Executed the CryptUnprotectedData API call to decrypt Chrome passwords",
  "ScreenshotDatasources": [],
  "Step": "6. Credential Access",
  "Substep": "6.A.2",
  "Subtechnique": "T1555.003",
  "Subtechnique_Name": "Credentials from Password Stores: Credentials from Web Browsers",
  "TacticGroup": "Credential Access",
  "Technique": "T1555",
  "Technique_Name": "Credentials from Password Stores"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Evidence that accesschk.exe is not the legitimate Sysinternals tool",
  "Datasources": [],
  "Detection": [
    "General"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "A General alert detection (medium severity) was generated identifying accesschk.exe as potentially unwanted application (PUA). This indicates that the file is not the legitimate Sysinternals tool."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Masqueraded a Chrome password dump tool as accesscheck.exe, a legitimate Sysinternals tool",
  "ScreenshotDatasources": [],
  "Step": "6. Credential Access",
  "Substep": "6.A.3",
  "Subtechnique": "T1036.005",
  "Subtechnique_Name": "Masquerading: Match Legitimate Name or Location",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1036",
  "Technique_Name": "Masquerading"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe creating a certificate file exported from the system",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Host Interrogation"
  ],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Exported a local certificate to a PFX file using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "6. Credential Access",
  "Substep": "6.B.1",
  "Subtechnique": "T1552.004",
  "Subtechnique_Name": "Unsecured Credentials: Private Keys",
  "TacticGroup": "Credential Access",
  "Technique": "T1552",
  "Technique_Name": "Unsecured Credentials"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe injecting into lsass.exe OR lsass.exe reading Registry keys under HKLM:\\SAM\\SAM\\Domains\\Account\\Users\\",
  "Datasources": [],
  "Detection": [
    "Technique"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "A Technique alert detection (medium severity) for a possible LSASS memory dump was generated due powershell.exe opening handles to lsass.exe in a pattern that happens when a minidump of a process is generated."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Dumped password hashes from the Windows Registry by injecting a malicious DLL into Lsass.exe",
  "ScreenshotDatasources": [],
  "Step": "6. Credential Access",
  "Substep": "6.C.1",
  "Subtechnique": "T1003.002",
  "Subtechnique_Name": "OS Credential Dumping: Security Account Manager",
  "TacticGroup": "Credential Access",
  "Technique": "T1003",
  "Technique_Name": "OS Credential Dumping"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing the CopyFromScreen function from System.Drawing.dll",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing CopyFromScreen from System.Drawing.dll.",
    "An MSSP detection occurred containing evidence of PowerShell taking screenshots."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Captured and saved screenshots using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "7. Collection and Exfiltration",
  "Substep": "7.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Collection",
  "Technique": "T1113",
  "Technique_Name": "Screen Capture"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Get-Clipboard",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed powershell.exe executing Get-Clipboard."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Captured clipboard contents using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "7. Collection and Exfiltration",
  "Substep": "7.A.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Collection",
  "Technique": "T1115",
  "Technique_Name": "Clipboard Data"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing the GetAsyncKeyState API",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell calling the GetAsyncKeyState API.",
    "A Technique alert detection called dotnet-keylogging (medium severity) was generated for use of the GetAsyncKeyState API."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Captured user keystrokes using the GetAsyncKeyState API",
  "ScreenshotDatasources": [],
  "Step": "7. Collection and Exfiltration",
  "Substep": "7.A.3",
  "Subtechnique": "T1056.001",
  "Subtechnique_Name": "Input Capture: Keylogging",
  "TacticGroup": "Collection",
  "Technique": "T1056",
  "Technique_Name": "Input Capture"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe reading files in C:\\Users\\pam\\Downloads\\",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Read data in the user's Downloads directory using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "7. Collection and Exfiltration",
  "Substep": "7.B.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Collection",
  "Technique": "T1005",
  "Technique_Name": "Data from Local System"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe creating the file OfficeSupplies.7z",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Compressed data from the user's Downloads directory into a ZIP file (OfficeSupplies.7z) using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "7. Collection and Exfiltration",
  "Substep": "7.B.2",
  "Subtechnique": "T1560.001",
  "Subtechnique_Name": "Archive Collected Data: Archive via Utility",
  "TacticGroup": "Collection",
  "Technique": "T1560",
  "Technique_Name": "Archive Collected Data"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Compress-7Zip with the password argument used for encryption",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing Compress-7Zip with arguments for encryption.",
    "An MSSP detection occurred containing evidence of PowerShell compressing and encrypting contents of the downloads folder."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Encrypted data from the user's Downloads directory using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "7. Collection and Exfiltration",
  "Substep": "7.B.3",
  "Subtechnique": "T1560.001",
  "Subtechnique_Name": "Archive Collected Data: Archive via Utility",
  "TacticGroup": "Collection",
  "Technique": "T1560",
  "Technique_Name": "Archive Collected Data"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell executing Copy-Item pointing to an attack-controlled WebDav network share (192.168.0.4:80)",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of PoweShell Copy-Item to remote WebDav network share (192.168.0.4)"
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Exfiltrated collection (OfficeSupplies.7z) to WebDAV network share using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "7. Collection and Exfiltration",
  "Substep": "7.B.4",
  "Subtechnique": "T1048.003",
  "Subtechnique_Name": "Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol",
  "TacticGroup": "Exfiltration",
  "Technique": "T1048",
  "Technique_Name": "Exfiltration Over Alternative Protocol"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe making LDAP queries over port 389 to the Domain Controller (10.0.0.4)",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed powershell.exe establishing a connection to NewYork (10.0.0.4) over TCP port 389."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Enumerated remote systems using LDAP queries",
  "ScreenshotDatasources": [],
  "Step": "8. Expand Access",
  "Substep": "8.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1018",
  "Technique_Name": "Remote System Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Network connection to Scranton (10.0.1.4) over port 5985",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing Invoke-Command and connected to remote host Scranton (10.0.1.4) over port 5985.",
    "A Technique alert detection (medium severity) was generated due to PowerShell using WinRM."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Established WinRM connection to remote host Scranton (10.0.1.4)",
  "ScreenshotDatasources": [],
  "Step": "8. Expand Access",
  "Substep": "8.A.2",
  "Subtechnique": "T1021.006",
  "Subtechnique_Name": "Remote Services: Windows Remote Management",
  "TacticGroup": "Lateral Movement",
  "Technique": "T1021",
  "Technique_Name": "Remote Services"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Get-Process",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing Get-Process.",
    "An MSSP detection occurred containing evidence of PowerShell being used to get process information from the remote system Scranton."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Enumerated processes on remote host Scranton (10.0.1.4) using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "8. Expand Access",
  "Substep": "8.A.3",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "Technique_Name": "Process Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "The file python.exe created on Scranton (10.0.1.4)",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed a file create event of python.exe.",
    "An MSSP detection occurred containing evidence that python.exe was copied to remote host Scranton (10.0.1.4)."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Copied python.exe payload from a WebDAV share (192.168.0.4) to remote host Scranton (10.0.1.4)",
  "ScreenshotDatasources": [],
  "Step": "8. Expand Access",
  "Substep": "8.B.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Evidence that the file python.exe is packed",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Host Interrogation"
  ],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "python.exe payload was packed with UPX",
  "ScreenshotDatasources": [],
  "Step": "8. Expand Access",
  "Substep": "8.B.2",
  "Subtechnique": "T1027.002",
  "Subtechnique_Name": "Obfuscated Files or Information: Software Packing",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1027",
  "Technique_Name": "Obfuscated Files or Information"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Successful logon as user Pam on Scranton (10.0.1.4)",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed a valid logon on Scranton (10.0.1.4) as user Pam.",
    "An MSSP detection occurred containing evidence of a valid logon on Scranton (10.0.1.4) as user Pam."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Logged on to remote host Scranton (10.0.1.4) using valid credentials for user Pam",
  "ScreenshotDatasources": [],
  "Step": "8. Expand Access",
  "Substep": "8.C.1",
  "Subtechnique": "T1078.002",
  "Subtechnique_Name": "Valid Accounts: Domain Accounts",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1078",
  "Technique_Name": "Valid Accounts"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "SMB session to Scranton (10.0.1.4) over TCP port 445/135 OR evidence of usage of a Windows share",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 135."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Established SMB session to remote host Scranton's (10.0.1.4) IPC$ share using PsExec",
  "ScreenshotDatasources": [],
  "Step": "8. Expand Access",
  "Substep": "8.C.2",
  "Subtechnique": "T1021.002",
  "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares",
  "TacticGroup": "Lateral Movement",
  "Technique": "T1021",
  "Technique_Name": "Remote Services"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "python.exe spawned by PSEXESVC.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed python.exe spawned by PSEXESVC.exe.",
    "A Technique alert detection (low severity) for \"Service Execution\" was generated due to PsExec running a process remotely. The event was correlated to parent alert for Abnormal File Modification.",
    "An MSSP detection occurred containing evidence of PSEXESVC.exe executing python.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Executed python.exe using PSExec",
  "ScreenshotDatasources": [],
  "Step": "8. Expand Access",
  "Substep": "8.C.3",
  "Subtechnique": "T1569.002",
  "Subtechnique_Name": "System Services: Service Execution",
  "TacticGroup": "Execution",
  "Technique": "T1569",
  "Technique_Name": "System Services"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "python.exe creating the file rar.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed FILE_CREATE event for python.exe creating rar.exe.",
    "An MSSP detection occurred containing evidence that rar.exe was copied to remote host Scranton (10.0.1.4)."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Dropped rar.exe to disk on remote host Scranton (10.0.1.4)",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "python.exe creating the file sdelete64.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed FILE_CREATE event for python.exe creating sdelete64.exe.",
    "An MSSP detection occurred containing evidence that sdelete.exe was copied to remote host Scranton (10.0.1.4)."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Dropped sdelete.exe to disk on remote host Scranton (10.0.1.4)",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.A.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe spawning from python.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed python.exe executing powershell.exe. This event was correlated to prior detection for the python.exe process."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Spawned interactive powershell.exe",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.B.1",
  "Subtechnique": "T1059.001",
  "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing (Get-)ChildItem",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing ChildItem.",
    "An MSSP detection occurred containing evidence of PowerShell executing ChildItem to search the file system."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Searched filesystem for document and media files using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.B.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "Technique_Name": "File and Directory Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing (Get-)ChildItem",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing ChildItem.",
    "An MSSP detection occurred containing evidence of PowerShell executing ChildItem to search the file system."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Scripted search of filesystem for document and media files using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.B.3",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Collection",
  "Technique": "T1119",
  "Technique_Name": "Automated Collection"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe reading files in C:\\Users\\Pam\\",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.B.4",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Collection",
  "Technique": "T1005",
  "Technique_Name": "Data from Local System"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe creating the file working.zip",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed a FILE_CREATE event for powershell.exe creating working.zip.",
    "An MSSP detection occurred containing evidence of PowerShell staging files into working.zip."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Staged files for exfiltration into ZIP (working.zip in AppData directory) using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.B.5",
  "Subtechnique": "T1074.001",
  "Subtechnique_Name": "Data Staged: Local Data Staging",
  "TacticGroup": "Collection",
  "Technique": "T1074",
  "Technique_Name": "Data Staged"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing rar.exe with the -a parameter for a password to use for encryption",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing rar.exe with command-line arguments. This event was correlated to a previous detection for Abnormal File Modification.",
    "An MSSP detection occurred containing evidence that rar.exe was used to compress and encrypt working.zip."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Encrypted staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.B.6",
  "Subtechnique": "T1560.001",
  "Subtechnique_Name": "Archive Collected Data: Archive via Utility",
  "TacticGroup": "Collection",
  "Technique": "T1560",
  "Technique_Name": "Archive Collected Data"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing rar.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing rar.exe with command-line arguments. This event was correlated to a previous detection for Abnormal File Modification.",
    "An MSSP detection occurred containing evidence that rar.exe was used to compress and encrypt working.zip."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Compressed staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.B.7",
  "Subtechnique": "T1560.001",
  "Subtechnique_Name": "Archive Collected Data: Archive via Utility",
  "TacticGroup": "Collection",
  "Technique": "T1560",
  "Technique_Name": "Archive Collected Data"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "python.exe reading the file working.zip while connected to the C2 channel",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Read and downloaded ZIP (working.zip on Desktop) over C2 channel (192.168.0.5 over TCP port 8443)",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.B.8",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1041",
  "Technique_Name": "Exfiltration Over Command and Control Channel"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "sdelete64.exe deleting the file rar.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Alert"
  ],
  "DetectionText": [
    "Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe. The event was correlated to a Technique detection on python.exe.",
    "A Technique alert detection (medium severity) for \"Sdelete file removal\" was generated when sdelete64.exe with command-line arguments was used to delete rar.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Deleted rar.exe on disk using SDelete",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.C.1",
  "Subtechnique": "T1070.004",
  "Subtechnique_Name": "Indicator Removal on Host: File Deletion",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1070",
  "Technique_Name": "Indicator Removal on Host"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "sdelete64.exe deleting the file \\Desktop\\working.zip",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed sdelete64.exe with command-line arguments to delete Desktop\\working.zip. The event was correlated to a Technique detection on python.exe.",
    "A Technique alert detection (medium severity) for \"Sdelete file removal\" was generated when sdelete64.exe with command-line arguments was used to delete rar.exe.",
    "An MSSP detection occurred containing evidence of sdelete deleting Desktop\\working.zip."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Deleted working.zip (from Desktop) on disk using SDelete",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.C.2",
  "Subtechnique": "T1070.004",
  "Subtechnique_Name": "Indicator Removal on Host: File Deletion",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1070",
  "Technique_Name": "Indicator Removal on Host"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "sdelete64.exe deleting the file \\AppData\\Roaming\\working.zip",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip. The event was correlated to a Technique detection on python.exe.",
    "A Technique alert detection (medium severity) for \"Sdelete file removal\" was generated when sdelete64.exe with command-line arguments was used to delete rar.exe.",
    "An MSSP detection occurred containing evidence of sdelete deleting Roaming\\working.zip."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Deleted working.zip (from AppData directory) on disk using SDelete",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.C.3",
  "Subtechnique": "T1070.004",
  "Subtechnique_Name": "Indicator Removal on Host: File Deletion",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1070",
  "Technique_Name": "Indicator Removal on Host"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "cmd.exe deleting the file sdelete64.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed the file deletion of sdelete64.exe.",
    "An MSSP detection occurred containing evidence of the deletion of sdelete.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Deleted SDelete on disk using cmd.exe del command",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.C.4",
  "Subtechnique": "T1070.004",
  "Subtechnique_Name": "Indicator Removal on Host: File Deletion",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1070",
  "Technique_Name": "Indicator Removal on Host"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "javamtsup.exe spawning from services.exe",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Executed persistent service (javamtsup) on system startup",
  "ScreenshotDatasources": [],
  "Step": "10. Persistence Execution",
  "Substep": "10.A.1",
  "Subtechnique": "T1569.002",
  "Subtechnique_Name": "System Services: Service Execution",
  "TacticGroup": "Execution",
  "Technique": "T1569",
  "Technique_Name": "System Services"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Evidence that the file hostui.lnk (which executes hostui.bat as a byproduct) was executed from the Startup Folder",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Executed LNK payload (hostui.lnk) in Startup Folder on user login",
  "ScreenshotDatasources": [],
  "Step": "10. Persistence Execution",
  "Substep": "10.B.1",
  "Subtechnique": "T1547.001",
  "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder",
  "TacticGroup": "Persistence",
  "Technique": "T1547",
  "Technique_Name": "Boot or Logon Autostart Execution"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "hostui.exe executing the CreateProcessWithToken API",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Executed PowerShell payload via the CreateProcessWithToken API",
  "ScreenshotDatasources": [],
  "Step": "10. Persistence Execution",
  "Substep": "10.B.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Execution",
  "Technique": "T1106",
  "Technique_Name": "Native API"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "hostui.exe manipulating the token of powershell.exe via the CreateProcessWithToken API OR powershell.exe executing with the stolen token of explorer.exe",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Manipulated the token of the PowerShell payload via the CreateProcessWithToken API",
  "ScreenshotDatasources": [],
  "Step": "10. Persistence Execution",
  "Substep": "10.B.3",
  "Subtechnique": "T1134.002",
  "Subtechnique_Name": "Access Token Manipulation: Create Process with Token",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1134",
  "Technique_Name": "Access Token Manipulation"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe spawning from explorer.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed explorer.exe executing powershell.exe.",
    "An MSSP detection occurred containing evidence user Oscar executed 37486-the-shockingtruth-about-election-rigging-in-america.rtf.lnk."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "User Oscar executed payload 37486-the-shocking-truth-about-election-rigging-in-america.rtf.lnk",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.1",
  "Subtechnique": "T1204.002",
  "Subtechnique_Name": "User Execution: Malicious File",
  "TacticGroup": "Execution",
  "Technique": "T1204",
  "Technique_Name": "User Execution"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing the schemas ADS via Get-Content and IEX",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.",
    "A Technique alert detection (high severity) was generated due to PowerShell running a script from an ADS.",
    "An MSSP detection occurred containing evidence of PowerShell executing schemas ADS via Get-Content and IEX."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Executed an alternate data stream (ADS) using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.2",
  "Subtechnique": "T1564.004",
  "Subtechnique_Name": "Hide Artifacts: NTFS File Attributes",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1564",
  "Technique_Name": "Hide Artifacts"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_BIOS",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed the PowerShell gwmi query for Win32_BIOS.",
    "An MSSP detection occurred containing evidence of PowerShell gwmi query for Win32_BIOS."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Checked that the BIOS version and serial number are not associated with VirtualBox or VMware using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.3",
  "Subtechnique": "T1497.001",
  "Subtechnique_Name": "Virtualization/Sandbox Evasion: System Checks",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1497",
  "Technique_Name": "Virtualization/Sandbox Evasion"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing a Get-WmiObject gwmi queries for Win32_BIOS and Win32_ComputerSystem",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.",
    "An MSSP detection occurred containing evidence of PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Enumerated computer manufacturer, model, and version information using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.4",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1082",
  "Technique_Name": "System Information Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_PnPEntity",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed the PowerShell gwmi query for Win32_PnPEntity.",
    "An MSSP detection occurred containing evidence of PowerShell gwmi query for Win32_PnPEntity."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Enumerated devices/adapters to check for presence of VirtualBox driver(s) using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.5",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1120",
  "Technique_Name": "Peripheral Device Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem.",
    "An MSSP detection occurred containing evidence of PowerShell gwmi query for Win32_ComputerSystem."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Checked that the username is not related to admin or a generic value (ex: user) using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.6",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1033",
  "Technique_Name": "System Owner/User Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe gwmi query for Win32_ComputerSystem.",
    "An MSSP detection occurred containing evidence of PowerShell gwmi query for Win32_ComputerSystem."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Checked that the computer is joined to a domain using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.7",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1016",
  "Technique_Name": "System Network Configuration Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_Process",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed the PowerShell gwmi query for Win32_Process.",
    "An MSSP detection occurred containing evidence of PowerShell gwmi query for Win32_Process."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Checked that processes such as procexp.exe, taskmgr.exe, or wireshark.exe are not running using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.8",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "Technique_Name": "Process Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing (Get-Item -Path \".\\\" -Verbose).FullName",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed PowerShell executing Get-Item for the current path."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Checked that the payload is not inside a folder path that contains \"sample\" or is the length of a hash value using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.9",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "Technique_Name": "File and Directory Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "certutil.exe decoding kxwn.lock",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.",
    "A Technique alert detection (medium severity) was generated for certutil with decode switch usage.",
    "An MSSP occurred containing evidence of certutil.exe decoding kxwn.lock."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Decoded an embedded DLL payload to disk using certutil.exe",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.10",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Defense Evasion",
  "Technique": "T1140",
  "Technique_Name": "Deobfuscate/Decode Files or Information"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Addition of the Webcache subkey in HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed a Registry write event of the Webcache subkey identified as an Autorun.",
    "A Technique alert detection (high severity) was generated for a detected process performing a Registry write that looks like a launchpoint.",
    "An MSSP detection occurred containing evidence of the creation of a registry value named \"Webcache.\""
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Established Registry Run key persistence using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.11",
  "Subtechnique": "T1547.001",
  "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder",
  "TacticGroup": "Persistence",
  "Technique": "T1547",
  "Technique_Name": "Boot or Logon Autostart Execution"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe spawning from from the schemas ADS (powershell.exe)",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe spawned from a PowerShell stager.",
    "A Technique alert detection (high severity)  for a Powershell script launched from ads was generated due to a PowerShell script launched from an ADS."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Executed PowerShell stager payload",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.12",
  "Subtechnique": "T1059.001",
  "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Established network channel over port 443",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.",
    "An MSSP occurred containing evidence of a connection back to the C2 server 192.168.0.4 over port 443."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Established C2 channel (192.168.0.4) via PowerShell payload over port 443",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.13",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1043",
  "Technique_Name": "Commonly Used Port"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Established network channel over the HTTPS protocol",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed PowerShell making network connection to C2 (192.168.0.4) over HTTPS."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Used HTTPS to transport C2 (192.168.0.4) traffic",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.14",
  "Subtechnique": "T1071.001",
  "Subtechnique_Name": "Application Layer Protocol: Web Protocols",
  "TacticGroup": "Command and Control",
  "Technique": "T1071",
  "Technique_Name": "Application Layer Protocol"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Evidence that the network data sent over the C2 channel is encrypted",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed PowerShell making network connection to C2 (192.168.0.4) over HTTPS."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Used HTTPS to encrypt C2 (192.168.0.4) traffic",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.15",
  "Subtechnique": "T1573.002",
  "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography",
  "TacticGroup": "Command and Control",
  "Technique": "T1573",
  "Technique_Name": "Encrypted Channel"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing (gci ((gci env:windir).Value + '\\system32')",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed the PowerShell enumeration of the System32 directory.",
    "An MSSP detection occurred containing evidence of PowerShell enumeration of System32."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Enumerated the System32 directory using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "12. Fortify Access",
  "Substep": "12.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "Technique_Name": "File and Directory Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe modifying the creation, last access, and last write times of kxwn.lock",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed the LastWriteTime of kxwn.lock being accessed.",
    "An MSSP detection occurred containing evidence of the Powershell function \"timestomp\" being called to modify the creation time of kxwn.lock."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Modified the time attributes of the kxwn.lock persistence payload using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "12. Fortify Access",
  "Substep": "12.A.2",
  "Subtechnique": "T1070.006",
  "Subtechnique_Name": "Indicator Removal on Host: Timestomp",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1070",
  "Technique_Name": "Indicator Removal on Host"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing a Get-WmiObject query for AntiVirusProduct",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell gwmi query for AntiVirusProduct",
    "A Technique alert detection (informational severity) was generated for for WMI querying information about anti-virus products.",
    "An MSSP detection occurred containing evidence of PowerShell gwmi query for AntiVirusProduct."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Enumerated registered AV products using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "12. Fortify Access",
  "Substep": "12.B.1",
  "Subtechnique": "T1518.001",
  "Subtechnique_Name": "Software Discovery: Security Software Discovery",
  "TacticGroup": "Discovery",
  "Technique": "T1518",
  "Technique_Name": "Software Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed script block with registry query for installed software.",
    "An MSSP detection occurred containing evidence of Powershell functions which queried the WMI security centre class and also the software uninstall registry keys."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Enumerated installed software via the Registry (Wow6432 Uninstall key) using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "12. Fortify Access",
  "Substep": "12.C.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1012",
  "Technique_Name": "Query Registry"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed script block with registry query for installed software.",
    "An MSSP detection occurred containing evidence of Powershell functions which queried the WMI security centre class and also the software uninstall registry keys."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Enumerated installed software via the Registry (Uninstall key) using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "12. Fortify Access",
  "Substep": "12.C.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1012",
  "Technique_Name": "Query Registry"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing the GetComputerNameEx API",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell calling the GetComputerNameEx API.",
    "An MSSP detection occurred containing evidence of PowerShell calling the GetComputerNameEx API."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Enumerated the computer name using the GetComputerNameEx API",
  "ScreenshotDatasources": [],
  "Step": "13. Reconnaissance",
  "Substep": "13.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1082",
  "Technique_Name": "System Information Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing the NetWkstaGetInfo API",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed the NetWkstaGetInfo API call.",
    "An MSSP detection occurred containing evidence of PowerShell calling the NetWkstaGetInfo API."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Enumerated the domain name using the NetWkstaGetInfo API",
  "ScreenshotDatasources": [],
  "Step": "13. Reconnaissance",
  "Substep": "13.B.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1016",
  "Technique_Name": "System Network Configuration Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing the GetUserNameEx API",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed the GetUserNameEx API call.",
    "An MSSP detection occurred containing evidence of PowerShell calling the GetUserNameEx API."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Enumerated the current username using the GetUserNameEx API",
  "ScreenshotDatasources": [],
  "Step": "13. Reconnaissance",
  "Substep": "13.C.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1033",
  "Technique_Name": "System Owner/User Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing the CreateToolhelp32Snapshot API",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed the CreateToolhelp32Snapshot API call.",
    "An MSSP detection occurred containing evidence of PowerShell calling the CreateToolhelp32Snapshot API."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Enumerated running processes using the CreateToolhelp32Snapshot API",
  "ScreenshotDatasources": [],
  "Step": "13. Reconnaissance",
  "Substep": "13.D.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "Technique_Name": "Process Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Addition of the DelegateExecute subkey in HKCU\\Software\\Classes\\Folder\\shell\\open\\command",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed a Registry command to add a new value, DelegateExecute.",
    "An MSSP detection occurred containing evidence of executed function \"bypass.\""
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "14. Elevation & Credential Access",
  "Substep": "14.A.1",
  "Subtechnique": "T1546.015",
  "Subtechnique_Name": "Event Triggered Execution: Component Object Model Hijacking",
  "TacticGroup": "Privilege Escalation",
  "Technique": "T1546",
  "Technique_Name": "Event Triggered Execution"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "High integrity powrshell.exe spawning from control.exe (spawned from sdclt.exe)",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "General",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed a new High Integrity PowerShell callback spawned from control.exe (indicated by the true \"elev\" flag).",
    "A General alert detection (high severity) was generated due to powershell.exe running with parameters associated with post exploitation payloads.",
    "An MSSP detection occurred containing evidence of executed function \"bypass.\""
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Executed elevated PowerShell payload",
  "ScreenshotDatasources": [],
  "Step": "14. Elevation & Credential Access",
  "Substep": "14.A.2",
  "Subtechnique": "T1548.002",
  "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control",
  "TacticGroup": "Privilege Escalation",
  "Technique": "T1548",
  "Technique_Name": "Abuse Elevation Control Mechanism"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Deletion of the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command subkey",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of the deletion of the Registry value."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Modified the Registry to remove artifacts of COM hijacking using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "14. Elevation & Credential Access",
  "Substep": "14.A.3",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Defense Evasion",
  "Technique": "T1112",
  "Technique_Name": "Modify Registry"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "WMI Process (WmiPrvSE.exe) executing powershell.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "Telemetry showed WmiPrvSE.exe executing powershell.exe",
    "A Technique alert detection (medium severity) for Windows Management Instrumentation was generated due to WMI starting a system process it normally doesn't start."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Created and executed a WMI class using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "14. Elevation & Credential Access",
  "Substep": "14.B.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Execution",
  "Technique": "T1047",
  "Technique_Name": "Windows Management Instrumentation"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Get-Process",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed PowerShell executing Get-Process."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Enumerated and tracked PowerShell processes using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "14. Elevation & Credential Access",
  "Substep": "14.B.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "Technique_Name": "Process Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe downloading and/or the file write of m.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed the file create event for m.exe in the System32 folder.",
    "A Technique alert detection (info severity) was generated for a suspicious download by PowerShell.",
    "An MSSP detection occurred containing evidence of the download and file write of m.exe into System32 folder."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Downloaded and dropped Mimikatz (m.exe) to disk",
  "ScreenshotDatasources": [],
  "Step": "14. Elevation & Credential Access",
  "Substep": "14.B.3",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "m.exe injecting into lsass.exe to dump credentials",
  "Datasources": [],
  "Detection": [
    "Technique",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Alert",
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection (medium severity) called \"Password Dumper Executed\" was generated due to a known password hash dumper running. This detection was correlated to a parent alert for privilege escalation.",
    "A Technique alert detection (high severity) called \"Mimikatz command line parameters\" was generated due to m.exe executing with command-line arguments indicative of Mimikatz credential dumping. This detection was correlated to a parent alert for privilege escalation.",
    "An MSSP detection occurred containing evidence of Mimikatz execution."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Dumped plaintext credentials using Mimikatz (m.exe)",
  "ScreenshotDatasources": [],
  "Step": "14. Elevation & Credential Access",
  "Substep": "14.B.4",
  "Subtechnique": "T1003.001",
  "Subtechnique_Name": "OS Credential Dumping: LSASS Memory",
  "TacticGroup": "Credential Access",
  "Technique": "T1003",
  "Technique_Name": "OS Credential Dumping"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Set-WmiInstance",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell writing encoded content into the WMI class.",
    "An MSSP detection occurred containing evidence of PowerShell Set-WmiInstance to write encoded content to Win32_AuditCode."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Encoded and wrote Mimikatz output to a WMI class property using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "14. Elevation & Credential Access",
  "Substep": "14.B.5",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Defense Evasion",
  "Technique": "T1027",
  "Technique_Name": "Obfuscated Files or Information"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Get-WmiInstance",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed PowerShell reading encoded content from the WMI class."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Read and decoded Mimikatz output from a WMI class property using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "14. Elevation & Credential Access",
  "Substep": "14.B.6",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Defense Evasion",
  "Technique": "T1140",
  "Technique_Name": "Deobfuscate/Decode Files or Information"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing $env:UserName",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed PowerShell executing $env:UserName."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Enumerated logged on users using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "15. Establish Persistence",
  "Substep": "15.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1033",
  "Technique_Name": "System Owner/User Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe creating the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription.",
    "An MSSP detection occurred containing evidence of WMI persistence being installed using the PowerShell function \"wmi.\""
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Established WMI event subscription persistence using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "15. Establish Persistence",
  "Substep": "15.A.2",
  "Subtechnique": "T1546.003",
  "Subtechnique_Name": "Event Triggered Execution: Windows Management Instrumentation Event Subscription",
  "TacticGroup": "Persistence",
  "Technique": "T1546",
  "Technique_Name": "Event Triggered Execution"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe making LDAP queries over port 389 via functions from System.DirectoryServices.dll",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed powershell.exe making a network connection to the domain controller NewYork (10.0.0.4) over TCP port 389 and a modload for System.DirectoryServices.dll."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Enumerated the domain controller host NewYork (10.0.0.4) using LDAP queries",
  "ScreenshotDatasources": [],
  "Step": "16. Expand Access",
  "Substep": "16.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1018",
  "Technique_Name": "Remote System Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing the ConvertSidToStringSid API",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed PowerShell executing the ConvertSidToStringSid API function."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Enumerated the domain SID (from current user SID) using the ConvertSidToStringSid API",
  "ScreenshotDatasources": [],
  "Step": "16. Expand Access",
  "Substep": "16.B.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1033",
  "Technique_Name": "System Owner/User Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing the ConvertSidToStringSid API function by loading Advapi32.dll",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed that PowerShell loaded Advapi32.dll in order to execute the ConvertSidToStringSid API function."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Executed the ConvertSidToStringSid API call by reflectively loading Advapi32.dll",
  "ScreenshotDatasources": [],
  "Step": "16. Expand Access",
  "Substep": "16.B.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Execution",
  "Technique": "T1106",
  "Technique_Name": "Native API"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Network connection to NewYork (10.0.0.4) over port 5985",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985.",
    "A Technique alert detection (informational severity) for Windows Remote Management was generated for powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Established a WinRM connection to the domain controller host NewYork (10.0.0.4)",
  "ScreenshotDatasources": [],
  "Step": "16. Expand Access",
  "Substep": "16.C.1",
  "Subtechnique": "T1021.006",
  "Subtechnique_Name": "Remote Services: Windows Remote Management",
  "TacticGroup": "Lateral Movement",
  "Technique": "T1021",
  "Technique_Name": "Remote Services"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Successful logon as user MScott on NewYork (10.0.0.4)",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed a successful logon on NewYork (10.0.0.4) as user MScott.",
    "An MSSP detection occurred containing evidence of lateral movement from utica to new york as the user mscott."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Logged on to the domain controller host NewYork (10.0.0.4) using valid credentials for user MScott",
  "ScreenshotDatasources": [],
  "Step": "16. Expand Access",
  "Substep": "16.C.2",
  "Subtechnique": "T1078.002",
  "Subtechnique_Name": "Valid Accounts: Domain Accounts",
  "TacticGroup": "Initial Access",
  "Technique": "T1078",
  "Technique_Name": "Valid Accounts"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "File write of m.exe by the WinRM process (wsmprovhost.exe)",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed the file create of m.exe in the System32 directory by wsmprovhost.exe.",
    "An MSSP detection occurred containing evidence of the file write of m.exe to System32."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Dropped Mimikatz (m.exe) to disk on the domain controller host NewYork (10.0.0.4) over a WinRM connection",
  "ScreenshotDatasources": [],
  "Step": "16. Expand Access",
  "Substep": "16.D.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Lateral Movement",
  "Technique": "T1570",
  "Technique_Name": "Lateral Tool Transfer"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "m.exe injecting into lsass.exe to dump credentials",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "Technique",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Alert",
    "Correlated",
    "Alert",
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed m.exe injecting a thread into lsass.exe.",
    "A Technique alert detection (high severity) for \"Credential Dumping\" was generated due to lsass memory dump. This detection was correlated to a parent detection for privilege escalation.",
    "A Technique alert detection (high severity) for Credential Dumping was generated due to a known password dumper being executed. This event was correlated to a parent detection for privilege escalation.",
    "A Technique alert detection (high severity) for \"Credential Dumping\" was generated due to Mimikatz command-line parameters being executed. This event was correlated to a parent detection for privilege escalation.",
    "An MSSP detection occurred containing evidence of Mimikatz dumping the KRBTGT hash."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Dumped the KRBTGT hash on the domain controller host NewYork (10.0.0.4) using Mimikatz (m.exe)",
  "ScreenshotDatasources": [],
  "Step": "16. Expand Access",
  "Substep": "16.D.2",
  "Subtechnique": "T1003.001",
  "Subtechnique_Name": "OS Credential Dumping: LSASS Memory",
  "TacticGroup": "Credential Access",
  "Technique": "T1003",
  "Technique_Name": "OS Credential Dumping"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "outlook.exe spawning from svchost.exe or powershell.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails.",
    "An MSSP detection occurred containing evidence of psemail Powershell function being used to read email for the user."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Dumped messages from the local Outlook inbox using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "17. Collection",
  "Substep": "17.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Collection",
  "Technique": "T1114",
  "Technique_Name": "Email Collection"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe reading the file MITRE-ATTACK-EVALS.HTML",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Read and collected a local file using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "17. Collection",
  "Substep": "17.B.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Collection",
  "Technique": "T1005",
  "Technique_Name": "Data from Local System"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe creating the file \\WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of MITRE-ATTACK-EVALS.html being copied into the Temp folder."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Staged collected file into directory using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "17. Collection",
  "Substep": "17.B.2",
  "Subtechnique": "T1074.001",
  "Subtechnique_Name": "Data Staged: Local Data Staging",
  "TacticGroup": "Collection",
  "Technique": "T1074",
  "Technique_Name": "Data Staged"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing the ZipFile.CreateFromDirectory .NET method",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell compressing collection via the ZipFile.CreateFromDirectory .NET method.",
    "An MSSP detection occurred containing evidence of PowerShell compressing WindowsParentalControlMigration."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Compressed a staging directory using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "17. Collection",
  "Substep": "17.C.1",
  "Subtechnique": "T1560.001",
  "Subtechnique_Name": "Archive Collected Data: Archive via Utility",
  "TacticGroup": "Collection",
  "Technique": "T1560",
  "Technique_Name": "Archive Collected Data"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Set-Content",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell appending the GIF file header to the compressed file.",
    "An MSSP detection occurred containing evidence of PowerShell appending the GIF file header to the compressed file."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Prepended the GIF file header to a compressed staging file using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "17. Collection",
  "Substep": "17.C.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Defense Evasion",
  "Technique": "T1027",
  "Technique_Name": "Obfuscated Files or Information"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "net.exe with command-line arguments then making a network connection to a public IP over port 443",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "General",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443.",
    "A General alert detection (informational severity) was generated for net.exe making a network connection. It included details of net.exe executing and connecting to a public IP over port 443. This is correlated to a previous detection for PowerShell.",
    "An MSSP detection occurred containing evidence of file exfiltration to a Microsoft OneDrive that is mapped as a share drive \"Y:\"."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Mapped a network drive to an online OneDrive account using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "18. Exfiltration",
  "Substep": "18.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1102",
  "Technique_Name": "Web Service"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Copy-Item pointing to drive mapped to an attack-controlled OneDrive account",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell executing Copy-Item to exfiltrate data to a previously mapped OneDrive account.",
    "An MSSP detection occurred containing evidence of file exfiltration to a Microsoft OneDrive that is mapped as a share drive \"Y:\"."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Exfiltrated staged collection to an online OneDrive account using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "18. Exfiltration",
  "Substep": "18.A.2",
  "Subtechnique": "T1567.002",
  "Subtechnique_Name": "Exfiltration Over Web Service: Exfiltration to Cloud Storage",
  "TacticGroup": "Exfiltration",
  "Technique": "T1567",
  "Technique_Name": "Exfiltration Over Web Service"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "rundll32.exe executing kxwn.lock",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "Technique"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert"
  ],
  "DetectionText": [
    "Telemetry showed rundll32.exe executing kxwn.lock.",
    "A Technique alert detection (medium severity) called \"Rundll32 launching a DLL in the AppData directory\" was generated due to rundll32.exe executing kxwn.lock.",
    "A Technique alert detection (medium severity) called \"Rare DLL explicitly loaded by rundll32\" was generated due to rundll32.exe executing kxwn.lock."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Executed Run key persistence payload on user login using RunDll32",
  "ScreenshotDatasources": [],
  "Step": "20. Persistence Execution",
  "Substep": "20.A.1",
  "Subtechnique": "T1218.011",
  "Subtechnique_Name": "Signed Binary Proxy Execution: Rundll32",
  "TacticGroup": "Execution",
  "Technique": "T1218",
  "Technique_Name": "Signed Binary Proxy Execution"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "The WMI process (wmiprvse.exe) executing powershell.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "General"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "Telemetry showed WmiPrvSE executing powershell.exe.",
    "A General alert detection (medium severity) was generated for WMI starting a system process it normally doesn't start."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Executed WMI persistence on user login",
  "ScreenshotDatasources": [],
  "Step": "20. Persistence Execution",
  "Substep": "20.A.2",
  "Subtechnique": "T1546.003",
  "Subtechnique_Name": "Event Triggered Execution: Windows Management Instrumentation Event Subscription",
  "TacticGroup": "Persistence",
  "Technique": "T1546",
  "Technique_Name": "Event Triggered Execution"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "SYSTEM-level powershell.exe spawned from the powershell.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell spawned from WMI event subscription (wmiprvse.exe).",
    "A Technique alert detection (high severity) was generated for powershell.exe running with parameters that are typically used in post-exploitation payloads."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Executed PowerShell payload from WMI event subscription persistence",
  "ScreenshotDatasources": [],
  "Step": "20. Persistence Execution",
  "Substep": "20.A.3",
  "Subtechnique": "T1059.001",
  "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Invoke-Mimikatz with command-line arguments to create a golden ticket",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "General",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell executing Invoke-Mimikatz to create and inject a golden ticket into the current session.",
    "A General alert detection (medium severity) was generated for a suspicious PowerShell command.",
    "An MSSP detection occurred containing evidence of Mimikatz being used to execute a golden ticket attack impersonating mscott."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Created Kerberos Golden Ticket using Invoke-Mimikatz",
  "ScreenshotDatasources": [],
  "Step": "20. Persistence Execution",
  "Substep": "20.B.1",
  "Subtechnique": "T1550.003",
  "Subtechnique_Name": "Use Alternate Authentication Material: Pass the Ticket",
  "TacticGroup": "Lateral Movement",
  "Technique": "T1550",
  "Technique_Name": "Use Alternate Authentication Material"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Network connection to Scranton (10.0.1.4) over port 5985",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell execution of Enter-PSSession and the corresponding powershell.exe network connection to remote host Scranton (10.0.1.4) over port 5985.",
    "A Technique alert detection (informational severity) was generated for PowerShell using Windows Remote Management."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Established a WinRM connection to the remote host Scranton (10.0.1.4) using the Golden Ticket as credentials",
  "ScreenshotDatasources": [],
  "Step": "20. Persistence Execution",
  "Substep": "20.B.2",
  "Subtechnique": "T1021.006",
  "Subtechnique_Name": "Remote Services: Windows Remote Management",
  "TacticGroup": "Lateral Movement",
  "Technique": "T1021",
  "Technique_Name": "Remote Services"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "net.exe adding the user Toby",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed the user Toby being created on the scranton host.",
    "A Technique alert detection (high severity) for net_user_add was generated due to net.exe being used to add a user account.",
    "An MSSP detection occurred containing evidence of new user \"Toby\" being created with net.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "withsecure",
  "Procedure": "Added a new user to the remote host Scranton (10.0.1.4) using net.exe",
  "ScreenshotDatasources": [],
  "Step": "20. Persistence Execution",
  "Substep": "20.B.3",
  "Subtechnique": "T1136.001",
  "Subtechnique_Name": "Create Account: Local Account",
  "TacticGroup": "Persistence",
  "Technique": "T1136",
  "Technique_Name": "Create Account"
}
