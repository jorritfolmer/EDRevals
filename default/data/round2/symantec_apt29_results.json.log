{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "The rcs.3aka3.doc process spawning from explorer.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "General"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "Telemetry showed explorer.exe executing rcs.3aka3.doc.",
    "A General alert detection was generated for \"malicious file ???.cod.3aka3.scr with heuristic signature SONAR.ProcHijack!g31\"."
  ],
  "Footnotes": [
    "Vendor stated a protection capability would have blocked execution of the malicious file."
  ],
  "Participant_Name": "symantec",
  "Procedure": "User Pam executed payload rcs.3aka3.doc",
  "ScreenshotDatasources": [],
  "Step": "1. Initial Compromise",
  "Substep": "1.A.1",
  "Subtechnique": "T1204.002",
  "Subtechnique_Name": "User Execution: Malicious File",
  "TacticGroup": "Execution",
  "Technique": "T1204",
  "Technique_Name": "User Execution"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Evidence of the right-to-left override character (U+202E) in the rcs.3aka.doc process OR the original filename (cod.3aka.scr)",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "General"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed original filename of cod.3aka.scr and it was a Windows PE file.",
    "A General detection was generated for \"Suspicious File Detected rcs.3aka3.doc\" due to machine learning identifying the payload as a PE32 executable and analyzing it."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Used unicode right-to-left override (RTLO) character to obfuscate file name rcs.3aka3.doc (originally cod.3aka.scr)",
  "ScreenshotDatasources": [],
  "Step": "1. Initial Compromise",
  "Substep": "1.A.2",
  "Subtechnique": "T1036.002",
  "Subtechnique_Name": "Masquerading: Right-to-Left Override",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1036",
  "Technique_Name": "Masquerading"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Established network channel over port 1234",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "General"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "Telemetry showed the rcs.3aka.doc connected to 192.168.0.5 on port 1234.",
    "A General alert detection for \"Attack, Backdoor\" was generated when rcs.3aka3.doc connected to 192.168.0.5 on port 1234."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Established C2 channel (192.168.0.5) via rcs.3aka3.doc payload over TCP port 1234",
  "ScreenshotDatasources": [],
  "Step": "1. Initial Compromise",
  "Substep": "1.A.3",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1095",
  "Technique_Name": "Non-Application Layer Protocol"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Evidence that the network data sent over the C2 channel is encrypted",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Used RC4 stream cipher to encrypt C2 (192.168.0.5) traffic",
  "ScreenshotDatasources": [],
  "Step": "1. Initial Compromise",
  "Substep": "1.A.4",
  "Subtechnique": "T1573.001",
  "Subtechnique_Name": "Encrypted Channel: Symmetric Cryptography",
  "TacticGroup": "Command and Control",
  "Technique": "T1573",
  "Technique_Name": "Encrypted Channel"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "cmd.exe spawning from the rcs.3aka3.doc process",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed rcs.3aka3.doc executing cmd.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Spawned interactive cmd.exe",
  "ScreenshotDatasources": [],
  "Step": "1. Initial Compromise",
  "Substep": "1.B.1",
  "Subtechnique": "T1059.003",
  "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe spawning from cmd.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe spawning from cmd.exe. The telemetry was correlated to a parent detection cod.3aka.scr as a suspicious file.",
    "A Technique detection for \"PowerShell\" was generated when cmd.exe spawned powershell.exe. The event was correlated to a parent detection cod.3aka.scr as a suspicious file.",
    "An MSSP detection for \"PowerShell\" was received that included a description of the PowerShell commands executed by the adversary."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Spawned interactive powershell.exe",
  "ScreenshotDatasources": [],
  "Step": "1. Initial Compromise",
  "Substep": "1.B.2",
  "Subtechnique": "T1059.001",
  "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing (Get-)ChildItem",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell execution of ChildItem.",
    "An MSSP detection for \"Data from Local System\" contained evidence of PowerShell executing ChildItem."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Searched filesystem for document and media files using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "2. Collection and Exfiltration",
  "Substep": "2.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "Technique_Name": "File and Directory Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing (Get-)ChildItem",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell execution of ChildItem.",
    "An MSSP detection for \"Data from Local System\" contained evidence of PowerShell executing ChildItem."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Scripted search of filesystem for document and media files using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "2. Collection and Exfiltration",
  "Substep": "2.A.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Collection",
  "Technique": "T1119",
  "Technique_Name": "Automated Collection"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe reading files in C:\\Users\\Pam\\",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "2. Collection and Exfiltration",
  "Substep": "2.A.3",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Collection",
  "Technique": "T1005",
  "Technique_Name": "Data from Local System"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Compress-Archive",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe compressing via Compress-Archive.",
    "A Technique detection for \"Data Compressed\" was generated when Draft.zip was identified as compressed. The event was correlated to a parent detection cod.3aka.scr as a malicious file.",
    "An MSSP detection for \"Data Compressed \"was received that included an explanation of the PowerShell script used to compress files and store the results in Draft.zip."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Compressed and stored files into ZIP (Draft.zip) using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "2. Collection and Exfiltration",
  "Substep": "2.A.4",
  "Subtechnique": "T1560.001",
  "Subtechnique_Name": "Archive Collected Data: Archive via Utility",
  "TacticGroup": "Collection",
  "Technique": "T1560",
  "Technique_Name": "Archive Collected Data"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe creating the file draft.zip",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed the creation of Draft.Zip. The telemetry was correlated to a parent detection cod.3aka.scr as a suspicious file."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Staged files for exfiltration into ZIP (Draft.zip) using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "2. Collection and Exfiltration",
  "Substep": "2.A.5",
  "Subtechnique": "T1560.001",
  "Subtechnique_Name": "Archive Collected Data: Archive via Utility",
  "TacticGroup": "Collection",
  "Technique": "T1560",
  "Technique_Name": "Archive Collected Data"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "The rcs.3aka3.doc process reading the file draft.zip while connected to the C2 channel",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Read and downloaded ZIP (Draft.zip) over C2 channel (192.168.0.5 over TCP port 1234)",
  "ScreenshotDatasources": [],
  "Step": "2. Collection and Exfiltration",
  "Substep": "2.B.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Exfiltration",
  "Technique": "T1041",
  "Technique_Name": "Exfiltration Over Command and Control Channel"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "The rcs.3aka3.doc process creating the file monkey.png",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed rcs.3aka3.doc creating monkey.png, with the file path reversed due to the Unicode right-to-left override character."
  ],
  "Footnotes": [
    "The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual)."
  ],
  "Participant_Name": "symantec",
  "Procedure": "Dropped stage 2 payload (monkey.png) to disk",
  "ScreenshotDatasources": [],
  "Step": "3. Deploy Stealth Toolkit",
  "Substep": "3.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Evidence that a PowerShell payload was within monkey.png",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Alert",
    "Correlated",
    "Delayed (Processing)",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell extracting and executing the code embedded within monkey.png. The telemetry was correlated to a parent detection cod.3aka.scr as a suspicious file.",
    "A Technique alert detection for Obfuscated Files or Information was generated for PowerShell extracting and executing the code embedded within monkey.png. The telemetry was correlated to a parent detection cod.3aka.scr as a suspicious file. Detection incurred a delay based on machine learning processing.",
    "An MSSP detection for \"Data Obfuscation\" occurred containing evidence of the PowerShell script contained within monkey.png."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Embedded PowerShell payload in monkey.png using steganography",
  "ScreenshotDatasources": [],
  "Step": "3. Deploy Stealth Toolkit",
  "Substep": "3.A.2",
  "Subtechnique": "T1027.003",
  "Subtechnique_Name": "Obfuscated Files or Information: Steganography",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1027",
  "Technique_Name": "Obfuscated Files or Information"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Addition of the DelegateExecute subkey in HKCU\\Software\\Classes\\Folder\\shell\\open\\command",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed the addition of the DelegateExecute Registry Value."
  ],
  "Footnotes": [
    "The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual)."
  ],
  "Participant_Name": "symantec",
  "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "3. Deploy Stealth Toolkit",
  "Substep": "3.B.1",
  "Subtechnique": "T1546.015",
  "Subtechnique_Name": "Event Triggered Execution: Component Object Model Hijacking",
  "TacticGroup": "Privilege Escalation",
  "Technique": "T1546",
  "Technique_Name": "Event Triggered Execution"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "High integrity powershell.exe spawning from control.exe (spawned from sdclt.exe)",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed control.exe creating a high integrity powershell.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Executed elevated PowerShell payload",
  "ScreenshotDatasources": [],
  "Step": "3. Deploy Stealth Toolkit",
  "Substep": "3.B.2",
  "Subtechnique": "T1548.002",
  "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control",
  "TacticGroup": "Privilege Escalation",
  "Technique": "T1548",
  "Technique_Name": "Abuse Elevation Control Mechanism"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Established network channel over port 443",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "General"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe connecting to 192.168.0.5 on port 443.",
    "A General alert detection for \"Attack, Backdoor\" was generated when PowerShell connected to 192.168.0.5 on port 443."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Established C2 channel (192.168.0.5) via PowerShell payload over TCP port 443",
  "ScreenshotDatasources": [],
  "Step": "3. Deploy Stealth Toolkit",
  "Substep": "3.B.3",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1043",
  "Technique_Name": "Commonly Used Port"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Evidence that the network data sent over the C2 channel is HTTPS",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "General"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell process exchanging data with 192.168.0.5 over HTTPS.",
    "A General alert detection for \"Attack, Backdoor\" was generated when PowerShell process exchanged data with 192.168.0.5 over HTTPS due to network traffic analysis."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Used HTTPS to transport C2 (192.168.0.5) traffic",
  "ScreenshotDatasources": [],
  "Step": "3. Deploy Stealth Toolkit",
  "Substep": "3.B.4",
  "Subtechnique": "T1071.001",
  "Subtechnique_Name": "Application Layer Protocol: Web Protocols",
  "TacticGroup": "Command and Control",
  "Technique": "T1071",
  "Technique_Name": "Application Layer Protocol"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Evidence that the network data sent over the C2 channel is encrypted",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "General"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell process exchanging data with 192.168.0.5 over HTTPS.",
    "A General alert detection for \"Attack, Backdoor\" was generated when PowerShell process exchanged data with 192.168.0.5 over HTTPS due to network traffic analysis."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Used HTTPS to encrypt C2 (192.168.0.5) traffic",
  "ScreenshotDatasources": [],
  "Step": "3. Deploy Stealth Toolkit",
  "Substep": "3.B.5",
  "Subtechnique": "T1573.002",
  "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography",
  "TacticGroup": "Command and Control",
  "Technique": "T1573",
  "Technique_Name": "Encrypted Channel"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Deletion of of the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command subkey",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed the deletion of the command subkey."
  ],
  "Footnotes": [
    "The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual)."
  ],
  "Participant_Name": "symantec",
  "Procedure": "Modified the Registry to remove artifacts of COM hijacking",
  "ScreenshotDatasources": [],
  "Step": "3. Deploy Stealth Toolkit",
  "Substep": "3.C.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Defense Evasion",
  "Technique": "T1112",
  "Technique_Name": "Modify Registry"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe creating the file SysinternalsSuite.zip",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed the file write of the ZIP by PowerShell."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Dropped additional tools (SysinternalsSuite.zip) to disk over C2 channel (192.168.0.5)",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe spawning from powershell.exe",
  "Datasources": [],
  "Detection": [
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique detection for \"PowerShell\" was generated when powershell.exe spawned powershell.exe.",
    "An MSSP detection occurred containing evidence of a new powershell.exe spawning from powershell.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Spawned interactive powershell.exe",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.A.2",
  "Subtechnique": "T1059.001",
  "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Expand-Archive",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "General"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell writing the files that were decompressed from the ZIP.",
    "A General alert detection was generated for \"PowerShell created a suspicious file\" on PowerShell writing the files that were decompressed from the ZIP."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Decompressed ZIP (SysinternalsSuite.zip) file using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.A.3",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Defense Evasion",
  "Technique": "T1140",
  "Technique_Name": "Deobfuscate/Decode Files or Information"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Get-Process",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of powershell.exe executing Get-Process."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Enumerated current running processes using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.B.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "Technique_Name": "Process Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "sdelete64.exe deleting the file rcs.3aka3.doc",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Tactic",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.",
    "A Tactic detection called \"Defense Evasion\" was generated when sdelete64.exe with command-line arguments was used to delete rcs.3aka3.doc.",
    "An MSSP detection for \"File Deletion\" occurred containing evidence of sdelete64.exe deleting rcs.3aka3.doc."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Deleted rcs.3aka3.doc on disk using SDelete",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.B.2",
  "Subtechnique": "T1070.004",
  "Subtechnique_Name": "Indicator Removal on Host: File Deletion",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1070",
  "Technique_Name": "Indicator Removal on Host"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "sdelete64.exe deleting the file draft.zip",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Tactic",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.",
    "A Tactic detection called \"Defense Evasion\" was generated when sdelete64.exe with command-line arguments was used to delete Roaming\\Draft.Zip.",
    "An MSSP detection for \"File Deletion\" occurred containing evidence of sdelete64.exe deleting Draft.Zip."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Deleted Draft.zip on disk using SDelete",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.B.3",
  "Subtechnique": "T1070.004",
  "Subtechnique_Name": "Indicator Removal on Host: File Deletion",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1070",
  "Technique_Name": "Indicator Removal on Host"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "sdelete64.exe deleting the file SysinternalsSuite.zip",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Tactic",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.",
    "A Tactic detection called \"Defense Evasion\" was generated when sdelete64.exe with command-line arguments was used to delete SysinternalsSuite.zip.",
    "An MSSP detection for \"File Deletion\" occurred containing evidence of sdelete64.exe deleting SysinternalsSuite.zip."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Deleted SysinternalsSuite.zip on disk using SDelete",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.B.4",
  "Subtechnique": "T1070.004",
  "Subtechnique_Name": "Indicator Removal on Host: File Deletion",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1070",
  "Technique_Name": "Indicator Removal on Host"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing $env:TEMP",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A MSSP detection for \"File and Directory Discovery\" was received that included details about a PowerShell script used for Discovery and mentioned that it collected the TempDirectory."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Enumerated user's temporary directory path using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "Technique_Name": "File and Directory Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing $env:USERNAME",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A MSSP detection for \"System Owner/User Discovery\" was received that included details about a PowerShell script used for Discovery and mentioned that it collected the User Name."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Enumerated the current username using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1033",
  "Technique_Name": "System Owner/User Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing $env:COMPUTERNAME",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A MSSP detection for \"System Information Discovery\" was received that included details about a PowerShell script used for Discovery and mentioned that it collected the Computer Name."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Enumerated the computer hostname using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.3",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1082",
  "Technique_Name": "System Information Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing $env:USERDOMAIN",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A MSSP detection was received that included details about a PowerShell script used for Discovery and mentioned that it collected the user's domain name."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Enumerated the current domain name using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.4",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1016",
  "Technique_Name": "System Network Configuration Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing $PID",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A MSSP detection was received that included details about a PowerShell script used for Discovery and mentioned that it collected the current PID."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Enumerated the current process ID using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.5",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "Technique_Name": "Process Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Gwmi Win32_OperatingSystem",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Enumerated the OS version using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.6",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1082",
  "Technique_Name": "System Information Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Get-WmiObject ... -Class AntiVirusProduct",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A MSSP detection was received that included details about a PowerShell script used for Discovery and mentioned that it collected information about installed antivirus and firewall products."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Enumerated anti-virus software using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.7",
  "Subtechnique": "T1518.001",
  "Subtechnique_Name": "Software Discovery: Security Software Discovery",
  "TacticGroup": "Discovery",
  "Technique": "T1518",
  "Technique_Name": "Software Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Get-WmiObject ... -Class FireWallProduct",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A MSSP detection was received that included details about a PowerShell script used for Discovery and mentioned that it collected information about installed antivirus and firewall products."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Enumerated firewall software using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.8",
  "Subtechnique": "T1518.001",
  "Subtechnique_Name": "Software Discovery: Security Software Discovery",
  "TacticGroup": "Discovery",
  "Technique": "T1518",
  "Technique_Name": "Software Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing the NetUserGetGroups API",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A MSSP detection for \"Permissions Groups Discovery\" was received that included details about a PowerShell script used for Discovery and mentioned that it collected a list of global groups."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Enumerated user's domain group membership via the NetUserGetGroups API",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.9",
  "Subtechnique": "T1069.002",
  "Subtechnique_Name": "Permission Groups Discovery: Domain Groups",
  "TacticGroup": "Discovery",
  "Technique": "T1069",
  "Technique_Name": "Permission Groups Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "The NetUserGetGroups API function loaded into powershell.exe from Netapi32.dll",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Executed API call by reflectively loading Netapi32.dll",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.10",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Execution",
  "Technique": "T1106",
  "Technique_Name": "Native API"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing the NetUserGetLocalGroups API",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A MSSP detection for \"Permissions Groups Discovery\" was received that included details about a PowerShell script used for Discovery and mentioned that it collected a list of local groups."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Enumerated user's local group membership via the NetUserGetLocalGroups API",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.11",
  "Subtechnique": "T1069.001",
  "Subtechnique_Name": "Permission Groups Discovery: Local Groups",
  "TacticGroup": "Discovery",
  "Technique": "T1069",
  "Technique_Name": "Permission Groups Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "The NetUserGetLocalGroups API function loaded into powershelle.exe from Netapi32.dll",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Executed API call by reflectively loading Netapi32.dll",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.12",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Execution",
  "Technique": "T1106",
  "Technique_Name": "Native API"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe creating the Javamtsup service",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed a registry event for the creation of javamtsup service.",
    "A Technique detection for \"New Service\" was generated due to services.exe creating javamtsup."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Created a new service (javamtsup) that executes a service binary (javamtsup.exe) at system startup",
  "ScreenshotDatasources": [],
  "Step": "5. Establish Persistence",
  "Substep": "5.A.1",
  "Subtechnique": "T1543.003",
  "Subtechnique_Name": "Create or Modify System Process: Windows Service",
  "TacticGroup": "Persistence",
  "Technique": "T1543",
  "Technique_Name": "Create or Modify System Process"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe creating the file hostui.lnk in the Startup folder",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed creation of hostui.lnk in the Startup folder.",
    "A Technique detection for \"Registry Run Keys / Startup Folder\" was generated due to powershell.exe creating the hostui.lnk file."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Created a LNK file (hostui.lnk) in the Startup folder that executes on login",
  "ScreenshotDatasources": [],
  "Step": "5. Establish Persistence",
  "Substep": "5.B.1",
  "Subtechnique": "T1547.001",
  "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder",
  "TacticGroup": "Persistence",
  "Technique": "T1547",
  "Technique_Name": "Boot or Logon Autostart Execution"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "accesschk.exe reading files within %APPDATALOCAL%\\Google\\chrome\\user data\\default\\",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Read the Chrome SQL database file to extract encrypted credentials",
  "ScreenshotDatasources": [],
  "Step": "6. Credential Access",
  "Substep": "6.A.1",
  "Subtechnique": "T1552.001",
  "Subtechnique_Name": "Unsecured Credentials: Credentials in Files",
  "TacticGroup": "Credential Access",
  "Technique": "T1552",
  "Technique_Name": "Unsecured Credentials"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "accesschk.exe executing the CryptUnprotectedData API",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Executed the CryptUnprotectedData API call to decrypt Chrome passwords",
  "ScreenshotDatasources": [],
  "Step": "6. Credential Access",
  "Substep": "6.A.2",
  "Subtechnique": "T1555.003",
  "Subtechnique_Name": "Credentials from Password Stores: Credentials from Web Browsers",
  "TacticGroup": "Credential Access",
  "Technique": "T1555",
  "Technique_Name": "Credentials from Password Stores"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Evidence that accesschk.exe is not the legitimate Sysinternals tool",
  "Datasources": [],
  "Detection": [
    "General"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "A General alert detection was generated for \"Potential risk found\" on accesschk.exe receiving a reputation report that indicated it was known to be an untrusted file with the maximum suspicion rating, which indicates it is not a legitimate Sysinternals tool."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Masqueraded a Chrome password dump tool as accesscheck.exe, a legitimate Sysinternals tool",
  "ScreenshotDatasources": [],
  "Step": "6. Credential Access",
  "Substep": "6.A.3",
  "Subtechnique": "T1036.005",
  "Subtechnique_Name": "Masquerading: Match Legitimate Name or Location",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1036",
  "Technique_Name": "Masquerading"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe creating a certificate file exported from the system",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe.",
    "An MSSP detection for \"Private Keys\" occurred containing evidence of readme.ps1 analysis indicating Get-PrivateKeys execution writing a .pfx file."
  ],
  "Footnotes": [
    "The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual)."
  ],
  "Participant_Name": "symantec",
  "Procedure": "Exported a local certificate to a PFX file using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "6. Credential Access",
  "Substep": "6.B.1",
  "Subtechnique": "T1552.004",
  "Subtechnique_Name": "Unsecured Credentials: Private Keys",
  "TacticGroup": "Credential Access",
  "Technique": "T1552",
  "Technique_Name": "Unsecured Credentials"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe injecting into lsass.exe OR lsass.exe reading Registry keys under HKLM:\\SAM\\SAM\\Domains\\Account\\Users\\",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "General",
    "Technique"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe injecting into lsass.exe.",
    "A General alert detection for \"Process Injection\" was generated on \"PowerShell injected into Microsoft signed process\".",
    "A Technique alert detection for \"Credential Dumping\" was generated when PowerShell attempted injection into lsass."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Dumped password hashes from the Windows Registry by injecting a malicious DLL into Lsass.exe",
  "ScreenshotDatasources": [],
  "Step": "6. Credential Access",
  "Substep": "6.C.1",
  "Subtechnique": "T1003.002",
  "Subtechnique_Name": "OS Credential Dumping: Security Account Manager",
  "TacticGroup": "Credential Access",
  "Technique": "T1003",
  "Technique_Name": "OS Credential Dumping"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing the CopyFromScreen function from System.Drawing.dll",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection for \"Screen Capture\" was received that included details about a PowerShell script used to collect screenshots."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Captured and saved screenshots using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "7. Collection and Exfiltration",
  "Substep": "7.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Collection",
  "Technique": "T1113",
  "Technique_Name": "Screen Capture"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Get-Clipboard",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection for \"Clipboard Data\" was received for PowerShell executing \"Get-Clipboard\" to retrieve clipboard contents."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Captured clipboard contents using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "7. Collection and Exfiltration",
  "Substep": "7.A.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Collection",
  "Technique": "T1115",
  "Technique_Name": "Clipboard Data"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing the GetAsyncKeyState API",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection for \"Input Capture\" occurred containing evidence of Get-Keystrokes function execution from psversion.ps1."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Captured user keystrokes using the GetAsyncKeyState API",
  "ScreenshotDatasources": [],
  "Step": "7. Collection and Exfiltration",
  "Substep": "7.A.3",
  "Subtechnique": "T1056.001",
  "Subtechnique_Name": "Input Capture: Keylogging",
  "TacticGroup": "Collection",
  "Technique": "T1056",
  "Technique_Name": "Input Capture"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe reading files in C:\\Users\\pam\\Downloads\\",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Read data in the user's Downloads directory using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "7. Collection and Exfiltration",
  "Substep": "7.B.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Collection",
  "Technique": "T1005",
  "Technique_Name": "Data from Local System"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe creating the file OfficeSupplies.7z",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed the creation of OfficeSupplies.7z.",
    "A Technique detection for \"Data Compressed\" was generated when powershell.exe created OfficeSupplies.7z.",
    "An MSSP detection occurred for \"Data Compressed\" containing evidence of Invoke-Exfil function using 7-zip with password \"lolol\" to compressed downloads directory into OfficeSupplies.7z."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Compressed data from the user's Downloads directory into a ZIP file (OfficeSupplies.7z) using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "7. Collection and Exfiltration",
  "Substep": "7.B.2",
  "Subtechnique": "T1560.001",
  "Subtechnique_Name": "Archive Collected Data: Archive via Utility",
  "TacticGroup": "Collection",
  "Technique": "T1560",
  "Technique_Name": "Archive Collected Data"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Compress-7Zip with the password argument used for encryption",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence that data was compressed and password encrypted for exfiltration."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Encrypted data from the user's Downloads directory using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "7. Collection and Exfiltration",
  "Substep": "7.B.3",
  "Subtechnique": "T1560.001",
  "Subtechnique_Name": "Archive Collected Data: Archive via Utility",
  "TacticGroup": "Collection",
  "Technique": "T1560",
  "Technique_Name": "Archive Collected Data"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell executing Copy-Item pointing to an attack-controlled WebDav network share (192.168.0.4:80)",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed a .7z file creation to a remote file share.",
    "An MSSP detection for \"Exfiltration over Alternative Protocol\" occurred containing evidence of exfiltration to remote WebDav network share (192.168.0.4)."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Exfiltrated collection (OfficeSupplies.7z) to WebDAV network share using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "7. Collection and Exfiltration",
  "Substep": "7.B.4",
  "Subtechnique": "T1048.003",
  "Subtechnique_Name": "Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol",
  "TacticGroup": "Exfiltration",
  "Technique": "T1048",
  "Technique_Name": "Exfiltration Over Alternative Protocol"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe making LDAP queries over port 389 to the Domain Controller (10.0.0.4)",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe establishing a connection identified as LDAP over port 389 to NewYork (10.0.0.4).",
    "An MSSP detection for \"Remote System Discovery\" was received that included PowerShell commands run by the adversary and an explanation of those commands."
  ],
  "Footnotes": [
    "The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual)."
  ],
  "Participant_Name": "symantec",
  "Procedure": "Enumerated remote systems using LDAP queries",
  "ScreenshotDatasources": [],
  "Step": "8. Expand Access",
  "Substep": "8.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1018",
  "Technique_Name": "Remote System Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Network connection to Scranton (10.0.1.4) over port 5985",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed a connection to Scranton (10.0.1.4) over port 5985 via HTTP."
  ],
  "Footnotes": [
    "The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual)."
  ],
  "Participant_Name": "symantec",
  "Procedure": "Established WinRM connection to remote host Scranton (10.0.1.4)",
  "ScreenshotDatasources": [],
  "Step": "8. Expand Access",
  "Substep": "8.A.2",
  "Subtechnique": "T1021.006",
  "Subtechnique_Name": "Remote Services: Windows Remote Management",
  "TacticGroup": "Lateral Movement",
  "Technique": "T1021",
  "Technique_Name": "Remote Services"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Get-Process",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection for \"Process Discovery\" was received that included PowerShell commands run by the adversary and explained that they were used to enumerate running processes on remote host Scranton (10.0.1.4)."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Enumerated processes on remote host Scranton (10.0.1.4) using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "8. Expand Access",
  "Substep": "8.A.3",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "Technique_Name": "Process Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "The file python.exe created on Scranton (10.0.1.4)",
  "Datasources": [],
  "Detection": [
    "General",
    "Technique"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Processing)"
  ],
  "DetectionText": [
    "A General alert detection for \"Malicious file detected python.exe\" was generated on sandbox detection evaluation of python.exe. Detection incurred a delay based on sandbox detonation processing.",
    "A Technique detection for \"Remote File Copy\" was generated data being sent over SMB2 to Scranton (10.0.1.4) creating a .exe file."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Copied python.exe payload from a WebDAV share (192.168.0.4) to remote host Scranton (10.0.1.4)",
  "ScreenshotDatasources": [],
  "Step": "8. Expand Access",
  "Substep": "8.B.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Evidence that the file python.exe is packed",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [
    "Delayed (Processing)"
  ],
  "DetectionText": [
    "Telemetry from automated file analysis showed python.exe was UPX packed. Detection incurred a delay based on additional data processing of python.exe to determine it was UPX packed.",
    "A Technique detection for \"Software Packing\" was generated when python.exe was executed by PSExec."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "python.exe payload was packed with UPX",
  "ScreenshotDatasources": [],
  "Step": "8. Expand Access",
  "Substep": "8.B.2",
  "Subtechnique": "T1027.002",
  "Subtechnique_Name": "Obfuscated Files or Information: Software Packing",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1027",
  "Technique_Name": "Obfuscated Files or Information"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Successful logon as user Pam on Scranton (10.0.1.4)",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed PsExec64.exe executing python.exe with pam's login credentials on Scranton. A Kerberos ticket was generated on Scranton for pam.",
    "An MSSP detection occurred containing evidence of a valid logon on Scranton (10.0.1.4) as user Pam."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Logged on to remote host Scranton (10.0.1.4) using valid credentials for user Pam",
  "ScreenshotDatasources": [],
  "Step": "8. Expand Access",
  "Substep": "8.C.1",
  "Subtechnique": "T1078.002",
  "Subtechnique_Name": "Valid Accounts: Domain Accounts",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1078",
  "Technique_Name": "Valid Accounts"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "SMB session to Scranton (10.0.1.4) over TCP port 445/135 OR evidence of usage of a Windows share",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 445."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Established SMB session to remote host Scranton's (10.0.1.4) IPC$ share using PsExec",
  "ScreenshotDatasources": [],
  "Step": "8. Expand Access",
  "Substep": "8.C.2",
  "Subtechnique": "T1021.002",
  "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares",
  "TacticGroup": "Lateral Movement",
  "Technique": "T1021",
  "Technique_Name": "Remote Services"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "python.exe spawned by PSEXESVC.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed PSEXECSVC.exe executing python.exe.",
    "A Technique alert detection for \"PsExec interacted with services - SONAR.PsExeSvc!gen1\" was generated on PsExecSvc targeting python.exe.",
    "An MSSP detection for \"Service Execution\" occurred containing evidence of PSEXECSVC.exe executing python.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Executed python.exe using PSExec",
  "ScreenshotDatasources": [],
  "Step": "8. Expand Access",
  "Substep": "8.C.3",
  "Subtechnique": "T1569.002",
  "Subtechnique_Name": "System Services: Service Execution",
  "TacticGroup": "Execution",
  "Technique": "T1569",
  "Technique_Name": "System Services"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "python.exe creating the file rar.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "Telemetry showed python.exe creating rar.exe.",
    "A Technique alert detection for \"Remote File Copy - Suspicious N-Gram\" was generated when python.exe connected to 192.168.0.4 port 8443 and then immediately created rar.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Dropped rar.exe to disk on remote host Scranton (10.0.1.4)",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "python.exe creating the file sdelete64.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "General"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "Telemetry showed Created File event for python.exe connecting to 192.168.0.4 port 8443 and then immediately creating sdelete64.exe.",
    "A General alert detection for \"Suspicious N-Gram\" was generated when python.exe connected to 192.168.0.4 port 8443 and then immediately created sdelete64.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Dropped sdelete.exe to disk on remote host Scranton (10.0.1.4)",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.A.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe spawning from python.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed python.exe executing powershell.exe. The telemetry was correlated to a parent detection python.exe as a suspicious file.",
    "A Technique detection for PowerShell was generated when python.exe spawned powershell.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Spawned interactive powershell.exe",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.B.1",
  "Subtechnique": "T1059.001",
  "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing (Get-)ChildItem",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing ChildItem.",
    "An MSSP detection for \"Collection\" was received that included ChildItem command execution searching for document and media files."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Searched filesystem for document and media files using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.B.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "Technique_Name": "File and Directory Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing (Get-)ChildItem",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing ChildItem.",
    "An MSSP detection for \"Collection\" was received that included ChildItem command execution searching for document and media files."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Scripted search of filesystem for document and media files using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.B.3",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Collection",
  "Technique": "T1119",
  "Technique_Name": "Automated Collection"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe reading files in C:\\Users\\Pam\\",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.B.4",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Collection",
  "Technique": "T1005",
  "Technique_Name": "Data from Local System"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe creating the file working.zip",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed a Created File event for powershell.exe creating working.zip. The event was correlated to a parent General detection for a suspicious PowerShell process."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Staged files for exfiltration into ZIP (working.zip in AppData directory) using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.B.5",
  "Subtechnique": "T1074.001",
  "Subtechnique_Name": "Data Staged: Local Data Staging",
  "TacticGroup": "Collection",
  "Technique": "T1074",
  "Technique_Name": "Data Staged"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing rar.exe with the -a parameter for a password to use for encryption",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Tactic",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing rar.exe with command-line arguments.",
    "A Tactic detection for \"Exfiltration\" was generated when rar.exe executed with command-line arguments creating working.zip.",
    "A MSSP detection for \"Data Encrypted\" was received included the command used by the adversary to execute Rar.exe and explained that it was used to compress data into an encrypted ZIP file."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Encrypted staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.B.6",
  "Subtechnique": "T1560.001",
  "Subtechnique_Name": "Archive Collected Data: Archive via Utility",
  "TacticGroup": "Collection",
  "Technique": "T1560",
  "Technique_Name": "Archive Collected Data"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing rar.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing rar.exe with command-line arguments.",
    "A Technique detection for Data Compressed was generated when rar.exe created working.zip.",
    "A MSSP detection for \"Data Staged\" was received included the command used by the adversary to execute Rar.exe and explained that it was used to compress compress data into working.zip."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Compressed staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.B.7",
  "Subtechnique": "T1560.001",
  "Subtechnique_Name": "Archive Collected Data: Archive via Utility",
  "TacticGroup": "Collection",
  "Technique": "T1560",
  "Technique_Name": "Archive Collected Data"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "python.exe reading the file working.zip while connected to the C2 channel",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Read and downloaded ZIP (working.zip on Desktop) over C2 channel (192.168.0.5 over TCP port 8443)",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.B.8",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1041",
  "Technique_Name": "Exfiltration Over Command and Control Channel"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "sdelete64.exe deleting the file rar.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Tactic"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed sdelete64.exe executing with command-line arguments to delete Rar.exe.",
    "A Tactic detection called \"Defense Evasion\" was generated when sdelete64.exe with command-line arguments was used to delete Rar.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Deleted rar.exe on disk using SDelete",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.C.1",
  "Subtechnique": "T1070.004",
  "Subtechnique_Name": "Indicator Removal on Host: File Deletion",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1070",
  "Technique_Name": "Indicator Removal on Host"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "sdelete64.exe deleting the file \\Desktop\\working.zip",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Tactic"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed sdelete64.exe executing with command-line arguments to delete Desktop\\working.zip.",
    "A Tactic detection called \"Defense Evasion\" was generated when sdelete64.exe with command-line arguments was used to delete Desktop\\working.zip."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Deleted working.zip (from Desktop) on disk using SDelete",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.C.2",
  "Subtechnique": "T1070.004",
  "Subtechnique_Name": "Indicator Removal on Host: File Deletion",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1070",
  "Technique_Name": "Indicator Removal on Host"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "sdelete64.exe deleting the file \\AppData\\Roaming\\working.zip",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Tactic"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed sdelete64.exe executing with command-line arguments to delete Roaming\\working.zip.",
    "A Tactic detection called \"Defense Evasion\" was generated when sdelete64.exe with command-line arguments was used to delete Roaming\\working.zip."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Deleted working.zip (from AppData directory) on disk using SDelete",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.C.3",
  "Subtechnique": "T1070.004",
  "Subtechnique_Name": "Indicator Removal on Host: File Deletion",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1070",
  "Technique_Name": "Indicator Removal on Host"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "cmd.exe deleting the file sdelete64.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed cmd.exe deleting sdelete64.exe. Processing was triggered by human action and not initiated automatically."
  ],
  "Footnotes": [
    "The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual)."
  ],
  "Participant_Name": "symantec",
  "Procedure": "Deleted SDelete on disk using cmd.exe del command",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.C.4",
  "Subtechnique": "T1070.004",
  "Subtechnique_Name": "Indicator Removal on Host: File Deletion",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1070",
  "Technique_Name": "Indicator Removal on Host"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "javamtsup.exe spawning from services.exe",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Executed persistent service (javamtsup) on system startup",
  "ScreenshotDatasources": [],
  "Step": "10. Persistence Execution",
  "Substep": "10.A.1",
  "Subtechnique": "T1569.002",
  "Subtechnique_Name": "System Services: Service Execution",
  "TacticGroup": "Execution",
  "Technique": "T1569",
  "Technique_Name": "System Services"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Evidence that the file hostui.lnk (which executes hostui.bat as a byproduct) was executed from the Startup Folder",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Executed LNK payload (hostui.lnk) in Startup Folder on user login",
  "ScreenshotDatasources": [],
  "Step": "10. Persistence Execution",
  "Substep": "10.B.1",
  "Subtechnique": "T1547.001",
  "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder",
  "TacticGroup": "Persistence",
  "Technique": "T1547",
  "Technique_Name": "Boot or Logon Autostart Execution"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "hostui.exe executing the CreateProcessWithToken API",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Executed PowerShell payload via the CreateProcessWithToken API",
  "ScreenshotDatasources": [],
  "Step": "10. Persistence Execution",
  "Substep": "10.B.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Execution",
  "Technique": "T1106",
  "Technique_Name": "Native API"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "hostui.exe manipulating the token of powershell.exe via the CreateProcessWithToken API OR powershell.exe executing with the stolen token of explorer.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry shows powershell.exe's security_descriptor obtaining the same value as explorer.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Manipulated the token of the PowerShell payload via the CreateProcessWithToken API",
  "ScreenshotDatasources": [],
  "Step": "10. Persistence Execution",
  "Substep": "10.B.3",
  "Subtechnique": "T1134.002",
  "Subtechnique_Name": "Access Token Manipulation: Create Process with Token",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1134",
  "Technique_Name": "Access Token Manipulation"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe spawning from explorer.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Tactic"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed explorer.exe executing powershell.exe.",
    "A Tactic detection called \"Execution\" was generated when explorer.exe executed powershell.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "User Oscar executed payload 37486-the-shocking-truth-about-election-rigging-in-america.rtf.lnk",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.1",
  "Subtechnique": "T1204.002",
  "Subtechnique_Name": "User Execution: Malicious File",
  "TacticGroup": "Execution",
  "Technique": "T1204",
  "Technique_Name": "User Execution"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing the schemas ADS via Get-Content and IEX",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.",
    "An MSSP detection for \"NTFS File Attributes\"  was received that included the PowerShell command used by the adversary and explained that it was used to retrieve the PowerShell script from the schemas Alternate Data Stream and execute it."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Executed an alternate data stream (ADS) using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.2",
  "Subtechnique": "T1564.004",
  "Subtechnique_Name": "Hide Artifacts: NTFS File Attributes",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1564",
  "Technique_Name": "Hide Artifacts"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_BIOS",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection for \"Virtualization/Sandbox Evasion\" was received that included a PowerShell command executed by the adversary and explained that it was used to query BIOS information."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Checked that the BIOS version and serial number are not associated with VirtualBox or VMware using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.3",
  "Subtechnique": "T1497.001",
  "Subtechnique_Name": "Virtualization/Sandbox Evasion: System Checks",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1497",
  "Technique_Name": "Virtualization/Sandbox Evasion"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing a Get-WmiObject gwmi queries for Win32_BIOS and Win32_ComputerSystem",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection for \"System Information Discovery\" was received that included a PowerShell command executed by the adversary and explained that it was used to collect information about the local system."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Enumerated computer manufacturer, model, and version information using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.4",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1082",
  "Technique_Name": "System Information Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_PnPEntity",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection for \"Peripheral Device Discovery\" was received that included a PowerShell command executed by the adversary and explained that it was used to enumerate Plug and Play devices."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Enumerated devices/adapters to check for presence of VirtualBox driver(s) using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.5",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1120",
  "Technique_Name": "Peripheral Device Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection for \"System Owner/User Discovery\" was received that included a PowerShell command executed by the adversary and explained that it was used to query the system owner."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Checked that the username is not related to admin or a generic value (ex: user) using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.6",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1033",
  "Technique_Name": "System Owner/User Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection for \"System Network Configuration Discovery\" was received that included a PowerShell command executed by the adversary and explained that it was used to query the system's network configuration."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Checked that the computer is joined to a domain using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.7",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1016",
  "Technique_Name": "System Network Configuration Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_Process",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection for \"Process Discovery\" was received that included a PowerShell command executed by the adversary and explained that it was used to enumerate running processes on the local system."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Checked that processes such as procexp.exe, taskmgr.exe, or wireshark.exe are not running using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.8",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "Technique_Name": "Process Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing (Get-Item -Path \".\\\" -Verbose).FullName",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection for \"File and Directory Discovery\" was received that included a PowerShell command executed by the adversary and explained that it was used to perform discovery of the file and directory list from the local filesystem."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Checked that the payload is not inside a folder path that contains \"sample\" or is the length of a hash value using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.9",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "Technique_Name": "File and Directory Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "certutil.exe decoding kxwn.lock",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.",
    "A Technique alert detection (red indicator) for \"Deobfuscate/Decode Files or Information\" was generated when certutil decoded data and created an executable file.",
    "An MSSP detection for \"Deobfuscate/Decode Files or Information\" was received that included details on execution of certutil.exe by the adversary and explained that it was used to decode a fake certificate file into a DLL."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Decoded an embedded DLL payload to disk using certutil.exe",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.10",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Defense Evasion",
  "Technique": "T1140",
  "Technique_Name": "Deobfuscate/Decode Files or Information"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Addition of the Webcache subkey in HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe adding Run key persistence into the Registry.",
    "A Technique detection for \"Registry Run Keys / Startup Folder\" was generated for powershell.exe adding Run key persistence into the Registry.",
    "An MSSP detection for \"Registry Run Keys / Startup Folder\" was received that included a PowerShell command executed by the adversary and explained that it was used to set a Registry Run Key. A detailed analysis of the malicious payload was also provided. [SE: see comment]"
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Established Registry Run key persistence using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.11",
  "Subtechnique": "T1547.001",
  "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder",
  "TacticGroup": "Persistence",
  "Technique": "T1547",
  "Technique_Name": "Boot or Logon Autostart Execution"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe spawning from from the schemas ADS (powershell.exe)",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe spawned from a PowerShell stager.",
    "A Technique alert detection (medium severity) for \"Powershell\" was generated for powershell.exe spawned from a PowerShell stager.",
    "An MSSP detection for \"PowerShell\" was received that included a PowerShell command executed by the adversary and explained that it was used to download and execute a PoshC2 stager located on a remote server."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Executed PowerShell stager payload",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.12",
  "Subtechnique": "T1059.001",
  "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Established network channel over port 443",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.",
    "An MSSP detection for \"Commonly Used Port\" was received that included a description of PowerShell script downloaded and executed by the adversary and explained that it was used to establish a connection to 192.168.0.4 over port 443. A detailed analysis of the script was also provided."
  ],
  "Footnotes": [
    "The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual)."
  ],
  "Participant_Name": "symantec",
  "Procedure": "Established C2 channel (192.168.0.4) via PowerShell payload over port 443",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.13",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1043",
  "Technique_Name": "Commonly Used Port"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Established network channel over the HTTPS protocol",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe connecting and sending data to 192.168.0.4 via TLS.",
    "A MSSP detection for \"Standard Application Layer Protocol\" was received that included a description of PowerShell script downloaded and executed by the adversary and explained that it was used to establish a connection to 192.168.0.4 using HTTPS. A detailed analysis of the script was also provided."
  ],
  "Footnotes": [
    "The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual)."
  ],
  "Participant_Name": "symantec",
  "Procedure": "Used HTTPS to transport C2 (192.168.0.4) traffic",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.14",
  "Subtechnique": "T1071.001",
  "Subtechnique_Name": "Application Layer Protocol: Web Protocols",
  "TacticGroup": "Command and Control",
  "Technique": "T1071",
  "Technique_Name": "Application Layer Protocol"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Evidence that the network data sent over the C2 channel is encrypted",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe connecting and sending data to 192.168.0.4 via TLS.",
    "An MSSP detection for \"Standard Application Layer Protocol\" was received that included a description of PowerShell script downloaded and executed by the adversary and explained that it was used to establish a connection to 192.168.0.4 using HTTPS. A detailed analysis of the script was also provided."
  ],
  "Footnotes": [
    "The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual)."
  ],
  "Participant_Name": "symantec",
  "Procedure": "Used HTTPS to encrypt C2 (192.168.0.4) traffic",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.15",
  "Subtechnique": "T1573.002",
  "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography",
  "TacticGroup": "Command and Control",
  "Technique": "T1573",
  "Technique_Name": "Encrypted Channel"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing (gci ((gci env:windir).Value + '\\system32')",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection for \"File and Directory Discovery\" was received that noted a PowerShell command was used to find a random file in the System32 folder."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Enumerated the System32 directory using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "12. Fortify Access",
  "Substep": "12.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "Technique_Name": "File and Directory Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe modifying the creation, last access, and last write times of kxwn.lock",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe setting the file attributes of kxwn.lock.",
    "An MSSP detection for \"Timestomp\" occurred containing evidence of timestamp modifications of kxwn.lock."
  ],
  "Footnotes": [
    "The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual)."
  ],
  "Participant_Name": "symantec",
  "Procedure": "Modified the time attributes of the kxwn.lock persistence payload using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "12. Fortify Access",
  "Substep": "12.A.2",
  "Subtechnique": "T1070.006",
  "Subtechnique_Name": "Indicator Removal on Host: Timestomp",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1070",
  "Technique_Name": "Indicator Removal on Host"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing a Get-WmiObject query for AntiVirusProduct",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection for \"Security Software Discovery\" was occurred containing evidence WMI was used to enumerate installed AntiVirus products."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Enumerated registered AV products using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "12. Fortify Access",
  "Substep": "12.B.1",
  "Subtechnique": "T1518.001",
  "Subtechnique_Name": "Software Discovery: Security Software Discovery",
  "TacticGroup": "Discovery",
  "Technique": "T1518",
  "Technique_Name": "Software Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection for \"Query Registry\" occurred that containing registry query for installed software."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Enumerated installed software via the Registry (Wow6432 Uninstall key) using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "12. Fortify Access",
  "Substep": "12.C.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1012",
  "Technique_Name": "Query Registry"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection for \"Query Registry\" occurred that containing registry query for installed software."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Enumerated installed software via the Registry (Uninstall key) using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "12. Fortify Access",
  "Substep": "12.C.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1012",
  "Technique_Name": "Query Registry"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing the GetComputerNameEx API",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection for \"System Information Discovery\" occurred containg evidence of PowerShell calling the GetComputerNameEx API."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Enumerated the computer name using the GetComputerNameEx API",
  "ScreenshotDatasources": [],
  "Step": "13. Reconnaissance",
  "Substep": "13.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1082",
  "Technique_Name": "System Information Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing the NetWkstaGetInfo API",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection for \"System Network Configuration Discovery\" occurred containing evidence of PowerShell calling the NetWkstaGetInfo API."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Enumerated the domain name using the NetWkstaGetInfo API",
  "ScreenshotDatasources": [],
  "Step": "13. Reconnaissance",
  "Substep": "13.B.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1016",
  "Technique_Name": "System Network Configuration Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing the GetUserNameEx API",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection for \"System Owner/User Discovery\" was received that included a PowerShell command executed by the adversary and explained that it was used to obtain the username."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Enumerated the current username using the GetUserNameEx API",
  "ScreenshotDatasources": [],
  "Step": "13. Reconnaissance",
  "Substep": "13.C.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1033",
  "Technique_Name": "System Owner/User Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing the CreateToolhelp32Snapshot API",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection for \"Process Discovery\" occurred containing evidence of an executed PowerShell command used to enumerate running processes on the local machine."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Enumerated running processes using the CreateToolhelp32Snapshot API",
  "ScreenshotDatasources": [],
  "Step": "13. Reconnaissance",
  "Substep": "13.D.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "Technique_Name": "Process Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Addition of the DelegateExecute subkey in HKCU\\Software\\Classes\\Folder\\shell\\open\\command",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed the addition of the DelegateExecute Registry value."
  ],
  "Footnotes": [
    "The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual)."
  ],
  "Participant_Name": "symantec",
  "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "14. Elevation & Credential Access",
  "Substep": "14.A.1",
  "Subtechnique": "T1546.015",
  "Subtechnique_Name": "Event Triggered Execution: Component Object Model Hijacking",
  "TacticGroup": "Privilege Escalation",
  "Technique": "T1546",
  "Technique_Name": "Event Triggered Execution"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "High integrity powrshell.exe spawning from control.exe (spawned from sdclt.exe)",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed a new High Integrity PowerShell callback spawned from control.exe (spawned from sdclt.exe).",
    "A Technique alert detection for \"UAC Bypass\" was generated when the setting of registry values associated with COM Hijacking was followed by execution of a program known to be associated with UAC bypasses. The event was correlated to a parent Tactic detection called \"Execution\" that was generated when explorer.exe executed powershell.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Executed elevated PowerShell payload",
  "ScreenshotDatasources": [],
  "Step": "14. Elevation & Credential Access",
  "Substep": "14.A.2",
  "Subtechnique": "T1548.002",
  "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control",
  "TacticGroup": "Privilege Escalation",
  "Technique": "T1548",
  "Technique_Name": "Abuse Elevation Control Mechanism"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Deletion of the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command subkey",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed the deletion of the Registry value.",
    "An MSSP detection for \"Modify Registry\" was received that included a PowerShell command executed by the adversary and explained that it was used to delete the Registry Key."
  ],
  "Footnotes": [
    "The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual)."
  ],
  "Participant_Name": "symantec",
  "Procedure": "Modified the Registry to remove artifacts of COM hijacking using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "14. Elevation & Credential Access",
  "Substep": "14.A.3",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Defense Evasion",
  "Technique": "T1112",
  "Technique_Name": "Modify Registry"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "WMI Process (WmiPrvSE.exe) executing powershell.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Tactic",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed WmiPrvSE.exe executing powershell.exe.",
    "A Tactic detection called \"Execution\" was generated when wmiprvse.exe launched powershell.exe.",
    "An MSSP detection for \"WMI\" was received that included a PowerShell command executed by the adversary and explained that it was used to execute PowerShel through WMI that downloads and executes mimikatz."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Created and executed a WMI class using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "14. Elevation & Credential Access",
  "Substep": "14.B.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Execution",
  "Technique": "T1047",
  "Technique_Name": "Windows Management Instrumentation"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Get-Process",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Enumerated and tracked PowerShell processes using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "14. Elevation & Credential Access",
  "Substep": "14.B.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "Technique_Name": "Process Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe downloading and/or the file write of m.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed the file create event for m.exe into the System32 folder.",
    "A Technique detection for \"Remote File Copy\" was generated when powershell.exe generated network traffic immediately followed by creation of an executable file. The event was correlated to a previous event showing wmiprvse.exe executing powershell.exe.",
    "An MSSP detection for \"Remote File Copy\" was received that included a PowerShell command executed by the adversary and explained that it was used to download m.exe from a remote server."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Downloaded and dropped Mimikatz (m.exe) to disk",
  "ScreenshotDatasources": [],
  "Step": "14. Elevation & Credential Access",
  "Substep": "14.B.3",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "m.exe injecting into lsass.exe to dump credentials",
  "Datasources": [],
  "Detection": [
    "Technique",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Alert",
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection for \"Credential Dumping\" was generated when m.exe read Lsass memory. The detection was correlated to a parent alert for wmiprvse.exe executing powershell.exe.",
    "A Technique alert detection for \"Credential Dumping\" was generated when powershell.exe loaded cryptography DLLs and attempted to inject into lsass.exe, and again when powershell.exe successfully injected into lsass.exe. The detection was correlated to a parent alert for wmiprvse.exe executing powershell.exe.",
    "An MSSP detection for \"Credential Dumping\" was received that included a PowerShell command executed by the adversary to download Mimikatz and execute it with a sequence of commands."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Dumped plaintext credentials using Mimikatz (m.exe)",
  "ScreenshotDatasources": [],
  "Step": "14. Elevation & Credential Access",
  "Substep": "14.B.4",
  "Subtechnique": "T1003.001",
  "Subtechnique_Name": "OS Credential Dumping: LSASS Memory",
  "TacticGroup": "Credential Access",
  "Technique": "T1003",
  "Technique_Name": "OS Credential Dumping"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Set-WmiInstance",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed PowerShell executing Set-WmiInstance to write encoded content to Win32_AuditCode."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Encoded and wrote Mimikatz output to a WMI class property using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "14. Elevation & Credential Access",
  "Substep": "14.B.5",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Defense Evasion",
  "Technique": "T1027",
  "Technique_Name": "Obfuscated Files or Information"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Get-WmiInstance",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Read and decoded Mimikatz output from a WMI class property using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "14. Elevation & Credential Access",
  "Substep": "14.B.6",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Defense Evasion",
  "Technique": "T1140",
  "Technique_Name": "Deobfuscate/Decode Files or Information"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing $env:UserName",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Enumerated logged on users using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "15. Establish Persistence",
  "Substep": "15.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1033",
  "Technique_Name": "System Owner/User Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe creating the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription",
  "Datasources": [],
  "Detection": [
    "General",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A General alert detection called \"SEP detected: CLDownloader!gen1\" was generated on subscription:CommandLineEventConsumer.Name=WindowsParentalControlMigration.",
    "A Technique detection called \"WMI Event Subscriptionmodule WindowsParentalControlMigration contains suspicious argument\" was generated on WMIProcessCreationEvent and WMIConsumerEvent being created in root/subscription.",
    "An MSSP detection for \"WMI Event Subscription\" was received that included a PowerShell command executed by the adversary and explained that it was used to establish persistence through a WMI Event Subscription that executes upon user logon."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Established WMI event subscription persistence using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "15. Establish Persistence",
  "Substep": "15.A.2",
  "Subtechnique": "T1546.003",
  "Subtechnique_Name": "Event Triggered Execution: Windows Management Instrumentation Event Subscription",
  "TacticGroup": "Persistence",
  "Technique": "T1546",
  "Technique_Name": "Event Triggered Execution"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe making LDAP queries over port 389 via functions from System.DirectoryServices.dll",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell making a network connection to the domain controller NewYork (10.0.0.4) over LDAP port 389. Additionally, Oscar's Kerberos ticket was seen in memory on NewYork."
  ],
  "Footnotes": [
    "The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual)."
  ],
  "Participant_Name": "symantec",
  "Procedure": "Enumerated the domain controller host NewYork (10.0.0.4) using LDAP queries",
  "ScreenshotDatasources": [],
  "Step": "16. Expand Access",
  "Substep": "16.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1018",
  "Technique_Name": "Remote System Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing the ConvertSidToStringSid API",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Enumerated the domain SID (from current user SID) using the ConvertSidToStringSid API",
  "ScreenshotDatasources": [],
  "Step": "16. Expand Access",
  "Substep": "16.B.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1033",
  "Technique_Name": "System Owner/User Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing the ConvertSidToStringSid API function by loading Advapi32.dll",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection for \"Execution through API\" was received that included a PowerShell command executed by the adversary and explained that it was used to execute the GetTokenInformation API call from Advapi32.dll."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Executed the ConvertSidToStringSid API call by reflectively loading Advapi32.dll",
  "ScreenshotDatasources": [],
  "Step": "16. Expand Access",
  "Substep": "16.B.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Execution",
  "Technique": "T1106",
  "Technique_Name": "Native API"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Network connection to NewYork (10.0.0.4) over port 5985",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985.",
    "An MSSP detection occurred containing evidence of WinRM usage via invoke-winrmsession with command-line arguments."
  ],
  "Footnotes": [
    "The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual)."
  ],
  "Participant_Name": "symantec",
  "Procedure": "Established a WinRM connection to the domain controller host NewYork (10.0.0.4)",
  "ScreenshotDatasources": [],
  "Step": "16. Expand Access",
  "Substep": "16.C.1",
  "Subtechnique": "T1021.006",
  "Subtechnique_Name": "Remote Services: Windows Remote Management",
  "TacticGroup": "Lateral Movement",
  "Technique": "T1021",
  "Technique_Name": "Remote Services"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Successful logon as user MScott on NewYork (10.0.0.4)",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed wsmprovhost.exe successfully executing a program as user MScott, indicating that a valid user session was created through WinRM."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Logged on to the domain controller host NewYork (10.0.0.4) using valid credentials for user MScott",
  "ScreenshotDatasources": [],
  "Step": "16. Expand Access",
  "Substep": "16.C.2",
  "Subtechnique": "T1078.002",
  "Subtechnique_Name": "Valid Accounts: Domain Accounts",
  "TacticGroup": "Initial Access",
  "Technique": "T1078",
  "Technique_Name": "Valid Accounts"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "File write of m.exe by the WinRM process (wsmprovhost.exe)",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "General",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Processing)",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed a file create event for m.exe in the System32 directory by \"Host process for WinRM plug-ins\".",
    "A General alert detection called \"Malicious file detected\" was generated on sandbox detection analysis of m.exe. Detection incurred a delay based on sandbox detonation processing.",
    "A Technique detection for \"Remote File Copy\" was generated when SMB traffic from another host was received and then immediately followed by a file write for m.exe by wsmprovhost.exe.",
    "An MSSP detection for \"Remote File Copy\" was received that included a PowerShell command executed by the adversary and explained that it was used to copy mimikatz to a remote PowerShell session."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Dropped Mimikatz (m.exe) to disk on the domain controller host NewYork (10.0.0.4) over a WinRM connection",
  "ScreenshotDatasources": [],
  "Step": "16. Expand Access",
  "Substep": "16.D.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Lateral Movement",
  "Technique": "T1570",
  "Technique_Name": "Lateral Tool Transfer"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "m.exe injecting into lsass.exe to dump credentials",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "General",
    "General",
    "Technique",
    "Technique",
    "Technique",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Alert",
    "Alert",
    "Alert",
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed m.exe injecting into lsass.exe",
    "A General detection was generated for a \"Suspected Mimikatz credential theft activity\". The event was correlated to a parent General detection on m.exe.",
    "A General alert detection for \"Process Injection\" was generated on \"Untrusted process attempted to open a thread in a Microsoft process\".",
    "A Technique alert detection for \"Credential Dumping\" was generated when a suspicious process opened LSASS and wrote to a file.",
    "A Technique alert detection for \"Credential Dumping\" was generated for a suspicious injection into LSASS.",
    "A Technique detection for \"Credential Dumping\" was generated when m.exe injected into lsass.exe.",
    "A Technique alert detection for \"Credential Dumping\" was generated when a suspicious process loaded a cryptographic DLL and accessed LSASS memory.",
    "An MSSP detection for \"Credential Dumping\" was received that included a PowerShell command executed by the adversary and explained that it was used to execute mimikatz to retrieve the krbtgt hash from host NewYork (10.0.0.4)."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Dumped the KRBTGT hash on the domain controller host NewYork (10.0.0.4) using Mimikatz (m.exe)",
  "ScreenshotDatasources": [],
  "Step": "16. Expand Access",
  "Substep": "16.D.2",
  "Subtechnique": "T1003.001",
  "Subtechnique_Name": "OS Credential Dumping: LSASS Memory",
  "TacticGroup": "Credential Access",
  "Technique": "T1003",
  "Technique_Name": "OS Credential Dumping"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "outlook.exe spawning from svchost.exe or powershell.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails.",
    "An MSSP detection for \"Email Collection\" was generated containing evidence of email collection."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Dumped messages from the local Outlook inbox using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "17. Collection",
  "Substep": "17.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Collection",
  "Technique": "T1114",
  "Technique_Name": "Email Collection"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe reading the file MITRE-ATTACK-EVALS.HTML",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Read and collected a local file using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "17. Collection",
  "Substep": "17.B.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Collection",
  "Technique": "T1005",
  "Technique_Name": "Data from Local System"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe creating the file \\WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Staged collected file into directory using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "17. Collection",
  "Substep": "17.B.2",
  "Subtechnique": "T1074.001",
  "Subtechnique_Name": "Data Staged: Local Data Staging",
  "TacticGroup": "Collection",
  "Technique": "T1074",
  "Technique_Name": "Data Staged"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing the ZipFile.CreateFromDirectory .NET method",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of commands used to copy and compress data."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Compressed a staging directory using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "17. Collection",
  "Substep": "17.C.1",
  "Subtechnique": "T1560.001",
  "Subtechnique_Name": "Archive Collected Data: Archive via Utility",
  "TacticGroup": "Collection",
  "Technique": "T1560",
  "Technique_Name": "Archive Collected Data"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Set-Content",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Prepended the GIF file header to a compressed staging file using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "17. Collection",
  "Substep": "17.C.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Defense Evasion",
  "Technique": "T1027",
  "Technique_Name": "Obfuscated Files or Information"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "net.exe with command-line arguments then making a network connection to a public IP over port 443",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443.",
    "An MSSP detection for \"Web Service\" was received that included a PowerShell command executed by the adversary and explained that it was used to exfiltrate locally staged data to a remote WebDav share."
  ],
  "Footnotes": [
    "The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual)."
  ],
  "Participant_Name": "symantec",
  "Procedure": "Mapped a network drive to an online OneDrive account using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "18. Exfiltration",
  "Substep": "18.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1102",
  "Technique_Name": "Web Service"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Copy-Item pointing to drive mapped to an attack-controlled OneDrive account",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection for \"Exfiltration Over Alternative Protocol\" was received that included a PowerShell command executed by the adversary and explained that it was used to copy a file to a drive mapped to a WebDav share."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Exfiltrated staged collection to an online OneDrive account using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "18. Exfiltration",
  "Substep": "18.A.2",
  "Subtechnique": "T1567.002",
  "Subtechnique_Name": "Exfiltration Over Web Service: Exfiltration to Cloud Storage",
  "TacticGroup": "Exfiltration",
  "Technique": "T1567",
  "Technique_Name": "Exfiltration Over Web Service"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "rundll32.exe executing kxwn.lock",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "Technique"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert"
  ],
  "DetectionText": [
    "Telemetry showed rundll32.exe executing kxwn.lock.",
    "A Technique alert detection called \"Rundll32\" was generated on \"malicious file kxwn.lock with heuristic signature SONAR.Module!gen3\".",
    "A Technique alert detection called \"SONAR - RunDLL32 loaded a suspicious DLL\" was generated due to rundll32.exe executing kxwn.lock."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Executed Run key persistence payload on user login using RunDll32",
  "ScreenshotDatasources": [],
  "Step": "20. Persistence Execution",
  "Substep": "20.A.1",
  "Subtechnique": "T1218.011",
  "Subtechnique_Name": "Signed Binary Proxy Execution: Rundll32",
  "TacticGroup": "Execution",
  "Technique": "T1218",
  "Technique_Name": "Signed Binary Proxy Execution"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "The WMI process (wmiprvse.exe) executing powershell.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed wmiprvse.exe executing PowerShell."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Executed WMI persistence on user login",
  "ScreenshotDatasources": [],
  "Step": "20. Persistence Execution",
  "Substep": "20.A.2",
  "Subtechnique": "T1546.003",
  "Subtechnique_Name": "Event Triggered Execution: Windows Management Instrumentation Event Subscription",
  "TacticGroup": "Persistence",
  "Technique": "T1546",
  "Technique_Name": "Event Triggered Execution"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "SYSTEM-level powershell.exe spawned from the powershell.exe",
  "Datasources": [],
  "Detection": [
    "General",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A General detection called \"powershell.exe contains suspicious argument\" was generated on a SYSTEM-level powershell.exe spawning from wmiprvse.exe.",
    "A Technique detection for \"PowerShell\" was generated due to wmiprvse.exe spawning powershell.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Executed PowerShell payload from WMI event subscription persistence",
  "ScreenshotDatasources": [],
  "Step": "20. Persistence Execution",
  "Substep": "20.A.3",
  "Subtechnique": "T1059.001",
  "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Invoke-Mimikatz with command-line arguments to create a golden ticket",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed WinRM activity as MScott from Scranton (10.0.1.4) to Utica (10.0.1.5) with a Kerberos ticket in memory for MScott on Scranton (10.0.1.4)."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Created Kerberos Golden Ticket using Invoke-Mimikatz",
  "ScreenshotDatasources": [],
  "Step": "20. Persistence Execution",
  "Substep": "20.B.1",
  "Subtechnique": "T1550.003",
  "Subtechnique_Name": "Use Alternate Authentication Material: Pass the Ticket",
  "TacticGroup": "Lateral Movement",
  "Technique": "T1550",
  "Technique_Name": "Use Alternate Authentication Material"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Network connection to Scranton (10.0.1.4) over port 5985",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Established a WinRM connection to the remote host Scranton (10.0.1.4) using the Golden Ticket as credentials",
  "ScreenshotDatasources": [],
  "Step": "20. Persistence Execution",
  "Substep": "20.B.2",
  "Subtechnique": "T1021.006",
  "Subtechnique_Name": "Remote Services: Windows Remote Management",
  "TacticGroup": "Lateral Movement",
  "Technique": "T1021",
  "Technique_Name": "Remote Services"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "net.exe adding the user Toby",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.",
    "A Technique detection for \"Create Account\" was generated for wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby."
  ],
  "Footnotes": [],
  "Participant_Name": "symantec",
  "Procedure": "Added a new user to the remote host Scranton (10.0.1.4) using net.exe",
  "ScreenshotDatasources": [],
  "Step": "20. Persistence Execution",
  "Substep": "20.B.3",
  "Subtechnique": "T1136.001",
  "Subtechnique_Name": "Create Account: Local Account",
  "TacticGroup": "Persistence",
  "Technique": "T1136",
  "Technique_Name": "Create Account"
}
