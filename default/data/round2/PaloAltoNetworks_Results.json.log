{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "MSSP",
    "Telemetry",
    "General"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Alert"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of the user Pam executing the malicious document rcs.3aka3.doc file.",
    "Telemetry showed explorer.exe executing rcs.3aka3.doc.",
    "A General alert detection (medium severity) was generated for rcs.3aka3.doc being tagged as malware."
  ],
  "Footnotes": [
    "According to the vendor, payload execution would have been prevented as Wildfire labeled the payload as malicious/malware."
  ],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "The rcs.3aka3.doc process spawning from explorer.exe",
  "ScreenshotDatasources": [],
  "Step": "1. Initial Compromise",
  "Substep": "1.A.1",
  "Subtechnique": "T1204.002",
  "Subtechnique_Name": "User Execution: Malicious File",
  "TacticGroup": "Execution",
  "Technique": "T1204",
  "Technique_Name": "User Execution"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "MSSP",
    "Technique"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Alert"
  ],
  "DetectionText": [
    "An MSSP detection for Masquerading \"(T1036)\" occurred containing evidence of of the RLO character to obfuscate payload file name.",
    "A Technique alert detection (low severity) was generated for rcs.3aka3.doc, identified as a screensaver process, executing from users or temporary folder."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "Evidence of the right-to-left override character (U+202E) in the rcs.3aka.doc process OR the original filename (cod.3aka.scr)",
  "ScreenshotDatasources": [],
  "Step": "1. Initial Compromise",
  "Substep": "1.A.2",
  "Subtechnique": "T1036.002",
  "Subtechnique_Name": "Masquerading: Right-to-Left Override",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1036",
  "Technique_Name": "Masquerading"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection for an Uncommonly used port \"(T1065)\" occurred containing evidence of rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.",
    "Telemetry showed the rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "Established network channel over port 1234",
  "ScreenshotDatasources": [],
  "Step": "1. Initial Compromise",
  "Substep": "1.A.3",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Command and Control",
  "Technique": "T1095",
  "Technique_Name": "Non-Application Layer Protocol"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "Evidence that the network data sent over the C2 channel is encrypted",
  "ScreenshotDatasources": [],
  "Step": "1. Initial Compromise",
  "Substep": "1.A.4",
  "Subtechnique": "T1573.001",
  "Subtechnique_Name": "Encrypted Channel: Symmetric Cryptography",
  "TacticGroup": "Command and Control",
  "Technique": "T1573",
  "Technique_Name": "Encrypted Channel"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Technique",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "A Technique alert detection was generated for a command line interface spawned from a process identified as malware with an active network connection.",
    "An MSSP detection for Command Line Interfaces \"(T1059)\" occurred containing evidence of cmd.exe spawning from rcs.3aka3.doc.",
    "Telemetry showed rcs.3aka3.doc spawning from cmd.exe. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "cmd.exe spawning from the rcs.3aka3.doc process",
  "ScreenshotDatasources": [],
  "Step": "1. Initial Compromise",
  "Substep": "1.B.1",
  "Subtechnique": "T1059.003",
  "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "An MSSP detection for Powershell \"(T1086)\" occurred containing evidence of powershell.exe spawning from cmd.exe.",
    "Telemetry showed powershell.exe spawning from cmd.exe. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe spawning from cmd.exe",
  "ScreenshotDatasources": [],
  "Step": "1. Initial Compromise",
  "Substep": "1.B.2",
  "Subtechnique": "T1059.001",
  "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Technique",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Alert",
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "A Technique alert detection was generated for PowerShell executing suspicious File and Directory Discovery commands. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.",
    "An MSSP detection for File and Directory Discovery \"(T1083)\" occurred containing evidence that a discovery script was using get-childitem to search the filesystem to specific file patterns.",
    "Telemetry showed powershell.exe executing Get-ChildItem. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing (Get-)ChildItem",
  "ScreenshotDatasources": [],
  "Step": "2. Collection and Exfiltration",
  "Substep": "2.A.1",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "Technique_Name": "File and Directory Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing Get-ChildItem. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.",
    "An MSSP detection for Automated Collection \"(T1119)\" occurred containing evidence that a discovery script was using Get-Childitem to search the filesystem to specific file patterns."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing (Get-)ChildItem",
  "ScreenshotDatasources": [],
  "Step": "2. Collection and Exfiltration",
  "Substep": "2.A.2",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Collection",
  "Technique": "T1119",
  "Technique_Name": "Automated Collection"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed file reads of C:\\Users\\Pam\\*. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.",
    "An MSSP detection for Data From Local System \"(T1005)\" occurred containing evidence that a discovery script was executed file read operations on local folder C:\\Users\\Pam."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe reading files in C:\\Users\\Pam\\",
  "ScreenshotDatasources": [],
  "Step": "2. Collection and Exfiltration",
  "Substep": "2.A.3",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Collection",
  "Technique": "T1005",
  "Technique_Name": "Data from Local System"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP",
    "Technique"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Delayed (Manual)",
    "Alert",
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe compressing via Compress-Archive. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.",
    "An MSSP detection for Data Compressed \"(T1002)\" occurred containing evidence that the files \"C:\\Users\\pam\\Links\\Downloads.lnk, C:\\Users\\pam\\Links\\Desktop.lnk, C:\\Users\\pam\\Favorites\\Bing.url, and C:\\Users\\pam\\Desktop\\Microsoft Edge.lnk\" were compressed into a zip file draft.zip.",
    "A Technique alert detection (red indicator) called \"Scripting engine creates compressed file under suspicious folder\" was generated due identifying Draft.zip as compressed. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing Compress-Archive",
  "ScreenshotDatasources": [],
  "Step": "2. Collection and Exfiltration",
  "Substep": "2.A.4",
  "Subtechnique": "T1560.001",
  "Subtechnique_Name": "Archive Collected Data: Archive via Utility",
  "TacticGroup": "Collection",
  "Technique": "T1560",
  "Technique_Name": "Archive Collected Data"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "An MSSP detection for Data Staged \"(T1074)\" occurred containing evidence that there was a compressed zip file created named Draft.zip.",
    "Telemetry showed the creation of Draft.Zip. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe creating the file draft.zip",
  "ScreenshotDatasources": [],
  "Step": "2. Collection and Exfiltration",
  "Substep": "2.A.5",
  "Subtechnique": "T1560.001",
  "Subtechnique_Name": "Archive Collected Data: Archive via Utility",
  "TacticGroup": "Collection",
  "Technique": "T1560",
  "Technique_Name": "Archive Collected Data"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed file read event for Draft.zip and an existing C2 channel (192.168.0.5 over port 1234). The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.",
    "An MSSP detection for Exfiltration Over Command and Control Channel \"(T1041)\" occurred containing evidence that \"After the zip file is created, it's read by cod.3aka3.scr... [and] the timeline view shows a C2 connection from nashua to 192.168.0.5, in which cod.3aka3.scr sent 319,936 Bytes.\""
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "The rcs.3aka3.doc process reading the file draft.zip while connected to the C2 channel",
  "ScreenshotDatasources": [],
  "Step": "2. Collection and Exfiltration",
  "Substep": "2.B.1",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Exfiltration",
  "Technique": "T1041",
  "Technique_Name": "Exfiltration Over Command and Control Channel"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed rcs.3aka3.doc creating monkey.png. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.",
    "An MSSP detection for Remote File Copy \"(T1105)\" occurred containing evidence that cod.3aka3.scr has downloaded and wrote a file named monkey.png to C:\\Users\\pam\\Downloads."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "The rcs.3aka3.doc process creating the file monkey.png",
  "ScreenshotDatasources": [],
  "Step": "3. Deploy Stealth Toolkit",
  "Substep": "3.A.1",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "An MSSP detection for \"Obfuscated Files or Information\" occurred containing evidence of the PowerShell script contained within monkey.png.",
    "Telemetry showed PowerShell extracting and executing the code embedded within monkey.png. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "Evidence that a PowerShell payload was within monkey.png",
  "ScreenshotDatasources": [],
  "Step": "3. Deploy Stealth Toolkit",
  "Substep": "3.A.2",
  "Subtechnique": "T1027.003",
  "Subtechnique_Name": "Obfuscated Files or Information: Steganography",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1027",
  "Technique_Name": "Obfuscated Files or Information"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "General",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Alert",
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "A General alert detection was generated identifying the Registry modification as a malware behavior threat. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.",
    "An MSSP detection occurred containing evidence of addition of DelegateExecute subkey.",
    "Telemetry showed the addition of the DelegateExecute Registry Value. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "Addition of the DelegateExecute subkey in HKCU\\Software\\Classes\\Folder\\shell\\open\\command",
  "ScreenshotDatasources": [],
  "Step": "3. Deploy Stealth Toolkit",
  "Substep": "3.B.1",
  "Subtechnique": "T1546.015",
  "Subtechnique_Name": "Event Triggered Execution: Component Object Model Hijacking",
  "TacticGroup": "Privilege Escalation",
  "Technique": "T1546",
  "Technique_Name": "Event Triggered Execution"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "MSSP",
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Alert"
  ],
  "DetectionText": [
    "An MSSP detection for \"UAC bypass (T1088)\" occurred for a new high hntegrity PowerShell callback spawning from control.exe.",
    "A Technique alert detection (red indicator) was generated for for \"Bypass User Account Control VIA registry hijack T1088\" for control.exe creating a high integrity powershell.exe.",
    "Telemetry showed control.exe creating a high integrity powershell.exe."
  ],
  "Footnotes": [
    "Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."
  ],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "High integrity powershell.exe spawning from control.exe (spawned from sdclt.exe)",
  "ScreenshotDatasources": [],
  "Step": "3. Deploy Stealth Toolkit",
  "Substep": "3.B.2",
  "Subtechnique": "T1548.002",
  "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control",
  "TacticGroup": "Privilege Escalation",
  "Technique": "T1548",
  "Technique_Name": "Abuse Elevation Control Mechanism"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe connecting to 192.168.0.5 on TCP port 443. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.",
    "An MSSP detection for Commonly Used Port was generated containing evidence monkey.png performed C&C over port 443 to IP address 192.168.0.5."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "Established network channel over port 443",
  "ScreenshotDatasources": [],
  "Step": "3. Deploy Stealth Toolkit",
  "Substep": "3.B.3",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Command and Control",
  "Technique": "T1043",
  "Technique_Name": "Commonly Used Port"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "Evidence that the network data sent over the C2 channel is HTTPS",
  "ScreenshotDatasources": [],
  "Step": "3. Deploy Stealth Toolkit",
  "Substep": "3.B.4",
  "Subtechnique": "T1071.001",
  "Subtechnique_Name": "Application Layer Protocol: Web Protocols",
  "TacticGroup": "Command and Control",
  "Technique": "T1071",
  "Technique_Name": "Application Layer Protocol"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "Evidence that the network data sent over the C2 channel is encrypted",
  "ScreenshotDatasources": [],
  "Step": "3. Deploy Stealth Toolkit",
  "Substep": "3.B.5",
  "Subtechnique": "T1573.002",
  "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography",
  "TacticGroup": "Command and Control",
  "Technique": "T1573",
  "Technique_Name": "Encrypted Channel"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed the deletion of the command subkey. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.",
    "An MSSP detection for Modify Registry \"(T1070)\" occurred for the Deletion of the registry value."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "Deletion of of the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command subkey",
  "ScreenshotDatasources": [],
  "Step": "3. Deploy Stealth Toolkit",
  "Substep": "3.C.1",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1112",
  "Technique_Name": "Modify Registry"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "General",
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Alert",
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A General alert detection was generated for the creation of a file identified as compressed. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.",
    "Telemetry showed the file write of the ZIP by PowerShell.  The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.",
    "An MSSP detection for Remote File Copy \"(T1105)\" was received. The alert stated the privileged Powershell.exe created a zip file named SysInternalsSuite.zip in the Downloads folder."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe creating the file SysinternalsSuite.zip",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.A.1",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of a new interactive session of PowerShell being created.",
    "Telemetry showed a new powershell.exe spawning from powershell.exe. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe spawning from powershell.exe",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.A.2",
  "Subtechnique": "T1059.001",
  "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell decompressing the ZIP via Expand-Archive and the corresponding file writes. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.",
    "An MSSP detection occurred containing evidence of powershell.exe decompressing SysinternalsSuite.zip via Expand-Archive."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing Expand-Archive",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.A.3",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1140",
  "Technique_Name": "Deobfuscate/Decode Files or Information"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of powershell.exe executing Get-Process.",
    "Telemetry showed powershell.exe executing Get-Process. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing Get-Process",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.B.1",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "Technique_Name": "Process Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.",
    "An MSSP detection occurred containing evidence of sdelete64.exe deleting ?cod.3aka.scr."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "sdelete64.exe deleting the file rcs.3aka3.doc",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.B.2",
  "Subtechnique": "T1070.004",
  "Subtechnique_Name": "Indicator Removal on Host: File Deletion",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1070",
  "Technique_Name": "Indicator Removal on Host"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.",
    "An MSSP detection occurred containing evidence of sdelete64.exe deleting Draft.zip."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "sdelete64.exe deleting the file draft.zip",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.B.3",
  "Subtechnique": "T1070.004",
  "Subtechnique_Name": "Indicator Removal on Host: File Deletion",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1070",
  "Technique_Name": "Indicator Removal on Host"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.",
    "An MSSP detection occurred containing evidence of sdelete64.exe deleting SysinternalsSuite.zip."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "sdelete64.exe deleting the file SysinternalsSuite.zip",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.B.4",
  "Subtechnique": "T1070.004",
  "Subtechnique_Name": "Indicator Removal on Host: File Deletion",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1070",
  "Technique_Name": "Indicator Removal on Host"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing $env:TEMP. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing $env:TEMP",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.1",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "Technique_Name": "File and Directory Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing $env:USERNAME. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing $env:USERNAME",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.2",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Discovery",
  "Technique": "T1033",
  "Technique_Name": "System Owner/User Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing $env:COMPUTERNAME. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing $env:COMPUTERNAME",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.3",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Discovery",
  "Technique": "T1082",
  "Technique_Name": "System Information Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing $env:USERDOMAIN. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing $env:USERDOMAIN",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.4",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Discovery",
  "Technique": "T1016",
  "Technique_Name": "System Network Configuration Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed powershell.exe executing $PID. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing $PID",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.5",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "Technique_Name": "Process Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing Gwmi Win32_OperatingSystem. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.",
    "A MSSP detection occurred for PowerShell querying information about the system via querying WMI and built-in PowerShell functions."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing Gwmi Win32_OperatingSystem",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.6",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Discovery",
  "Technique": "T1082",
  "Technique_Name": "System Information Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Technique",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "A Technique alert detection (high severity) was generated for PowerShell performing suspicious Security Software Discovery.",
    "A MSSP detection occurred for PowerShell querying information about the system via querying WMI and built-in PowerShell functions.",
    "Telemetry showed powershell.exe executing Get-WmiObject... -Class AntiVirusProduct. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing Get-WmiObject ... -Class AntiVirusProduct",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.7",
  "Subtechnique": "T1518.001",
  "Subtechnique_Name": "Software Discovery: Security Software Discovery",
  "TacticGroup": "Discovery",
  "Technique": "T1518",
  "Technique_Name": "Software Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "A MSSP detection occurred for PowerShell querying information about the system via querying WMI and built-in PowerShell functions.",
    "Telemetry showed powershell.exe executing Get-WmiObject... -Class FireWallProduct. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing Get-WmiObject ... -Class FireWallProduct",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.8",
  "Subtechnique": "T1518.001",
  "Subtechnique_Name": "Software Discovery: Security Software Discovery",
  "TacticGroup": "Discovery",
  "Technique": "T1518",
  "Technique_Name": "Software Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing the NetUserGetGroups API. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.",
    "A MSSP detection occurred for powershell.exe executing the NetUserGetGroups API."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing the NetUserGetGroups API",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.9",
  "Subtechnique": "T1069.002",
  "Subtechnique_Name": "Permission Groups Discovery: Domain Groups",
  "TacticGroup": "Discovery",
  "Technique": "T1069",
  "Technique_Name": "Permission Groups Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed the NetUserGetGroups API function loaded into PowerShell from Netapi32.dll. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "The NetUserGetGroups API function loaded into powershell.exe from Netapi32.dll",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.10",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Execution",
  "Technique": "T1106",
  "Technique_Name": "Native API"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing the NetUserGetLocalGroups API. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing the NetUserGetLocalGroups API",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.11",
  "Subtechnique": "T1069.001",
  "Subtechnique_Name": "Permission Groups Discovery: Local Groups",
  "TacticGroup": "Discovery",
  "Technique": "T1069",
  "Technique_Name": "Permission Groups Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed Netapi32.dll loaded into powershell.exe. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "The NetUserGetLocalGroups API function loaded into powershelle.exe from Netapi32.dll",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.12",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Execution",
  "Technique": "T1106",
  "Technique_Name": "Native API"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell created the new service javamtsup. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe creating the Javamtsup service",
  "ScreenshotDatasources": [],
  "Step": "5. Establish Persistence",
  "Substep": "5.A.1",
  "Subtechnique": "T1543.003",
  "Subtechnique_Name": "Create or Modify System Process: Windows Service",
  "TacticGroup": "Persistence",
  "Technique": "T1543",
  "Technique_Name": "Create or Modify System Process"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "MSSP",
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Correlated",
    "Alert",
    "Correlated"
  ],
  "DetectionText": [
    "An MSSP detection occurred for the creation of the hostui.lnk file in the Startup folder.",
    "A Technique alert detection (red indicator) called \"registry run key or file in start up folder created - T1060\" was generated due to powershell.exe creating the hostui.lnk file. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.",
    "Telemetry showed a file create event for hostui.lnk in the Startup folder. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe creating the file hostui.lnk in the Startup folder",
  "ScreenshotDatasources": [],
  "Step": "5. Establish Persistence",
  "Substep": "5.B.1",
  "Subtechnique": "T1547.001",
  "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder",
  "TacticGroup": "Persistence",
  "Technique": "T1547",
  "Technique_Name": "Boot or Logon Autostart Execution"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "MSSP",
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Correlated",
    "Alert",
    "Correlated"
  ],
  "DetectionText": [
    "An MSSP detection occurred for accesschk.exe reading the Chrome database file for credentials.",
    "A Technique alert detection (red indicator) for \"Browser login data access by non-browser process\" was generated when accesschk.exe accessed the Chrome database file for credentials. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.",
    "Telemetry showed accesschk.exe reading the Chrome database file for credentials. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "accesschk.exe reading files within %APPDATALOCAL%\\Google\\chrome\\user data\\default\\",
  "ScreenshotDatasources": [],
  "Step": "6. Credential Access",
  "Substep": "6.A.1",
  "Subtechnique": "T1552.001",
  "Subtechnique_Name": "Unsecured Credentials: Credentials in Files",
  "TacticGroup": "Credential Access",
  "Technique": "T1552",
  "Technique_Name": "Unsecured Credentials"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "accesschk.exe executing the CryptUnprotectedData API",
  "ScreenshotDatasources": [],
  "Step": "6. Credential Access",
  "Substep": "6.A.2",
  "Subtechnique": "T1555.003",
  "Subtechnique_Name": "Credentials from Password Stores: Credentials from Web Browsers",
  "TacticGroup": "Credential Access",
  "Technique": "T1555",
  "Technique_Name": "Credentials from Password Stores"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "MSSP",
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Correlated",
    "Alert",
    "Correlated"
  ],
  "DetectionText": [
    "An MSSP detection occurred indicating that accesschk.exe is not the legitimate Sysinternals tool.",
    "A Technique alert detection (red indicator) called \"Windows process masquerading by an unsigned process\" was generated when accesschk.exe was identified as an unsigned executable and the hash did not match the valid accesschk.exe hash. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.",
    "Telemetry showed accesschk.exe is not a signed Microsoft binary with hash values provided. This can be used to verify it is not the legitimate Sysinternals tool. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "Evidence that accesschk.exe is not the legitimate Sysinternals tool",
  "ScreenshotDatasources": [],
  "Step": "6. Credential Access",
  "Substep": "6.A.3",
  "Subtechnique": "T1036.005",
  "Subtechnique_Name": "Masquerading: Match Legitimate Name or Location",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1036",
  "Technique_Name": "Masquerading"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "MSSP",
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Correlated",
    "Alert",
    "Correlated"
  ],
  "DetectionText": [
    "An MSSP detection was generated for the creation of the $RandomFileName.pfx file.",
    "A Technique alert detection (red indicator) called \"New certificate file has been created\" was generated for the file creation event of the lotu40lg.b0j.pfx file.  The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.",
    "Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe creating a certificate file exported from the system",
  "ScreenshotDatasources": [],
  "Step": "6. Credential Access",
  "Substep": "6.B.1",
  "Subtechnique": "T1552.004",
  "Subtechnique_Name": "Unsecured Credentials: Private Keys",
  "TacticGroup": "Credential Access",
  "Technique": "T1552",
  "Technique_Name": "Unsecured Credentials"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "MSSP",
    "Technique"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Delayed (Processing)",
    "Alert"
  ],
  "DetectionText": [
    "An MSSP detection for \"Mimikatz\" was received that described PowerShell dumping credentials from LSASS process memory.",
    "A Technique alert detection (red indicator) called \"Credentials in Registry\" was generated due to a group owner child process querying the User SAM registry keys. Detection incurred a delay based on additional data processing to generate the behavioral threat."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe injecting into lsass.exe OR lsass.exe reading Registry keys under HKLM:\\SAM\\SAM\\Domains\\Account\\Users\\",
  "ScreenshotDatasources": [],
  "Step": "6. Credential Access",
  "Substep": "6.C.1",
  "Subtechnique": "T1003.002",
  "Subtechnique_Name": "OS Credential Dumping: Security Account Manager",
  "TacticGroup": "Credential Access",
  "Technique": "T1003",
  "Technique_Name": "OS Credential Dumping"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "MSSP",
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Alert"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of powershell.exe executing performing a Screen Capture.",
    "Telemetry showed powershell.exe executing CopyFromScreen from System.Drawing.dll.",
    "A Technique alert detection called \"Screen Capture - T1056\" was generated for powershell.exe making the GdiBitBlt API call."
  ],
  "Footnotes": [
    "Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."
  ],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing the CopyFromScreen function from System.Drawing.dll",
  "ScreenshotDatasources": [],
  "Step": "7. Collection and Exfiltration",
  "Substep": "7.A.1",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Collection",
  "Technique": "T1113",
  "Technique_Name": "Screen Capture"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "MSSP",
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Alert"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of PowerShell capturing clipboard data.",
    "Telemetry showed powershell.exe executing Get-Clipboard.",
    "A Technique alert detection called \"clipboard data accessed\" was generated due to the use of getclipboarddata API."
  ],
  "Footnotes": [
    "Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."
  ],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing Get-Clipboard",
  "ScreenshotDatasources": [],
  "Step": "7. Collection and Exfiltration",
  "Substep": "7.A.2",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Collection",
  "Technique": "T1115",
  "Technique_Name": "Clipboard Data"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "MSSP",
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Alert"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of key logging.",
    "A Technique alert detection called \"Input Capture\" was generated due to powershell.exe making the GetAsyncKeyState API call.",
    "Telemetry showed PowerShell calling the GetAsyncKeyState API."
  ],
  "Footnotes": [
    "Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."
  ],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing the GetAsyncKeyState API",
  "ScreenshotDatasources": [],
  "Step": "7. Collection and Exfiltration",
  "Substep": "7.A.3",
  "Subtechnique": "T1056.001",
  "Subtechnique_Name": "Input Capture: Keylogging",
  "TacticGroup": "Collection",
  "Technique": "T1056",
  "Technique_Name": "Input Capture"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of  powershell.exe accessing files from C:\\Users\\pam\\Downloads.",
    "Telemetry showed Powershell.exe reading files from C:\\Users\\pam\\Downloads. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe reading files in C:\\Users\\pam\\Downloads\\",
  "ScreenshotDatasources": [],
  "Step": "7. Collection and Exfiltration",
  "Substep": "7.B.1",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Collection",
  "Technique": "T1005",
  "Technique_Name": "Data from Local System"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "MSSP",
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Correlated",
    "Alert",
    "Correlated"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of the file create of OfficeSupplies.7z.",
    "A Technique alert detection (red indicator) called \"Scripting engine creates compressed file under suspicious location\" was generated for the file creation event of a .7z file in %APPDATA%. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.",
    "Telemetry showed the file create event for OfficeSupplies.7z. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe creating the file OfficeSupplies.7z",
  "ScreenshotDatasources": [],
  "Step": "7. Collection and Exfiltration",
  "Substep": "7.B.2",
  "Subtechnique": "T1560.001",
  "Subtechnique_Name": "Archive Collected Data: Archive via Utility",
  "TacticGroup": "Collection",
  "Technique": "T1560",
  "Technique_Name": "Archive Collected Data"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing Compress-7Zip with the password argument used for encryption",
  "ScreenshotDatasources": [],
  "Step": "7. Collection and Exfiltration",
  "Substep": "7.B.3",
  "Subtechnique": "T1560.001",
  "Subtechnique_Name": "Archive Collected Data: Archive via Utility",
  "TacticGroup": "Collection",
  "Technique": "T1560",
  "Technique_Name": "Archive Collected Data"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP",
    "General"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Delayed (Manual)",
    "Correlated",
    "Alert"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell creating OfficeSupplies.7z on a remote adversary WebDav network share (192.168.0.4). The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.",
    "An MSSP detection occurred containing evidence of OfficeSupplies.7z being copied over the network via WebDav to 192.168.0.4.",
    "A General alert detection (red indicator) called \"File being written to remote path\" was generated for the file OfficeSupplies.7z being written a WebDav share at 192.168.0.4.  The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell executing Copy-Item pointing to an attack-controlled WebDav network share (192.168.0.4:80)",
  "ScreenshotDatasources": [],
  "Step": "7. Collection and Exfiltration",
  "Substep": "7.B.4",
  "Subtechnique": "T1048.003",
  "Subtechnique_Name": "Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol",
  "TacticGroup": "Exfiltration",
  "Technique": "T1048",
  "Technique_Name": "Exfiltration Over Alternative Protocol"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe establishing a connection to NewYork (10.0.0.4) over port 389. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe making LDAP queries over port 389 to the Domain Controller (10.0.0.4)",
  "ScreenshotDatasources": [],
  "Step": "8. Expand Access",
  "Substep": "8.A.1",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Discovery",
  "Technique": "T1018",
  "Technique_Name": "Remote System Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "An MSSP detection occurred for the WinRM connection to remote host Scranton (10.0.1.4) over port 5985.",
    "Telemetry showed a connection to Scranton (10.0.1.4) over port 5985. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from a temporary folder."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "Network connection to Scranton (10.0.1.4) over port 5985",
  "ScreenshotDatasources": [],
  "Step": "8. Expand Access",
  "Substep": "8.A.2",
  "Subtechnique": "T1021.006",
  "Subtechnique_Name": "Remote Services: Windows Remote Management",
  "TacticGroup": "Lateral Movement",
  "Technique": "T1021",
  "Technique_Name": "Remote Services"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP",
    "Technique"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Alert"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing Get-Process.",
    "An MSSP detection occurred for powershell.exe executing Get-Process.",
    "A Technique alert detection (red indicator) called \"Process Discovery with PowerShell\" was generated due to powershell.exe executing Get-Process."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing Get-Process",
  "ScreenshotDatasources": [],
  "Step": "8. Expand Access",
  "Substep": "8.A.3",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "Technique_Name": "Process Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Technique",
    "MSSP",
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Alert",
    "Delayed (Manual)",
    "Alert",
    "Correlated"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) called \"Executable copied to remote host via $ share\" was generated for python.exe being copied from Nashua to Scranton. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.",
    "An MSSP detection contained evidence of remote file copy of python.exe to Scranton (10.0.1.4).",
    "A Technique alert detection (red indicator) called \"Remote File Copy\" was generated for python.exe being copied Scranton (10.0.1.4).",
    "Telemetry showed the file create event of python.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "The file python.exe created on Scranton (10.0.1.4)",
  "ScreenshotDatasources": [],
  "Step": "8. Expand Access",
  "Substep": "8.B.1",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "MSSP",
    "Technique"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Alert"
  ],
  "DetectionText": [
    "An MSSP detection was generated containing evidence of observed UPX packing on a Python payload.",
    "A Technique alert detection (red indicator) for \"Software Packing - T1045\" was generated for the file creation event for python.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "Evidence that the file python.exe is packed",
  "ScreenshotDatasources": [],
  "Step": "8. Expand Access",
  "Substep": "8.B.2",
  "Subtechnique": "T1027.002",
  "Subtechnique_Name": "Obfuscated Files or Information: Software Packing",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1027",
  "Technique_Name": "Obfuscated Files or Information"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "Successful logon as user Pam on Scranton (10.0.1.4)",
  "ScreenshotDatasources": [],
  "Step": "8. Expand Access",
  "Substep": "8.C.1",
  "Subtechnique": "T1078.002",
  "Subtechnique_Name": "Valid Accounts: Domain Accounts",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1078",
  "Technique_Name": "Valid Accounts"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "MSSP",
    "Telemetry",
    "Technique",
    "Technique"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Correlated",
    "Correlated",
    "Alert",
    "Alert"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 445.",
    "Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over port 135. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.",
    "A Technique alert detection was generated for an executable being copied to a remote host via a share. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.",
    "A Technique alert detection for network share access was generated due to remote access to a Windows admin share."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "SMB session to Scranton (10.0.1.4) over TCP port 445/135 OR evidence of usage of a Windows share",
  "ScreenshotDatasources": [],
  "Step": "8. Expand Access",
  "Substep": "8.C.2",
  "Subtechnique": "T1021.002",
  "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares",
  "TacticGroup": "Lateral Movement",
  "Technique": "T1021",
  "Technique_Name": "Remote Services"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "MSSP",
    "Technique",
    "General",
    "Telemetry",
    "General",
    "General"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Alert",
    "Alert",
    "Alert",
    "Correlated",
    "Alert",
    "Correlated"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of python.exe being spawned by PSEXESVC.exe.",
    "A Technique alert detection called \"Service Execution Start service T1050\" was generated due to psexec.exe spawning python.exe.",
    "A General alert detection (low severity) was generated due to an unsigned process running from a temporary directory.",
    "Telemetry showed python.exe spawned by PSEXESVC.exe and originated from a RPC call originating on the remote host Nashua (10.0.1.6).",
    "A General alert detection was generated for PSEXESVC.exe being copied to a remote host. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder.",
    "A General alert detection (red indicator) for \"Lateral Movement\" was generated due to PSEXE64.exe execution with plain-text credentials from Nashua as the user Pam. The detection was correlated to a parent alert for the rcs.3aka3.doc screensaver process executing from users or temporary folder."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "python.exe spawned by PSEXESVC.exe",
  "ScreenshotDatasources": [],
  "Step": "8. Expand Access",
  "Substep": "8.C.3",
  "Subtechnique": "T1569.002",
  "Subtechnique_Name": "System Services: Service Execution",
  "TacticGroup": "Execution",
  "Technique": "T1569",
  "Technique_Name": "System Services"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "General",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Alert",
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed a file write event for python.exe creating rar.exe from a named pipe. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.",
    "A General alert detection (red indicator) was generated for python.exe writing rar.exe to C:\\Windows\\Temp. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.",
    "An MSSP detection occurred for python.exe creating rar.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "python.exe creating the file rar.exe",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.A.1",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed File Write/Create events for python.exe creating sdelete64.exe. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.",
    "A MSSP detection occurred for python.exe creating sdelete64.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "python.exe creating the file sdelete64.exe",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.A.2",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed python.exe executing powershell.exe. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.",
    "An MSSP detection contained evidence of python spawning powershell.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe spawning from python.exe",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.B.1",
  "Subtechnique": "T1059.001",
  "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing Get-ChildItem. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.",
    "A MSSP detection occurred for PowerShell looking for certain files in a directory."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing (Get-)ChildItem",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.B.2",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "Technique_Name": "File and Directory Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "An MSSP detection for Automated Collection \"(T1119)\" occurred containing evidence that a discovery script was using get-childitem to search the filesystem to specific file patterns.",
    "Telemetry showed powershell.exe executing Get-ChildItem. The detection was correlated to a parent alert for an unsigned process running from a temporary directory."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing (Get-)ChildItem",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.B.3",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Collection",
  "Technique": "T1119",
  "Technique_Name": "Automated Collection"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed file reads of C:\\Users\\Pam\\*. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.",
    "A MSSP detection occurred for powershell.exe reading files in C:\\Users\\Pam."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe reading files in C:\\Users\\Pam\\",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.B.4",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Collection",
  "Technique": "T1005",
  "Technique_Name": "Data from Local System"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Tactic",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "A Tactic alert detection called \"Collection\" was generated due to working.zip file creation in %APPDATA%\\roaming folder. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.",
    "An MSSP detection contained evidence of the creation of working.zip.",
    "Telemetry showed the file create of working.zip. The detection was correlated to a parent alert for an unsigned process running from a temporary directory."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe creating the file working.zip",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.B.5",
  "Subtechnique": "T1074.001",
  "Subtechnique_Name": "Data Staged: Local Data Staging",
  "TacticGroup": "Collection",
  "Technique": "T1074",
  "Technique_Name": "Data Staged"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing rar.exe with command-line arguments. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.",
    "An MSSP detection contained evidence of execution of rar.exe with command line arguments to encrypt working.zip."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing rar.exe with the -a parameter for a password to use for encryption",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.B.6",
  "Subtechnique": "T1560.001",
  "Subtechnique_Name": "Archive Collected Data: Archive via Utility",
  "TacticGroup": "Collection",
  "Technique": "T1560",
  "Technique_Name": "Archive Collected Data"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Correlated",
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing rar.exe with command-line arguments. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.",
    "A Technique alert detection (red indicator) for \"Scripting engine creates compressed file under suspicious folder\" was generated when rar.exe was used to create an compressed zip archive in %APPDATA%. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.",
    "An MSSP detection contained evidence of execution of rar.exe with command line arguments to compress working.zip."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing rar.exe",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.B.7",
  "Subtechnique": "T1560.001",
  "Subtechnique_Name": "Archive Collected Data: Archive via Utility",
  "TacticGroup": "Collection",
  "Technique": "T1560",
  "Technique_Name": "Archive Collected Data"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed file read event for working.zip and an existing C2 channel (192.168.0.4 over port 8443). The detection was correlated to a parent alert for an unsigned process running from a temporary directory."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "python.exe reading the file working.zip while connected to the C2 channel",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.B.8",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Command and Control",
  "Technique": "T1041",
  "Technique_Name": "Exfiltration Over Command and Control Channel"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.",
    "An MSSP detection contained evidence of the deletion of Rar.exe by SDelete64.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "sdelete64.exe deleting the file rar.exe",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.C.1",
  "Subtechnique": "T1070.004",
  "Subtechnique_Name": "Indicator Removal on Host: File Deletion",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1070",
  "Technique_Name": "Indicator Removal on Host"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Technique",
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection called \"file deletion T1107\"  was generated when sdelete64.exe with command-line arguments was used to delete Desktop\\working.zip.",
    "Telemetry showed file delete event for sdelete64.exe deleting Desktop\\working.zip. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.",
    "An MSSP detection contained evidence of the deletion of Desktop\\working.zip by SDelete64.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "sdelete64.exe deleting the file \\Desktop\\working.zip",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.C.2",
  "Subtechnique": "T1070.004",
  "Subtechnique_Name": "Indicator Removal on Host: File Deletion",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1070",
  "Technique_Name": "Indicator Removal on Host"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.",
    "An MSSP detection contained evidence of the deletion of roaming\\working.zip by SDelete64.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "sdelete64.exe deleting the file \\AppData\\Roaming\\working.zip",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.C.3",
  "Subtechnique": "T1070.004",
  "Subtechnique_Name": "Indicator Removal on Host: File Deletion",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1070",
  "Technique_Name": "Indicator Removal on Host"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP",
    "Technique"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Delayed (Manual)",
    "Alert"
  ],
  "DetectionText": [
    "Telemetry showed cmd.exe deleting sdelete64.exe and file deletion event. The detection was correlated to a parent alert for an unsigned process running from a temporary directory.",
    "An MSSP detection contained evidence of the deletion of SDelete64.exe.",
    "A Technique alert detection called \"file deletion T1107\" was generated when cmd.exe deleted sdelete.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "cmd.exe deleting the file sdelete64.exe",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.C.4",
  "Subtechnique": "T1070.004",
  "Subtechnique_Name": "Indicator Removal on Host: File Deletion",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1070",
  "Technique_Name": "Indicator Removal on Host"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "javamtsup.exe spawning from services.exe",
  "ScreenshotDatasources": [],
  "Step": "10. Persistence Execution",
  "Substep": "10.A.1",
  "Subtechnique": "T1569.002",
  "Subtechnique_Name": "System Services: Service Execution",
  "TacticGroup": "Execution",
  "Technique": "T1569",
  "Technique_Name": "System Services"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred for hostui.lnk executing from Startup Folder."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "Evidence that the file hostui.lnk (which executes hostui.bat as a byproduct) was executed from the Startup Folder",
  "ScreenshotDatasources": [],
  "Step": "10. Persistence Execution",
  "Substep": "10.B.1",
  "Subtechnique": "T1547.001",
  "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder",
  "TacticGroup": "Persistence",
  "Technique": "T1547",
  "Technique_Name": "Boot or Logon Autostart Execution"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of powershell.exe executing with the explorer.exe token via the CreateProcessWithToken API."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "hostui.exe executing the CreateProcessWithToken API",
  "ScreenshotDatasources": [],
  "Step": "10. Persistence Execution",
  "Substep": "10.B.2",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Execution",
  "Technique": "T1106",
  "Technique_Name": "Native API"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) for \"Access Token Manipulation\" was generated for thread impersonation.",
    "An MSSP detection occurred containing evidence of powershell.exe executing with the explorer.exe token via the CreateProcessWithToken API."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "hostui.exe manipulating the token of powershell.exe via the CreateProcessWithToken API OR powershell.exe executing with the stolen token of explorer.exe",
  "ScreenshotDatasources": [],
  "Step": "10. Persistence Execution",
  "Substep": "10.B.3",
  "Subtechnique": "T1134.002",
  "Subtechnique_Name": "Access Token Manipulation: Create Process with Token",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1134",
  "Technique_Name": "Access Token Manipulation"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP",
    "General"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Alert"
  ],
  "DetectionText": [
    "Telemetry showed explorer.exe executing powershell.exe.",
    "An MSSP detection was generated containing evidence user Oscar executed 37486-the-shockingtruth-about-election-rigging-in-america.rtf.lnk.",
    "A General alert detection (red indicator) was generated for a suspicious Powershell process being spawned by explorer.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe spawning from explorer.exe",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.1",
  "Subtechnique": "T1204.002",
  "Subtechnique_Name": "User Execution: Malicious File",
  "TacticGroup": "Execution",
  "Technique": "T1204",
  "Technique_Name": "User Execution"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.",
    "An MSSP detection contained evidence of PowerShell executing schemas ADS via Get-Content and IEX."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing the schemas ADS via Get-Content and IEX",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.2",
  "Subtechnique": "T1564.004",
  "Subtechnique_Name": "Hide Artifacts: NTFS File Attributes",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1564",
  "Technique_Name": "Hide Artifacts"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP",
    "Technique"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Alert"
  ],
  "DetectionText": [
    "Telemetry showed the PowerShell gwmi query for Win32_BIOS.",
    "An MSSP detection occurred containing evidence of execution of an WMI query for Win32_BIOS.",
    "A Technique alert detection called \"System Information Discovery\" was generated for a PowerShell gwmi query for Win32_BIOS."
  ],
  "Footnotes": [
    "Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."
  ],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing a Get-WmiObject query for Win32_BIOS",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.3",
  "Subtechnique": "T1497.001",
  "Subtechnique_Name": "Virtualization/Sandbox Evasion: System Checks",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1497",
  "Technique_Name": "Virtualization/Sandbox Evasion"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Technique",
    "MSSP",
    "Telemetry",
    "Tactic"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)",
    "Alert"
  ],
  "DetectionText": [
    "A Technique alert detection called \"System Information Discovery\" was generated for a PowerShell gwmi query for Win32_BIOS.",
    "An MSSP detection occurred containing evidence of execution of WMI queries for Win32_BIOS and Win32_ComputerSystem.",
    "Telemetry showed the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.",
    "A Tactic alert detection called WMI virtualization sandbox discovery was generated for a PowerShell gwmi query for Win32_ComputerSystem."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing a Get-WmiObject gwmi queries for Win32_BIOS and Win32_ComputerSystem",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.4",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Discovery",
  "Technique": "T1082",
  "Technique_Name": "System Information Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence execution of an WMI query for Win32_PnPEntity.",
    "Telemetry showed the PowerShell gwmi query for Win32_PnPEntity."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing a Get-WmiObject query for Win32_PnPEntity",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.5",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Discovery",
  "Technique": "T1120",
  "Technique_Name": "Peripheral Device Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "MSSP",
    "Telemetry",
    "Tactic"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Alert"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of execution of an WMI query for Win32_ComputerSystem.",
    "Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem.",
    "A Tactic alert detection called WMI virtualization sandbox discovery was generated for a PowerShell gwmi query for Win32_ComputerSystem."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.6",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Discovery",
  "Technique": "T1033",
  "Technique_Name": "System Owner/User Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "MSSP",
    "Telemetry",
    "Tactic"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Alert"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of execution of an WMI query for Win32_ComputerSystem.",
    "Telemetry showed powershell.exe gwmi query for Win32_ComputerSystem.",
    "A Tactic alert detection called WMI virtualization sandbox discovery was generated for a PowerShell gwmi query for Win32_ComputerSystem."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.7",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Discovery",
  "Technique": "T1016",
  "Technique_Name": "System Network Configuration Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "MSSP",
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Alert"
  ],
  "DetectionText": [
    "An MSSP detection contained evidence of PowerShell executing a gwmi query for Win32_Process.",
    "A Technique alert detection called \"process discovery - T1057\" was generated for a PowerShell gwmi query for Win32_Process.",
    "Telemetry showed the PowerShell gwmi query for Win32_Process."
  ],
  "Footnotes": [
    "Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."
  ],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing a Get-WmiObject query for Win32_Process",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.8",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "Technique_Name": "Process Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing (Get-Item -Path \".\\\" -Verbose).FullName",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.9",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "Technique_Name": "File and Directory Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "MSSP",
    "Telemetry",
    "General"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Alert"
  ],
  "DetectionText": [
    "A MSSP detection occurred for certutil.exe decoding kxwn.lock.",
    "Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.",
    "A General alert detection (red indicator) for \"encoding information using Windows certificate management tool\" was generated due to certutil decoding the kwxn.lock payload."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "certutil.exe decoding kxwn.lock",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.10",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1140",
  "Technique_Name": "Deobfuscate/Decode Files or Information"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP",
    "Technique",
    "Technique"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Alert",
    "Alert"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe adding Run key persistence into the Registry.",
    "An MSSP detection contained evidence of the Webcache subkey added to the Registry to establish persistence.",
    "A Technique alert detection (red indicator) called \"commonly abused process creates a new autostart Registry key\" was generated for powershell.exe adding Run key persistence into the Registry.",
    "A Technique alert detection (red indicator) called \"New entry added to startup related Registry keys by signed binary\" was generated for powershell.exe adding Run key persistence into the Registry."
  ],
  "Footnotes": [
    "Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."
  ],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "Addition of the Webcache subkey in HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.11",
  "Subtechnique": "T1547.001",
  "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder",
  "TacticGroup": "Persistence",
  "Technique": "T1547",
  "Technique_Name": "Boot or Logon Autostart Execution"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection contained evidence of PowerShell executing from schemas ADS.",
    "Telemetry showed powershell.exe spawned from a PowerShell stager."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe spawning from from the schemas ADS (powershell.exe)",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.12",
  "Subtechnique": "T1059.001",
  "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection contained evidence of PowerShell establishing C2 with 192.168.0.4 over TCP port 443.",
    "Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "Established network channel over port 443",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.13",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Command and Control",
  "Technique": "T1043",
  "Technique_Name": "Commonly Used Port"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "Established network channel over the HTTPS protocol",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.14",
  "Subtechnique": "T1071.001",
  "Subtechnique_Name": "Application Layer Protocol: Web Protocols",
  "TacticGroup": "Command and Control",
  "Technique": "T1071",
  "Technique_Name": "Application Layer Protocol"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "Evidence that the network data sent over the C2 channel is encrypted",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.15",
  "Subtechnique": "T1573.002",
  "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography",
  "TacticGroup": "Command and Control",
  "Technique": "T1573",
  "Technique_Name": "Encrypted Channel"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection for Timestomping was generated containing evidence of PowerShell enumeration of System32."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing (gci ((gci env:windir).Value + '\\system32')",
  "ScreenshotDatasources": [],
  "Step": "12. Fortify Access",
  "Substep": "12.A.1",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "Technique_Name": "File and Directory Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Alert"
  ],
  "DetectionText": [
    "Telemetry showed scriptblock with commands to timestomp kxwn.lock.",
    "A Technique alert detection called \"ioc.Timestomp_T1099\" (high severity) was generated due to PowerShell modifying timestamps on kxwn.lock file. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe."
  ],
  "Footnotes": [
    "Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."
  ],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe modifying the creation, last access, and last write times of kxwn.lock",
  "ScreenshotDatasources": [],
  "Step": "12. Fortify Access",
  "Substep": "12.A.2",
  "Subtechnique": "T1070.006",
  "Subtechnique_Name": "Indicator Removal on Host: Timestomp",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1070",
  "Technique_Name": "Indicator Removal on Host"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP",
    "Technique"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Alert"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell gwmi query for AntiVirusProduct.",
    "A MSSP detection occurred containing evidence of security software discovery attempts.",
    "A Technique alert detection (high severity) called \"Security Software Discovery\" was generated due to powershell executing a gwmi query for AntiVirusProduct."
  ],
  "Footnotes": [
    "Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."
  ],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing a Get-WmiObject query for AntiVirusProduct",
  "ScreenshotDatasources": [],
  "Step": "12. Fortify Access",
  "Substep": "12.B.1",
  "Subtechnique": "T1518.001",
  "Subtechnique_Name": "Software Discovery: Security Software Discovery",
  "TacticGroup": "Discovery",
  "Technique": "T1518",
  "Technique_Name": "Software Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "MSSP",
    "Tactic"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Alert",
    "Delayed (Manual)",
    "Alert"
  ],
  "DetectionText": [
    "Telemetry showed script block with registry query for installed software.",
    "A Technique alert detection was generated for PowerShell querying the registry. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.",
    "An MSSP detection occurred containing evidence of the registry query for installed software.",
    "A Tactic alert detection (high severity) called for Discovery was generated when the software function was executed."
  ],
  "Footnotes": [
    "Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."
  ],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall",
  "ScreenshotDatasources": [],
  "Step": "12. Fortify Access",
  "Substep": "12.C.1",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Discovery",
  "Technique": "T1012",
  "Technique_Name": "Query Registry"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "MSSP",
    "Tactic"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Delayed (Manual)",
    "Alert"
  ],
  "DetectionText": [
    "Telemetry showed scriptblock with registry query for installed software.",
    "A Technique alert detection was generated for PowerShell querying the registry. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.",
    "An MSSP detection occurred containing evidence of the registry query for installed software.",
    "A Tactic alert detection (high severity) for Discovery was generated when the software function was executed."
  ],
  "Footnotes": [
    "Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."
  ],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall",
  "ScreenshotDatasources": [],
  "Step": "12. Fortify Access",
  "Substep": "12.C.2",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Discovery",
  "Technique": "T1012",
  "Technique_Name": "Query Registry"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell calling the GetComputerNameEx API. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing the GetComputerNameEx API",
  "ScreenshotDatasources": [],
  "Step": "13. Reconnaissance",
  "Substep": "13.A.1",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Discovery",
  "Technique": "T1082",
  "Technique_Name": "System Information Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell calling the NetWkstaGetInfo API. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing the NetWkstaGetInfo API",
  "ScreenshotDatasources": [],
  "Step": "13. Reconnaissance",
  "Substep": "13.B.1",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Discovery",
  "Technique": "T1016",
  "Technique_Name": "System Network Configuration Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell calling the GetUserNameEx API. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing the GetUserNameEx API",
  "ScreenshotDatasources": [],
  "Step": "13. Reconnaissance",
  "Substep": "13.C.1",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Discovery",
  "Technique": "T1033",
  "Technique_Name": "System Owner/User Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell calling the CreateToolhelp32Snapshot API. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing the CreateToolhelp32Snapshot API",
  "ScreenshotDatasources": [],
  "Step": "13. Reconnaissance",
  "Substep": "13.D.1",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "Technique_Name": "Process Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed the addition of the DelegateExecute Registry value. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.",
    "An MSSP detection occurred containing evidence of the addition of DelegateExecute subkey."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "Addition of the DelegateExecute subkey in HKCU\\Software\\Classes\\Folder\\shell\\open\\command",
  "ScreenshotDatasources": [],
  "Step": "14. Elevation & Credential Access",
  "Substep": "14.A.1",
  "Subtechnique": "T1546.015",
  "Subtechnique_Name": "Event Triggered Execution: Component Object Model Hijacking",
  "TacticGroup": "Privilege Escalation",
  "Technique": "T1546",
  "Technique_Name": "Event Triggered Execution"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed a new High Integrity PowerShell callback spawned from control.exe (spawned from sdclt.exe).",
    "An MSSP detection contained evidence of High Integrity PowerShell process spawned from control.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "High integrity powrshell.exe spawning from control.exe (spawned from sdclt.exe)",
  "ScreenshotDatasources": [],
  "Step": "14. Elevation & Credential Access",
  "Substep": "14.A.2",
  "Subtechnique": "T1548.002",
  "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control",
  "TacticGroup": "Privilege Escalation",
  "Technique": "T1548",
  "Technique_Name": "Abuse Elevation Control Mechanism"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed the deletion of the Registry value. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "Deletion of the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command subkey",
  "ScreenshotDatasources": [],
  "Step": "14. Elevation & Credential Access",
  "Substep": "14.A.3",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1112",
  "Technique_Name": "Modify Registry"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Configuration Change (UX)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executed by WMI. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe."
  ],
  "Footnotes": [
    "The way this data was presented was altered after the start of the evaluation so the detection is identified as a Detection Configuration Change."
  ],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "WMI Process (WmiPrvSE.exe) executing powershell.exe",
  "ScreenshotDatasources": [],
  "Step": "14. Elevation & Credential Access",
  "Substep": "14.B.1",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Execution",
  "Technique": "T1047",
  "Technique_Name": "Windows Management Instrumentation"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing Get-Process",
  "ScreenshotDatasources": [],
  "Step": "14. Elevation & Credential Access",
  "Substep": "14.B.2",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "Technique_Name": "Process Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Technique",
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) was generated for an executable created by a Windows scripting engine. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.",
    "Telemetry showed the PowerShell command to download m.exe as well as the file create event for m.exe into the System32 folder. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.",
    "An MSSP detection contained evidence of the creation of m.exe in the System32 folder."
  ],
  "Footnotes": [
    "According to the vendor, payload execution would have been prevented as Wildfire labeled the payload as malicious/malware."
  ],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe downloading and/or the file write of m.exe",
  "ScreenshotDatasources": [],
  "Step": "14. Elevation & Credential Access",
  "Substep": "14.B.3",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "General",
    "Technique",
    "MSSP",
    "Technique"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert",
    "Delayed (Manual)",
    "Alert",
    "Correlated"
  ],
  "DetectionText": [
    "A General alert was generated identifying m.exe as malware.",
    "A Technique alert detection (high severity) for Credential Dumping was generated for PowerShell reading credentials from Lsass memory.",
    "An MSSP detection contained evidence of the creation of m.exe in the System32 folder.",
    "A Technique alert detection (red indicator) called \"Command line arguments matching Mimikatz execution\" was generated for m.exe with command-line arguments indicative of Mimikatz credential dumping. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe."
  ],
  "Footnotes": [
    "According to the vendor, payload execution would have been prevented as Wildfire labeled the payload as malicious/malware."
  ],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "m.exe injecting into lsass.exe to dump credentials",
  "ScreenshotDatasources": [],
  "Step": "14. Elevation & Credential Access",
  "Substep": "14.B.4",
  "Subtechnique": "T1003.001",
  "Subtechnique_Name": "OS Credential Dumping: LSASS Memory",
  "TacticGroup": "Credential Access",
  "Technique": "T1003",
  "Technique_Name": "OS Credential Dumping"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell writing encoded content into the WMI class. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.",
    "An MSSP detection contained evidence of PowerShell executing Set-WmiInstance to write encoded content to Win32_AuditCode."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing Set-WmiInstance",
  "ScreenshotDatasources": [],
  "Step": "14. Elevation & Credential Access",
  "Substep": "14.B.5",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1027",
  "Technique_Name": "Obfuscated Files or Information"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred for PowerShell Get-WmiInstance reading encoded content from Win32_AuditCode."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing Get-WmiInstance",
  "ScreenshotDatasources": [],
  "Step": "14. Elevation & Credential Access",
  "Substep": "14.B.6",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1140",
  "Technique_Name": "Deobfuscate/Decode Files or Information"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "An MSSP detection occurred for PowerShell executing $env:UserName.",
    "Telemetry showed PowerShell script block executing $env:UserName. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing $env:UserName",
  "ScreenshotDatasources": [],
  "Step": "15. Establish Persistence",
  "Substep": "15.A.1",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Discovery",
  "Technique": "T1033",
  "Technique_Name": "System Owner/User Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.",
    "A Technique alert detection was generated for PowerShell creating a WMI event subscription.",
    "An MSSP detection contained evidence of WMI persistence established for user Oscar."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe creating the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription",
  "ScreenshotDatasources": [],
  "Step": "15. Establish Persistence",
  "Substep": "15.A.2",
  "Subtechnique": "T1546.003",
  "Subtechnique_Name": "Event Triggered Execution: Windows Management Instrumentation Event Subscription",
  "TacticGroup": "Persistence",
  "Technique": "T1546",
  "Technique_Name": "Event Triggered Execution"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe making LDAP queries over port 389 via functions from System.DirectoryServices.dll",
  "ScreenshotDatasources": [],
  "Step": "16. Expand Access",
  "Substep": "16.A.1",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Discovery",
  "Technique": "T1018",
  "Technique_Name": "Remote System Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell executing the ConvertSidToStringSid API function. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.",
    "An MSSP detection occurred containing evidence of the execution of the ConvertSidToStringSid API."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing the ConvertSidToStringSid API",
  "ScreenshotDatasources": [],
  "Step": "16. Expand Access",
  "Substep": "16.B.1",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Discovery",
  "Technique": "T1033",
  "Technique_Name": "System Owner/User Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of the execution of the ConvertSidToStringSid API.",
    "Telemetry showed PowerShell executing the ConvertSidToStringSid API function. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing the ConvertSidToStringSid API function by loading Advapi32.dll",
  "ScreenshotDatasources": [],
  "Step": "16. Expand Access",
  "Substep": "16.B.2",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Execution",
  "Technique": "T1106",
  "Technique_Name": "Native API"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "An MSSP detection for Windows Remote Management occurred containing evidence of the connection to remote host NewYork (10.0.0.4) over port 5985.",
    "Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "Network connection to NewYork (10.0.0.4) over port 5985",
  "ScreenshotDatasources": [],
  "Step": "16. Expand Access",
  "Substep": "16.C.1",
  "Subtechnique": "T1021.006",
  "Subtechnique_Name": "Remote Services: Windows Remote Management",
  "TacticGroup": "Lateral Movement",
  "Technique": "T1021",
  "Technique_Name": "Remote Services"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed a successful logon on NewYork (10.0.0.4) as user MScott."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "Successful logon as user MScott on NewYork (10.0.0.4)",
  "ScreenshotDatasources": [],
  "Step": "16. Expand Access",
  "Substep": "16.C.2",
  "Subtechnique": "T1078.002",
  "Subtechnique_Name": "Valid Accounts: Domain Accounts",
  "TacticGroup": "Initial Access",
  "Technique": "T1078",
  "Technique_Name": "Valid Accounts"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed the creation of m.exe in the System32 directory by wsmprovhost.exe.",
    "An MSSP detection contained evidence of the write of m.exe to the System32 directory by wsmprovhost.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "File write of m.exe by the WinRM process (wsmprovhost.exe)",
  "ScreenshotDatasources": [],
  "Step": "16. Expand Access",
  "Substep": "16.D.1",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Lateral Movement",
  "Technique": "T1570",
  "Technique_Name": "Lateral Tool Transfer"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "Technique",
    "General",
    "MSSP",
    "General"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert",
    "Alert",
    "Delayed (Manual)",
    "Alert"
  ],
  "DetectionText": [
    "Telemetry showed m.exe injecting a thread into lsass.exe.",
    "A Technique alert detection (red indicator) called \"Credential Dumping\" was generated for m.exe reading lsass.exe process memory.",
    "A Technique alert detection (red indicator) called \"Command line arguments matching Mimikatz execution\" was generated for m.exe with command-line arguments indicative of Mimikatz credential dumping.",
    "A General alert detection called \"heuristic.b.mimikatz_lsadump_inject\" was generated for possible Mimikatz activity.",
    "An MSSP detection contained evidence of Mimikatz command-line arguments to dump credentials.",
    "A General alert detection (red indicator) was generated for a rare child process spawned from wsmprovhost.exe."
  ],
  "Footnotes": [
    "According to the vendor, payload execution would have been prevented as Wildfire labeled the payload as malicious/malware.",
    "According to the vendor, payload execution would have been prevented as Wildfire labeled the payload as malicious/malware."
  ],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "m.exe injecting into lsass.exe to dump credentials",
  "ScreenshotDatasources": [],
  "Step": "16. Expand Access",
  "Substep": "16.D.2",
  "Subtechnique": "T1003.001",
  "Subtechnique_Name": "OS Credential Dumping: LSASS Memory",
  "TacticGroup": "Credential Access",
  "Technique": "T1003",
  "Technique_Name": "OS Credential Dumping"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed outlook.exe spawning from powershell.exe, which is indicative of programmatic access to Outlook emails. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "outlook.exe spawning from svchost.exe or powershell.exe",
  "ScreenshotDatasources": [],
  "Step": "17. Collection",
  "Substep": "17.A.1",
  "Subtechnique": "T1114.001",
  "Subtechnique_Name": "Email Collection: Local Email Collection",
  "TacticGroup": "Collection",
  "Technique": "T1114",
  "Technique_Name": "Email Collection"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe reading the file MITRE-ATTACK-EVALS.HTML",
  "ScreenshotDatasources": [],
  "Step": "17. Collection",
  "Substep": "17.B.1",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Collection",
  "Technique": "T1005",
  "Technique_Name": "Data from Local System"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe creating the file \\WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML",
  "ScreenshotDatasources": [],
  "Step": "17. Collection",
  "Substep": "17.B.2",
  "Subtechnique": "T1074.001",
  "Subtechnique_Name": "Data Staged: Local Data Staging",
  "TacticGroup": "Collection",
  "Technique": "T1074",
  "Technique_Name": "Data Staged"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "General",
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A General alert detection for Data Staged was generated when the WindowsParentalControlMigration.tmp file was compressed.",
    "Telemetry showed PowerShell compressing collection via the ZipFile.CreateFromDirectory .NET method. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.",
    "An MSSP detection occurred containing evidence of data compression."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing the ZipFile.CreateFromDirectory .NET method",
  "ScreenshotDatasources": [],
  "Step": "17. Collection",
  "Substep": "17.C.1",
  "Subtechnique": "T1560.001",
  "Subtechnique_Name": "Archive Collected Data: Archive via Utility",
  "TacticGroup": "Collection",
  "Technique": "T1560",
  "Technique_Name": "Archive Collected Data"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell appending the GIF file header to the compressed file. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.",
    "An MSSP detection occurred contained evidence that WindowsParentalControlMigration.tmp was a zip archive that had its file header modified to begin with a GIF image header."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing Set-Content",
  "ScreenshotDatasources": [],
  "Step": "17. Collection",
  "Substep": "17.C.2",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1027",
  "Technique_Name": "Obfuscated Files or Information"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "General",
    "General",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Alert",
    "Alert",
    "Correlated",
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "A General alert detection (red indicator) called \"Non-browser access to a web service\" was generated when net.exe made an HTTPS connection to a OneDrive URL. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.",
    "A General alert detection (red indicator) called \"WebDAV drive mount from net.exe over HTTPS\" was generated when net.exe made an HTTPS connection. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.",
    "An MSSP detection contained evidence of net.exe connection to OneDrive over TCP port 443.",
    "Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "net.exe with command-line arguments then making a network connection to a public IP over port 443",
  "ScreenshotDatasources": [],
  "Step": "18. Exfiltration",
  "Substep": "18.A.1",
  "Subtechnique": "",
  "Subtechnique_Name": "",
  "TacticGroup": "Command and Control",
  "Technique": "T1102",
  "Technique_Name": "Web Service"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed the creation of the exfiltrated data within the mapped OneDrive directory. The detection was correlated to a parent alert for a suspicious Powershell process being spawned by explorer.exe.",
    "An MSSP detection contained evidence  WindowsParentalControlMigration.tmp file was written to the mapped OneDrive network share."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing Copy-Item pointing to drive mapped to an attack-controlled OneDrive account",
  "ScreenshotDatasources": [],
  "Step": "18. Exfiltration",
  "Substep": "18.A.2",
  "Subtechnique": "T1567.002",
  "Subtechnique_Name": "Exfiltration Over Web Service: Exfiltration to Cloud Storage",
  "TacticGroup": "Exfiltration",
  "Technique": "T1567",
  "Technique_Name": "Exfiltration Over Web Service"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed rundll32.exe executing kxwn.lock.",
    "An MSSP detection was generated containing evidence of rundll32.exe executing kxwn.lock."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "rundll32.exe executing kxwn.lock",
  "ScreenshotDatasources": [],
  "Step": "20. Persistence Execution",
  "Substep": "20.A.1",
  "Subtechnique": "T1218.011",
  "Subtechnique_Name": "Signed Binary Proxy Execution: Rundll32",
  "TacticGroup": "Execution",
  "Technique": "T1218",
  "Technique_Name": "Signed Binary Proxy Execution"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection (high severity) called was generated for PowerShell executing as part of a Windows Management Instrumentation Event Subscription.",
    "An MSSP detection was generated containing evidence of powershell.exe executing from Windows Management Instrumentation Event Subscription."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "The WMI process (wmiprvse.exe) executing powershell.exe",
  "ScreenshotDatasources": [],
  "Step": "20. Persistence Execution",
  "Substep": "20.A.2",
  "Subtechnique": "T1546.003",
  "Subtechnique_Name": "Event Triggered Execution: Windows Management Instrumentation Event Subscription",
  "TacticGroup": "Persistence",
  "Technique": "T1546",
  "Technique_Name": "Event Triggered Execution"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed a SYSTEM-level PowerShell spawning from a svchost.exe associated with the WMI service.",
    "An MSSP detection was generated containing evidence of powershell.exe executing another powershell.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "SYSTEM-level powershell.exe spawned from the powershell.exe",
  "ScreenshotDatasources": [],
  "Step": "20. Persistence Execution",
  "Substep": "20.A.3",
  "Subtechnique": "T1059.001",
  "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection was generated containing evidence of powershell.exe executing Invoke-Mimikatz (kerberos::golden) to create and inject ticket into current session."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "powershell.exe executing Invoke-Mimikatz with command-line arguments to create a golden ticket",
  "ScreenshotDatasources": [],
  "Step": "20. Persistence Execution",
  "Substep": "20.B.1",
  "Subtechnique": "T1550.003",
  "Subtechnique_Name": "Use Alternate Authentication Material: Pass the Ticket",
  "TacticGroup": "Lateral Movement",
  "Technique": "T1550",
  "Technique_Name": "Use Alternate Authentication Material"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell with an open network connection to the remote host Scranton (10.0.1.4) over port 5985. Telemetry also showed the WinRM process on Scranton (10.0.1.4) exchanging data with Utica (10.0.1.5).",
    "An MSSP detection contained evidence of a WinRM session to remote host SchruteFarms (10.0.1.7)."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "Network connection to Scranton (10.0.1.4) over port 5985",
  "ScreenshotDatasources": [],
  "Step": "20. Persistence Execution",
  "Substep": "20.B.2",
  "Subtechnique": "T1021.006",
  "Subtechnique_Name": "Remote Services: Windows Remote Management",
  "TacticGroup": "Lateral Movement",
  "Technique": "T1021",
  "Technique_Name": "Remote Services"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": "",
  "Datasources": [],
  "Detection": [
    "Technique",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection called \"created account T1136\" (high severity) was generated for net.exe with the command-line arguments to add the new user Toby.",
    "An MSSP detection contained evidence of the creation of the user Toby on Scranton (10.0.1.4).",
    "Telemetry showed wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby."
  ],
  "Footnotes": [],
  "Participant_Name": "Palo Alto Networks",
  "Procedure": "net.exe adding the user Toby",
  "ScreenshotDatasources": [],
  "Step": "20. Persistence Execution",
  "Substep": "20.B.3",
  "Subtechnique": "T1136.001",
  "Subtechnique_Name": "Create Account: Local Account",
  "TacticGroup": "Persistence",
  "Technique": "T1136",
  "Technique_Name": "Create Account"
}
