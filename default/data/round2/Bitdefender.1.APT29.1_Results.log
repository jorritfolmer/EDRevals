{
  "Detection": [
    "Technique"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detections)",
    "Alert"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) called \"RLOCharacterProcessCreate\" was generated due to a a file being executed with the RTLO character in its name, hiding its extension. "
  ],
  "Procedure": "Used unicode right-to-left override (RTLO) character to obfuscate file name rcs.3aka3.doc (originally cod.3aka.scr)",
  "Step": "1.A.2",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1036",
  "TechniqueName": "Masquerading"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed accesschk.exe is not a signed Microsoft binary which can be used to verify it is not the legitimate Sysinternals tool. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable."
  ],
  "Procedure": "Masqueraded a Chrome password dump tool as accesscheck.exe, a legitimate Sysinternals tool",
  "Step": "6.A.3",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1036",
  "TechniqueName": "Masquerading"
}
{
  "Detection": [
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detections)",
    "Alert",
    "Configuration Change (Detections)"
  ],
  "DetectionText": [
    "A Technique alert detection for \"powershellprocessdiscovery\" was generated due to powershell.exe executing Get-Process.",
    "Telemetry showed powershell.exe executing Get-Process."
  ],
  "Procedure": "Enumerated current running processes using PowerShell",
  "Step": "4.B.1",
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "TechniqueName": "Process Discovery"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "Enumerated the current process ID using PowerShell",
  "Step": "4.C.5",
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "TechniqueName": "Process Discovery"
}
{
  "Detection": [
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Configuration Change (Detections)",
    "Configuration Change (Detections)"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) was generated for the execution of a PowerShell process discovery command. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.",
    "Telemetry showed powershell.exe executing Get-Process."
  ],
  "Procedure": "Enumerated processes on remote host Scranton (10.0.1.4) using PowerShell",
  "Step": "8.A.3",
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "TechniqueName": "Process Discovery"
}
{
  "Detection": [
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) was generated for the execution of a process discovery command via Windows Management Instrumentation.",
    "Telemetry showed the PowerShell gwmi query for Win32_Process."
  ],
  "Procedure": "Checked that processes such as procexp.exe, taskmgr.exe, or wireshark.exe are not running using PowerShell",
  "Step": "11.A.8",
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "TechniqueName": "Process Discovery"
}
{
  "Detection": [
    "Technique",
    "Technique"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Configuration Change (Detections)",
    "Alert"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) called \"findprocess\" was generated due to PowerShell querying the list of running processes. The detection was correlated to a parent alert identifying the powershell.exe process as malware.",
    "A Technique alert detection was generated for the execution of a PowerShell process discovery command."
  ],
  "Procedure": "Enumerated running processes using the CreateToolhelp32Snapshot API",
  "Step": "13.D.1",
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "TechniqueName": "Process Discovery"
}
{
  "Detection": [
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Configuration Change (Detections)",
    "Configuration Change (Detections)"
  ],
  "DetectionText": [
    "A Technique alert was generated for the execution of a PowerShell process discovery command.",
    "Telemetry showed PowerShell executing Get-Process."
  ],
  "Procedure": "Enumerated and tracked PowerShell processes using PowerShell",
  "Step": "14.B.2",
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "TechniqueName": "Process Discovery"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Configuration Change (Detections)"
  ],
  "DetectionText": [
    "Telemetry showed accesschk.exe reading the Chrome database file for credentials. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable."
  ],
  "Procedure": "Read the Chrome SQL database file to extract encrypted credentials",
  "Step": "6.A.1",
  "TacticGroup": "Credential Access",
  "Technique": "T1081",
  "TechniqueName": "Credentials in Files"
}
{
  "Detection": [
    "Technique",
    "Technique",
    "Technique",
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Alert",
    "Correlated",
    "Alert",
    "Correlated",
    "Alert",
    "Correlated"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) was generated for a local process created using WMI. The detection was correlated to a parent alert identifying the powershell.exe process as malware.",
    "A Technique alert detection (red indicator) was generated for a WMI action using a custom provider. The detection was correlated to a parent alert identifying the powershell.exe process as malware.",
    "A Technique alert detection was generated for PowerShell executed using WMI. The alert was correlated to a parent alert identifying the powershell.exe process as malware.",
    "A Technique alert was generated for the creation of a new WMI class. The alert was correlated to a parent alert identifying the powershell.exe process as malware.",
    "Telemetry showed WmiPrvSE.exe executing powershell.exe."
  ],
  "Procedure": "Created and executed a WMI class using PowerShell",
  "Step": "14.B.1",
  "TacticGroup": "Execution",
  "Technique": "T1047",
  "TechniqueName": "Windows Management Instrumentation"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "Enumerated user's domain group membership via the NetUserGetGroups API",
  "Step": "4.C.9",
  "TacticGroup": "Discovery",
  "Technique": "T1069",
  "TechniqueName": "Permission Groups Discovery"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "Enumerated user's local group membership via\u00a0the NetUserGetLocalGroups API",
  "Step": "4.C.11",
  "TacticGroup": "Discovery",
  "Technique": "T1069",
  "TechniqueName": "Permission Groups Discovery"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed rcs.3aka3.doc creating monkey.png. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable."
  ],
  "Procedure": "Dropped stage 2 payload (monkey.png) to disk",
  "Step": "3.A.1",
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "TechniqueName": "Remote File Copy"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed the file write of the ZIP by PowerShell. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable."
  ],
  "Procedure": "Dropped additional tools (SysinternalsSuite.zip) to disk over C2 channel (192.168.0.5)",
  "Step": "4.A.1",
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "TechniqueName": "Remote File Copy"
}
{
  "Detection": [
    "Technique",
    "General",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Alert"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) was generated for a suspicious file being written/accesses through the SMB protocol. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.",
    "A General alert detection (red indicator) for Antimalware was generated identifying the resource download as malware.",
    "Telemetry showed the HTTP GET request for python.exe."
  ],
  "Procedure": "Copied python.exe payload from a WebDAV share (192.168.0.4) to remote host Scranton (10.0.1.4)",
  "Step": "8.B.1",
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "TechniqueName": "Remote File Copy"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed an executable file write event for python.exe creating rar.exe."
  ],
  "Procedure": "Dropped rar.exe to disk on remote host Scranton (10.0.1.4)\u00a0",
  "Step": "9.A.1",
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "TechniqueName": "Remote File Copy"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed Executable File Write event for python.exe creating sdelete64.exe."
  ],
  "Procedure": "Dropped sdelete.exe to disk on remote host Scranton (10.0.1.4)\u00a0",
  "Step": "9.A.2",
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "TechniqueName": "Remote File Copy"
}
{
  "Detection": [
    "Technique",
    "General",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Correlated"
  ],
  "DetectionText": [
    "A Technique detection was generated for a resource being downloaded via HTTP.",
    "A General alert detection (red indicator) was generated for powershell.exe writing a binary in a suspicious location. The detection was correlated to a parent alert identifying the powershell.exe process as malware.",
    "Telemetry showed a HTTP GET request over port 8080 to download m.exe. Telemetry also showed the file write event for m.exe into the System32 folder. The detection was correlated to a parent alert identifying the powershell.exe process as malware."
  ],
  "Procedure": "Downloaded and dropped Mimikatz (m.exe) to disk",
  "Step": "14.B.3",
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "TechniqueName": "Remote File Copy"
}
{
  "Detection": [
    "General",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "A General alert detection was generated for PowerShell writing a file to an uncommon location.",
    "Telemetry showed a file write event for m.exe (identified as Mimikatz by the file metadata) in the System32 directory."
  ],
  "Procedure": "Dropped Mimikatz (m.exe) to disk on the domain controller host NewYork (10.0.0.4) over a WinRM connection",
  "Step": "16.D.1",
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "TechniqueName": "Remote File Copy"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed cmd.exe spawning from rcs.3aka3.doc. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable."
  ],
  "Procedure": "Spawned interactive cmd.exe",
  "Step": "1.B.1",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "TechniqueName": "Command-Line Interface"
}
{
  "Detection": [
    "Technique"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "A Technique alert detection was generated for python.exe being identified as a packed payload. "
  ],
  "Procedure": "python.exe payload was packed with UPX",
  "Step": "8.B.2",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1045",
  "TechniqueName": "Software Packing"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "Enumerated the computer hostname using PowerShell",
  "Step": "4.C.3",
  "TacticGroup": "Discovery",
  "Technique": "T1082",
  "TechniqueName": "System Information Discovery"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "Enumerated the OS version using PowerShell",
  "Step": "4.C.6",
  "TacticGroup": "Discovery",
  "Technique": "T1082",
  "TechniqueName": "System Information Discovery"
}
{
  "Detection": [
    "Technique",
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert",
    "Configuration Change (Detections)",
    "Configuration Change (Detections)"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) was generated for execution of a WMI system discovery command.",
    "A Technique alert detection (red indicator) was generated for getting the BIOS version via Windows Management Instrumentation.",
    "Telemetry showed the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem."
  ],
  "Procedure": "Enumerated computer manufacturer, model, and version information using PowerShell",
  "Step": "11.A.4",
  "TacticGroup": "Discovery",
  "Technique": "T1082",
  "TechniqueName": "System Information Discovery"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "Enumerated the computer name using the GetComputerNameEx API",
  "Step": "13.A.1",
  "TacticGroup": "Discovery",
  "Technique": "T1082",
  "TechniqueName": "System Information Discovery"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detections)"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell calling the GetAsyncKeyState API."
  ],
  "Procedure": "Captured user keystrokes using the GetAsyncKeyState API",
  "Step": "7.A.3",
  "TacticGroup": "Collection",
  "Technique": "T1056",
  "TechniqueName": "Input Capture"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed the rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234."
  ],
  "Procedure": "Established C2 channel (192.168.0.5) via rcs.3aka3.doc payload over TCP port 1234",
  "Step": "1.A.3",
  "TacticGroup": "Command and Control",
  "Technique": "T1065",
  "TechniqueName": "Uncommonly Used Port"
}
{
  "Detection": [
    "Technique",
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert"
  ],
  "DetectionText": [
    "A Technique alert detection was generated for local account creation using net.exe. ",
    "A Technique alert was generated for the net.exe process being used to create a new user. ",
    "Telemetry showed wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby."
  ],
  "Procedure": "Added a new user to the remote host Scranton (10.0.1.4) using net.exe",
  "Step": "20.B.3",
  "TacticGroup": "Persistence",
  "Technique": "T1136",
  "TechniqueName": "Create Account"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed file creation of Draft.zip. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable."
  ],
  "Procedure": "Staged files for exfiltration into ZIP (Draft.zip) using PowerShell",
  "Step": "2.A.5",
  "TacticGroup": "Collection",
  "Technique": "T1074",
  "TechniqueName": "Data Staged"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed the file write of working.zip."
  ],
  "Procedure": "Staged files for exfiltration into ZIP (working.zip in AppData directory) using PowerShell",
  "Step": "9.B.5",
  "TacticGroup": "Collection",
  "Technique": "T1074",
  "TechniqueName": "Data Staged"
}
{
  "Detection": [
    "General",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "A General alert detection called \"PowerShell Suspicious Write\" was generated due to a PowerShell file write to an uncommon location.",
    "Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML."
  ],
  "Procedure": "Staged collected file into directory using PowerShell",
  "Step": "17.B.2",
  "TacticGroup": "Collection",
  "Technique": "T1074",
  "TechniqueName": "Data Staged"
}
{
  "Detection": [
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Alert",
    "Correlated"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) called Startup Item was generated due to hostui.lnk being written to the Startup folder. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.",
    "Telemetry showed the file write of hostui.lnk in the Startup folder. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable."
  ],
  "Procedure": "Created a LNK file (hostui.lnk) in the Startup folder that executes on login",
  "Step": "5.B.1",
  "TacticGroup": "Persistence",
  "Technique": "T1060",
  "TechniqueName": "Registry Run Keys / Startup Folder"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "Executed LNK payload (hostui.lnk) in Startup Folder on user login",
  "Step": "10.B.1",
  "TacticGroup": "Persistence",
  "Technique": "T1060",
  "TechniqueName": "Registry Run Keys / Startup Folder"
}
{
  "Detection": [
    "Technique",
    "Technique",
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) called \"RegSigStartup\" was generated for Registry Run Keys / Startup Folder persistence.",
    "A Technique alert detection (red indicator) was generated for a suspicious process writing a Startup item Registry key.",
    "A Technique detection was generated showing Registry write event of the Webcache subkey by powershell.exe, identified as a Startup or Autorun.",
    "Telemetry showed powershell.exe adding Run key persistence into the Registry."
  ],
  "Procedure": "Established Registry Run key persistence using PowerShell",
  "Step": "11.A.11",
  "TacticGroup": "Persistence",
  "Technique": "T1060",
  "TechniqueName": "Registry Run Keys / Startup Folder"
}
{
  "Detection": [
    "General",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Correlated"
  ],
  "DetectionText": [
    "A General alert detection (yellow indicator) was generated for powershell.exe being identified as suspicious. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.",
    "Telemetry showed powershell.exe spawning from cmd.exe. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable."
  ],
  "Procedure": "Spawned interactive powershell.exe",
  "Step": "1.B.2",
  "TacticGroup": "Execution",
  "Technique": "T1086",
  "TechniqueName": "PowerShell"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed a new powershell.exe spawning from powershell.exe.  The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable."
  ],
  "Procedure": "Spawned interactive powershell.exe",
  "Step": "4.A.2",
  "TacticGroup": "Execution",
  "Technique": "T1086",
  "TechniqueName": "PowerShell"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetery showed python.exe executing powershell.exe."
  ],
  "Procedure": "Spawned interactive powershell.exe",
  "Step": "9.B.1",
  "TacticGroup": "Execution",
  "Technique": "T1086",
  "TechniqueName": "PowerShell"
}
{
  "Detection": [
    "Technique",
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) was generated for powershell.exe executed with a suspicious large command line, which led to the powershell.exe process being identified as malware.",
    "A Technique alert detection (red indicator) was generated for powershell.exe launched with the encoded command parameter.",
    "Telemetry showed powershell.exe spawned from a PowerShell stager."
  ],
  "Procedure": "Executed PowerShell stager payload",
  "Step": "11.A.12",
  "TacticGroup": "Execution",
  "Technique": "T1086",
  "TechniqueName": "PowerShell"
}
{
  "Detection": [
    "Technique",
    "General",
    "General"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert",
    "Alert"
  ],
  "DetectionText": [
    "A Technique alert detection was generated for powershell.exe launched with the encoded command parameter.",
    "A General alert detection (red indicator) was generated for powershell.exe due to \"Suspicious Large Command Line\".",
    "A General alert detection (red indicator) was generated for the execution of a suspicious user process."
  ],
  "Procedure": "Executed PowerShell payload from WMI event subscription persistence",
  "Step": "20.A.3",
  "TacticGroup": "Execution",
  "Technique": "T1086",
  "TechniqueName": "PowerShell"
}
{
  "Detection": [
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated"
  ],
  "DetectionText": [
    "A Technique alert detection (yellow indicator) called \"ClipboardAction\" was generated due to a process collecting Windows clipboard data. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.",
    "Telemetry showed powershell.exe executing Get-Clipboard."
  ],
  "Procedure": "Captured clipboard contents using PowerShell",
  "Step": "7.A.2",
  "TacticGroup": "Collection",
  "Technique": "T1115",
  "TechniqueName": "Clipboard Data"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detections)"
  ],
  "DetectionText": [
    "Telemetry showed an SSL network connection to 192.168.0.5 on port 443."
  ],
  "Procedure": "Used HTTPS to transport\u00a0C2 (192.168.0.5) traffic",
  "Step": "3.B.4",
  "TacticGroup": "Command and Control",
  "Technique": "T1071",
  "TechniqueName": "Standard Application Layer Protocol"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detections)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe making an network connection to C2 (192.168.0.4) over port 443, which was identified as using the SSL protocol."
  ],
  "Procedure": "Used HTTPS to transport\u00a0C2 (192.168.0.4) traffic",
  "Step": "11.A.14",
  "TacticGroup": "Command and Control",
  "Technique": "T1071",
  "TechniqueName": "Standard Application Layer Protocol"
}
{
  "Detection": [
    "Technique",
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detections)",
    "Alert",
    "Alert",
    "Correlated"
  ],
  "DetectionText": [
    "A Technique alert detection called \"powershellinvokedwinrm\" was generated for Windows Remote Management Service Invoked by PowerShell script.",
    "A Technique alert detection called \"remotepowershellsession\" was generated for WSMProvHost Process Started that could indicate a remote PowerShell command has been executed.",
    "Telemetry showed a connection to Scranton (10.0.1.4) over port 5985. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable."
  ],
  "Procedure": "Established WinRM connection to remote host Scranton (10.0.1.4)",
  "Step": "8.A.2",
  "TacticGroup": "Execution",
  "Technique": "T1028",
  "TechniqueName": "Windows Remote Management"
}
{
  "Detection": [
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) was generated on NewYork (10.0.0.4) for a remote PowerShell session based on the identification of the WinRM process (wsmprovhost.exe).",
    "Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985. The detection was correlated to a parent alert identifying the powershell.exe process as malware."
  ],
  "Procedure": "Established a WinRM connection to the domain controller host NewYork (10.0.0.4) ",
  "Step": "16.C.1",
  "TacticGroup": "Execution",
  "Technique": "T1028",
  "TechniqueName": "Windows Remote Management"
}
{
  "Detection": [
    "Technique",
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert"
  ],
  "DetectionText": [
    "A Technique alert detection was generated for the opening of a WinRM connection. The alert showed an outbound network connection to remote host Scranton (10.0.1.4) over port 5985.",
    "A Technique alert detection was generated for the WSMProvHost process on the remote host Scranton (10.0.1.4), which is indicative of the execution of a remote PowerShell command.",
    "Telemetry showed PowerShell with an open network connection to remote host Scranton (10.0.1.4) over port 5985."
  ],
  "Procedure": "Established a WinRM connection to the remote host Scranton (10.0.1.4) using the Golden Ticket as credentials",
  "Step": "20.B.2",
  "TacticGroup": "Execution",
  "Technique": "T1028",
  "TechniqueName": "Windows Remote Management"
}
{
  "Detection": [
    "General",
    "General",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert"
  ],
  "DetectionText": [
    "A General alert detection (high severity) for Antimalware was generated for explorer.exe executing rcs.3aka3.doc.",
    "A General alert detection (low severity) was generated for the execution of a rogue unusual executable.",
    "Telemetry showed explorer.exe executing rcs.3aka3.doc. "
  ],
  "Procedure": "User Pam executed payload rcs.3aka3.doc",
  "Step": "1.A.1",
  "TacticGroup": "Execution",
  "Technique": "T1204",
  "TechniqueName": "User Execution"
}
{
  "Detection": [
    "General",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "A General alert detection (red indicator) was generated identifying the powershell.exe process as malware.",
    "Telemetry showed explorer.exe spawning powershell.exe."
  ],
  "Procedure": "User Oscar executed payload 37486-the-shocking-truth-about-election-rigging-in-america.rtf.lnk",
  "Step": "11.A.1",
  "TacticGroup": "Execution",
  "Technique": "T1204",
  "TechniqueName": "User Execution"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detections)"
  ],
  "DetectionText": [
    "Telemetry showed script block with registry query for installed software."
  ],
  "Procedure": "Enumerated installed software via the Registry (Wow6432 Uninstall key) using PowerShell",
  "Step": "12.C.1",
  "TacticGroup": "Discovery",
  "Technique": "T1012",
  "TechniqueName": "Query Registry"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detections)"
  ],
  "DetectionText": [
    "Telemetry showed scriptblock with registry query for installed software."
  ],
  "Procedure": "Enumerated installed software via the Registry (Uninstall key) using PowerShell",
  "Step": "12.C.2",
  "TacticGroup": "Discovery",
  "Technique": "T1012",
  "TechniqueName": "Query Registry"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detections)",
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed file reads of C:\\Users\\Pam\\*. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable."
  ],
  "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell",
  "Step": "2.A.3",
  "TacticGroup": "Collection",
  "Technique": "T1005",
  "TechniqueName": "Data from Local System"
}
{
  "Detection": [
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "A Technique alert detection called PowerShell Read Document was generated for powershell.exe process reading file contents. ",
    "Telemetry showed Powershell.exe reading files from C:\\Users\\pam\\Downloads."
  ],
  "Procedure": "Read data in the user's Downloads directory using PowerShell",
  "Step": "7.B.1",
  "TacticGroup": "Collection",
  "Technique": "T1005",
  "TechniqueName": "Data from Local System"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell",
  "Step": "9.B.4",
  "TacticGroup": "Collection",
  "Technique": "T1005",
  "TechniqueName": "Data from Local System"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "Read and collected a local file using PowerShell",
  "Step": "17.B.1",
  "TacticGroup": "Collection",
  "Technique": "T1005",
  "TechniqueName": "Data from Local System"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detections)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing ChildItem."
  ],
  "Procedure": "Scripted search of filesystem for document and media files using PowerShell\u00a0",
  "Step": "2.A.2",
  "TacticGroup": "Collection",
  "Technique": "T1119",
  "TechniqueName": "Automated Collection"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detections)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing ChildItem\u200b."
  ],
  "Procedure": "Scripted search of filesystem for document and media files using PowerShell\u00a0",
  "Step": "9.B.3",
  "TacticGroup": "Collection",
  "Technique": "T1119",
  "TechniqueName": "Automated Collection"
}
{
  "Detection": [
    "General"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detections)",
    "Alert",
    "Correlated"
  ],
  "DetectionText": [
    "A General alert detection (red indicator) was generated for PowerShell loading the NetApi module. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable."
  ],
  "Procedure": "Executed API call by reflectively loading Netapi32.dll",
  "Step": "4.C.10",
  "TacticGroup": "Execution",
  "Technique": "T1106",
  "TechniqueName": "Execution through API"
}
{
  "Detection": [
    "General"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Alert",
    "Configuration Change (Detections)"
  ],
  "DetectionText": [
    "A General alert detection (red indicator) was generated for PowerShell loading the NetApi module. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable."
  ],
  "Procedure": "Executed API call by reflectively loading Netapi32.dll",
  "Step": "4.C.12",
  "TacticGroup": "Execution",
  "Technique": "T1106",
  "TechniqueName": "Execution through API"
}
{
  "Detection": [
    "Technique"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) was generated for a process created with CreateProcessWithToken."
  ],
  "Procedure": "Executed PowerShell payload via the CreateProcessWithToken API",
  "Step": "10.B.2",
  "TacticGroup": "Execution",
  "Technique": "T1106",
  "TechniqueName": "Execution through API"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detections)"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell reflectively loading Advapi32.dll inorder to execute the ConvertSidToStringSid API function."
  ],
  "Procedure": "Executed the ConvertSidToStringSid API call by reflectively loading Advapi32.dll",
  "Step": "16.B.2",
  "TacticGroup": "Execution",
  "Technique": "T1106",
  "TechniqueName": "Execution through API"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "Used RC4 stream cipher to encrypt C2 (192.168.0.5) traffic",
  "Step": "1.A.4",
  "TacticGroup": "Command and Control",
  "Technique": "T1032",
  "TechniqueName": "Standard Cryptographic Protocol"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detections)"
  ],
  "DetectionText": [
    "Telemetry showed a SSL connection to to 192.168.0.5 on port 443."
  ],
  "Procedure": "Used HTTPS to encrypt C2 (192.168.0.5) traffic",
  "Step": "3.B.5",
  "TacticGroup": "Command and Control",
  "Technique": "T1032",
  "TechniqueName": "Standard Cryptographic Protocol"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detections)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe making an network connection to C2 (192.168.0.4) over port 443, which was identified as using the SSL protocol."
  ],
  "Procedure": "Used HTTPS to encrypt C2 (192.168.0.4) traffic",
  "Step": "11.A.15",
  "TacticGroup": "Command and Control",
  "Technique": "T1032",
  "TechniqueName": "Standard Cryptographic Protocol"
}
{
  "Detection": [
    "General",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Correlated"
  ],
  "DetectionText": [
    "A General alert detection (orange indicator) was generated for an attempt to connect to a remote share via net.exe. The detection was correlated to a parent alert identifying the powershell.exe process as malware.",
    "Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. The detection was correlated to a parent alert identifying the powershell.exe process as malware."
  ],
  "Procedure": "Mapped a network drive to an online OneDrive account using PowerShell",
  "Step": "18.A.1",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1102",
  "TechniqueName": "Web Service"
}
{
  "Detection": [
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detections)",
    "Alert",
    "Configuration Change (Detections)"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) was generated for getting the plug and play devices via Windows Management Instrumentation.",
    "Telemetry showed the PowerShell gwmi query for Win32_PnPEntity."
  ],
  "Procedure": "Enumerated devices/adapters to check for presence of VirtualBox driver(s) using PowerShell",
  "Step": "11.A.5",
  "TacticGroup": "Discovery",
  "Technique": "T1120",
  "TechniqueName": "Peripheral Device Discovery"
}
{
  "Detection": [
    "General",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Correlated"
  ],
  "DetectionText": [
    "A General alert detection (red indicator) was generated for PowerShell writing unknown executable files. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.",
    "Telemetry showed PowerShell writing the files that were decompressed from the ZIP. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable."
  ],
  "Procedure": "Decompressed ZIP (SysinternalsSuite.zip) file using PowerShell",
  "Step": "4.A.3",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1140",
  "TechniqueName": "Deobfuscate/Decode Files or Information"
}
{
  "Detection": [
    "Technique",
    "General",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert"
  ],
  "DetectionText": [
    "A Technique alert detection (yellow indicator) was generated for cerutil.exe decoding a payload. ",
    "A General alert detection (yellow indicator) was generated for the execution of the certutil.exe process, which was identified as suspicious.",
    "Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload."
  ],
  "Procedure": "Decoded an embedded DLL payload to disk using certutil.exe",
  "Step": "11.A.10",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1140",
  "TechniqueName": "Deobfuscate/Decode Files or Information"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detections)"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell reading encoded content from the WMI class. "
  ],
  "Procedure": "Read and decoded Mimikatz output from a WMI class property using PowerShell",
  "Step": "14.B.6",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1140",
  "TechniqueName": "Deobfuscate/Decode Files or Information"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX."
  ],
  "Procedure": "Executed an alternate data stream (ADS) using PowerShell",
  "Step": "11.A.2",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1096",
  "TechniqueName": "NTFS File Attributes"
}
{
  "Detection": [
    "General",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated"
  ],
  "DetectionText": [
    "A General alert detection called \"PSExecLateralMovement\" was generated for unusual markers of PSExec being used for lateral movement.",
    "Telemetry showed PSEXESVC.exe with command-line arguments to execute python.exe. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable."
  ],
  "Procedure": "Executed python.exe using PSExec",
  "Step": "8.C.3",
  "TacticGroup": "Execution",
  "Technique": "T1035",
  "TechniqueName": "Service Execution"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "Executed persistent service (javamtsup) on system startup",
  "Step": "10.A.1",
  "TacticGroup": "Execution",
  "Technique": "T1035",
  "TechniqueName": "Service Execution"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "Encrypted data from the user's Downloads directory using PowerShell",
  "Step": "7.B.3",
  "TacticGroup": "Exfiltration",
  "Technique": "T1022",
  "TechniqueName": "Data Encrypted"
}
{
  "Detection": [
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "A Technique alert detection called \"Data Encrypted T1022\" was generated due to powershell.exe executing rar.exe with command-line arguments indicative of encryption.",
    "Telemetry showed powershell.exe executing rar.exe with command-line arguments. "
  ],
  "Procedure": "Encrypted staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe",
  "Step": "9.B.6",
  "TacticGroup": "Exfiltration",
  "Technique": "T1022",
  "TechniqueName": "Data Encrypted"
}
{
  "Detection": [
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "A Technique alert detection was generated for \"rundll32uncommonload\" due to rundll32.exe executing kxwn.lock.",
    "Telemetry showed rundll32.exe executing kxwn.lock."
  ],
  "Procedure": "Executed Run key persistence payload on user login using RunDll32",
  "Step": "20.A.1",
  "TacticGroup": "Execution",
  "Technique": "T1085",
  "TechniqueName": "Rundll32"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detections)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe establishing a connection identified as LDAP over port 389 to NewYork (10.0.0.4)."
  ],
  "Procedure": "Enumerated remote systems using LDAP queries",
  "Step": "8.A.1",
  "TacticGroup": "Discovery",
  "Technique": "T1018",
  "TechniqueName": "Remote System Discovery"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "Enumerated the domain controller host NewYork (10.0.0.4) using LDAP queries",
  "Step": "16.A.1",
  "TacticGroup": "Discovery",
  "Technique": "T1018",
  "TechniqueName": "Remote System Discovery"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detections)"
  ],
  "DetectionText": [
    "Telemetry showed the deletion of the command subkey."
  ],
  "Procedure": "Modified the Registry to remove artifacts of COM hijacking",
  "Step": "3.C.1",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1112",
  "TechniqueName": "Modify Registry"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed the deletion of the Registry value. "
  ],
  "Procedure": "Modified the Registry to remove artifacts of COM hijacking using PowerShell",
  "Step": "14.A.3",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1112",
  "TechniqueName": "Modify Registry"
}
{
  "Detection": [
    "Technique",
    "General",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detections)",
    "Alert",
    "Alert",
    "Configuration Change (Detections)"
  ],
  "DetectionText": [
    "A Technique alert detection was generated for a compressed file being transferred over the network.",
    "A General alert detection was generated for a network connection to remote WebDav network share.",
    "Telemetry showed an event for PowerShell reading OfficeSupplies.7z as well as an active connection to a remote adversary WebDav network share (192.168.0.4)."
  ],
  "Procedure": "Exfiltrated collection (OfficeSupplies.7z) to WebDAV network share using PowerShell",
  "Step": "7.B.4",
  "TacticGroup": "Exfiltration",
  "Technique": "T1048",
  "TechniqueName": "Exfiltration Over Alternative Protocol"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detections)"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell executing Copy-Item to exfiltrate data to a previously mapped OneDrive account."
  ],
  "Procedure": "Exfiltrated staged collection to an online OneDrive account using PowerShell",
  "Step": "18.A.2",
  "TacticGroup": "Exfiltration",
  "Technique": "T1048",
  "TechniqueName": "Exfiltration Over Alternative Protocol"
}
{
  "Detection": [
    "N/A"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Due to execution inconsistencies Step 19 has been omitted from the evaluation results."
  ],
  "Procedure": "Reflectively injected SDelete binary into PowerShell",
  "Step": "19.A.2",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1055",
  "TechniqueName": "Process Injection"
}
{
  "Detection": [
    "N/A"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Due to execution inconsistencies Step 19 has been omitted from the evaluation results."
  ],
  "Procedure": "Reflectively injected SDelete binary into PowerShell",
  "Step": "19.B.2",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1055",
  "TechniqueName": "Process Injection"
}
{
  "Detection": [
    "N/A"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Due to execution inconsistencies Step 19 has been omitted from the evaluation results."
  ],
  "Procedure": "Reflectively injected SDelete binary into PowerShell",
  "Step": "19.C.2",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1055",
  "TechniqueName": "Process Injection"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "Executed the CryptUnprotectedData API call to decrypt Chrome passwords",
  "Step": "6.A.2",
  "TacticGroup": "Credential Access",
  "Technique": "T1003",
  "TechniqueName": "Credential Dumping"
}
{
  "Detection": [
    "Technique",
    "General"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert",
    "Correlated"
  ],
  "DetectionText": [
    "A Technique alert detection for Credential Dumping was generated for injection into Lsass.exe.",
    "A General alert detection (yellow indicator) was generated due to process injection into lsass.exe. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable."
  ],
  "Procedure": "Dumped password hashes from the Windows Registry by injecting a malicious DLL into Lsass.exe",
  "Step": "6.C.1",
  "TacticGroup": "Credential Access",
  "Technique": "T1003",
  "TechniqueName": "Credential Dumping"
}
{
  "Detection": [
    "Technique",
    "General",
    "General"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Alert",
    "Correlated",
    "Alert",
    "Correlated"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) was generated for a process memory read. The detection was correlated to a parent alert identifying the powershell.exe process as malware.",
    "A General alert detection (red indicator) was generated for m.exe loading a credential related DLL, identified as a possible attempt to dump credentials. The detection was correlated to a parent alert identifying the powershell.exe process as malware.",
    "A General alert detection (red indicator) was generated identifying powershell.exe executing m.exe as Mimikatz malware. The detection was correlated to a parent alert identifying the powershell.exe process as malware."
  ],
  "Procedure": "Dumped plaintext credentials using Mimikatz (m.exe)",
  "Step": "14.B.4",
  "TacticGroup": "Credential Access",
  "Technique": "T1003",
  "TechniqueName": "Credential Dumping"
}
{
  "Detection": [
    "Technique",
    "Technique",
    "General",
    "General",
    "General"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Alert",
    "Alert",
    "Correlated",
    "Alert",
    "Alert",
    "Correlated"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) called  \"ReadProcessMemoryCritical\" was generated for m.exe reading memory from a critical process. The alert was correlated to a parent alert identifying a remote PowerShell session to NewYork (10.0.0.4).",
    "A Technique alert detection was generated for injection into the lsass.exe process.",
    "A General alert detection (red indicator) was generated for a m.exe (Mimikatz) loading a credentials-related DLL (samlib.dll), identified as a possible attempt to dump credentials. The detection was correlated to a parent alert identifying a remote PowerShell session to NewYork (10.0.0.4).",
    "A General alert detection (red indicator) was generated for injection into a critical system process.",
    "A General alert detection (red indicator) was generated identifying m.exe as the Mimikatz malware. The detection was correlated to a parent alert identifying a remote PowerShell session to NewYork (10.0.0.4)."
  ],
  "Procedure": "Dumped the KRBTGT hash on the domain controller host NewYork (10.0.0.4) using Mimikatz (m.exe)",
  "Step": "16.D.2",
  "TacticGroup": "Credential Access",
  "Technique": "T1003",
  "TechniqueName": "Credential Dumping"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detections)"
  ],
  "DetectionText": [
    "Telemetry showed script block with commands to timestomp kxwn.lock."
  ],
  "Procedure": "Modified the time attributes of the kxwn.lock persistence payload using PowerShell",
  "Step": "12.A.2",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1099",
  "TechniqueName": "Timestomp"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "Logged on to remote host Scranton (10.0.1.4) using\u00a0valid credentials for user Pam",
  "Step": "8.C.1",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1078",
  "TechniqueName": "Valid Accounts"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "Logged on to the domain controller host NewYork (10.0.0.4) using\u00a0valid credentials for user MScott\u00a0",
  "Step": "16.C.2",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1078",
  "TechniqueName": "Valid Accounts"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "Enumerated the current username using PowerShell",
  "Step": "4.C.2",
  "TacticGroup": "Discovery",
  "Technique": "T1033",
  "TechniqueName": "System Owner/User Discovery"
}
{
  "Detection": [
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) was generated for the execution of a WMI system discovery command.",
    "Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem."
  ],
  "Procedure": "Checked that the username is not related to admin or a generic value (ex: user) using PowerShell",
  "Step": "11.A.6",
  "TacticGroup": "Discovery",
  "Technique": "T1033",
  "TechniqueName": "System Owner/User Discovery"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "Enumerated the current username using the GetUserNameEx API",
  "Step": "13.C.1",
  "TacticGroup": "Discovery",
  "Technique": "T1033",
  "TechniqueName": "System Owner/User Discovery"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "Enumerated logged on users using PowerShell",
  "Step": "15.A.1",
  "TacticGroup": "Discovery",
  "Technique": "T1033",
  "TechniqueName": "System Owner/User Discovery"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detections)"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell executing the ConvertSidToStringSid API function."
  ],
  "Procedure": "Enumerated the domain SID (from current user SID) using\u00a0the ConvertSidToStringSid API",
  "Step": "16.B.1",
  "TacticGroup": "Discovery",
  "Technique": "T1033",
  "TechniqueName": "System Owner/User Discovery"
}
{
  "Detection": [
    "Technique",
    "General",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Alert",
    "Alert",
    "Correlated"
  ],
  "DetectionText": [
    "A Technique alert detection (yellow indicator) for Bypass User Account Control was generated for sdclt.exe being executed with a higher integrity level than its parent process. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.",
    "A General alert detection (red indicator) was generated for powershell.exe being identified as suspicious. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.",
    "Telemetry showed control.exe spawning a powershell.exe tagged as High Integrity level and possessing elevated process access privileges."
  ],
  "Procedure": "Executed elevated PowerShell payload",
  "Step": "3.B.2",
  "TacticGroup": "Privilege Escalation",
  "Technique": "T1088",
  "TechniqueName": "Bypass User Account Control"
}
{
  "Detection": [
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "A Technique alert detection for \"Bypass User Account Control\" was generated for a suspicious process elevation.",
    "Telemetry showed control.exe spawning a powershell.exe tagged as High Integrity level and possessing elevated process access privileges."
  ],
  "Procedure": "Executed elevated PowerShell payload",
  "Step": "14.A.2",
  "TacticGroup": "Privilege Escalation",
  "Technique": "T1088",
  "TechniqueName": "Bypass User Account Control"
}
{
  "Detection": [
    "General",
    "General",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Alert",
    "Correlated",
    "Correlated"
  ],
  "DetectionText": [
    "A General alert detection was generated for an unusual file write in the user directory. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.",
    "A General alert detection was generated for the SDelete process being identified as suspicious. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.",
    "Telemetry showed sdelete.exe running with command-line arguments to delete the file and subsequently writing to the file. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable."
  ],
  "Procedure": "Deleted rcs.3aka3.doc on disk using SDelete",
  "Step": "4.B.2",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1107",
  "TechniqueName": "File Deletion"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable."
  ],
  "Procedure": "Deleted Draft.zip on disk using SDelete",
  "Step": "4.B.3",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1107",
  "TechniqueName": "File Deletion"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable."
  ],
  "Procedure": "Deleted SysinternalsSuite.zip on disk using SDelete",
  "Step": "4.B.4",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1107",
  "TechniqueName": "File Deletion"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe."
  ],
  "Procedure": "Deleted rar.exe on disk using SDelete",
  "Step": "9.C.1",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1107",
  "TechniqueName": "File Deletion"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed sdelete64.exe with command-line arguments to delete Desktop\\working.zip. "
  ],
  "Procedure": "Deleted working.zip (from Desktop) on disk using SDelete",
  "Step": "9.C.2",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1107",
  "TechniqueName": "File Deletion"
}
{
  "Detection": [
    "General",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "A General alert detection called \"Unusual File Written in User Directory\" was generated when sdelete64.exe with command-line arguments was used to delete Roaming\\working.zip",
    "Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip."
  ],
  "Procedure": "Deleted working.zip (from AppData directory) on disk using SDelete",
  "Step": "9.C.3",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1107",
  "TechniqueName": "File Deletion"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "Deleted SDelete on disk using cmd.exe del command",
  "Step": "9.C.4",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1107",
  "TechniqueName": "File Deletion"
}
{
  "Detection": [
    "N/A"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Due to execution inconsistencies Step 19 has been omitted from the evaluation results."
  ],
  "Procedure": "Deleted Mimikatz (m.exe) on disk using SDelete",
  "Step": "19.A.1",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1107",
  "TechniqueName": "File Deletion"
}
{
  "Detection": [
    "N/A"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Due to execution inconsistencies Step 19 has been omitted from the evaluation results."
  ],
  "Procedure": "Deleted exfiltrated data on disk using SDelete",
  "Step": "19.B.1",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1107",
  "TechniqueName": "File Deletion"
}
{
  "Detection": [
    "N/A"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Due to execution inconsistencies Step 19 has been omitted from the evaluation results."
  ],
  "Procedure": "Deleted staged data on disk using SDelete",
  "Step": "19.C.1",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1107",
  "TechniqueName": "File Deletion"
}
{
  "Detection": [
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detections)",
    "Alert",
    "Correlated",
    "Configuration Change (Detections)"
  ],
  "DetectionText": [
    "A Technique alert detection (orange indicator) was generated for PowerShell being used to take a screenshot. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.",
    "Telemetry showed powershell.exe executing CopyFromScreen from System.Drawing.dll."
  ],
  "Procedure": "Captured and saved screenshots using PowerShell",
  "Step": "7.A.1",
  "TacticGroup": "Collection",
  "Technique": "T1113",
  "TechniqueName": "Screen Capture"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails."
  ],
  "Procedure": "Dumped messages from the local Outlook inbox using PowerShell",
  "Step": "17.A.1",
  "TacticGroup": "Collection",
  "Technique": "T1114",
  "TechniqueName": "Email Collection"
}
{
  "Detection": [
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "A Technique detection called \"PowershellImgObfuscation\" was generated due to a payload being loaded from an image via PowerShell.",
    "Telemetry showed PowerShell extracting and executing the code embedded within monkey.png."
  ],
  "Procedure": "Embedded PowerShell payload in monkey.png using steganography",
  "Step": "3.A.2",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1027",
  "TechniqueName": "Obfuscated Files or Information"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "Encoded and wrote Mimikatz output to a WMI class property using PowerShell",
  "Step": "14.B.5",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1027",
  "TechniqueName": "Obfuscated Files or Information"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detections)"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell appending the GIF file header to the compressed file."
  ],
  "Procedure": "Prepended the GIF file header to a compressed staging file using PowerShell",
  "Step": "17.C.2",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1027",
  "TechniqueName": "Obfuscated Files or Information"
}
{
  "Detection": [
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated"
  ],
  "DetectionText": [
    "A Technique alert detection called \"privatekeyread\" was generated due to the $RandomFileName.pfx file being accessed by an uncommon process.",
    "Telemetry showed file write event for a $RandomFileName.pfx file by powershell.exe. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable."
  ],
  "Procedure": "Exported a local certificate to a PFX file using PowerShell",
  "Step": "6.B.1",
  "TacticGroup": "Credential Access",
  "Technique": "T1145",
  "TechniqueName": "Private Keys"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe connecting to 192.168.0.5 on port 443. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable."
  ],
  "Procedure": "Established C2 channel (192.168.0.5) via PowerShell payload over TCP port 443",
  "Step": "3.B.3",
  "TacticGroup": "Command and Control",
  "Technique": "T1043",
  "TechniqueName": "Commonly Used Port"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443."
  ],
  "Procedure": "Established C2 channel (192.168.0.4) via PowerShell payload over port 443",
  "Step": "11.A.13",
  "TacticGroup": "Command and Control",
  "Technique": "T1043",
  "TechniqueName": "Commonly Used Port"
}
{
  "Detection": [
    "Technique",
    "Technique",
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Alert",
    "Correlated",
    "Alert",
    "Correlated"
  ],
  "DetectionText": [
    "A Technique alert detection was generated due to the creation of a new WMI consumer. The detection was correlated to a parent alert identifying the powershell.exe process as malware.",
    "A Technique alert detection was generated due to the creation of a new WMI filter. The detection was correlated to a parent alert identifying the powershell.exe process as malware.",
    "A Technique alert detection was generated due to the creation of a new WMI subscription. The detection was correlated to a parent alert identifying the powershell.exe process as malware.",
    "Telemetry showed the creation of the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription."
  ],
  "Procedure": "Established WMI event subscription persistence using PowerShell",
  "Step": "15.A.2",
  "TacticGroup": "Persistence",
  "Technique": "T1084",
  "TechniqueName": "Windows Management Instrumentation Event Subscription"
}
{
  "Detection": [
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detections)",
    "Alert"
  ],
  "DetectionText": [
    "A Technique alert detection called \"executepowershellthroughwmi\" was generated due to PowerShell being executed by WMI.",
    "Telemetry showed wmiprvse.exe executing the PowerShell stager."
  ],
  "Procedure": "Executed WMI persistence on user login",
  "Step": "20.A.2",
  "TacticGroup": "Persistence",
  "Technique": "T1084",
  "TechniqueName": "Windows Management Instrumentation Event Subscription"
}
{
  "Detection": [
    "Technique",
    "Technique"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert"
  ],
  "DetectionText": [
    "A Technique alert detection (orange indicator) was generated for PowerShell being identified as having fake parent process.",
    "A Technique alert detection (red indicator) was generated for a process created with CreateProcessWithToken."
  ],
  "Procedure": "Manipulated the token of the PowerShell payload via the CreateProcessWithToken API",
  "Step": "10.B.3",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1134",
  "TechniqueName": "Access Token Manipulation"
}
{
  "Detection": [
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detections)",
    "Alert",
    "Correlated",
    "Configuration Change (Detections)"
  ],
  "DetectionText": [
    "A Technique alert detection (yellow indicator) was generated for PowerShell enumerating files and directories using environment variables. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.",
    "Telemetry showed powershell.exe executing ChildItem."
  ],
  "Procedure": "Searched filesystem for document and media files using PowerShell\u00a0",
  "Step": "2.A.1",
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "TechniqueName": "File and Directory Discovery"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "Enumerated user's temporary directory path using PowerShell",
  "Step": "4.C.1",
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "TechniqueName": "File and Directory Discovery"
}
{
  "Detection": [
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detections)",
    "Alert",
    "Configuration Change (Detections)"
  ],
  "DetectionText": [
    "A Technique alert detection was generated for PowerShell enumerating files and directories using environment variables.",
    "Telemetry showed powershell.exe executing ChildItem."
  ],
  "Procedure": "Searched filesystem for document and media files using PowerShell",
  "Step": "9.B.2",
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "TechniqueName": "File and Directory Discovery"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detections)"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell executing Get-Item for the current path."
  ],
  "Procedure": "Checked that the payload is not inside a folder path that contains \"sample\" or is the length of a hash value using PowerShell",
  "Step": "11.A.9",
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "TechniqueName": "File and Directory Discovery"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detections)"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell enumeration of System32."
  ],
  "Procedure": "Enumerated the System32 directory using PowerShell",
  "Step": "12.A.1",
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "TechniqueName": "File and Directory Discovery"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detections)",
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed the addition of the DelegateExecution Registry Value. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable."
  ],
  "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell",
  "Step": "3.B.1",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1122",
  "TechniqueName": "Component Object Model Hijacking"
}
{
  "Detection": [
    "Tactic",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Correlated"
  ],
  "DetectionText": [
    "A Tactic alert detection (red indicator) was generated for the setting of a Registry key used by User Account Control (UAC). The alert was correlated to a parent alert identifying the powershell.exe process as malware.",
    "Telemetry showed the addition of the DelegateExecute Registry value. The telemetry was correlated to a parent alert identifying the powershell.exe process as malware."
  ],
  "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell",
  "Step": "14.A.1",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1122",
  "TechniqueName": "Component Object Model Hijacking"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "Enumerated the current domain name using PowerShell",
  "Step": "4.C.4",
  "TacticGroup": "Discovery",
  "Technique": "T1016",
  "TechniqueName": "System Network Configuration Discovery"
}
{
  "Detection": [
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) was generated for the execution of a WMI system discovery command.",
    "Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem."
  ],
  "Procedure": "Checked that the computer is joined to a domain using PowerShell",
  "Step": "11.A.7",
  "TacticGroup": "Discovery",
  "Technique": "T1016",
  "TechniqueName": "System Network Configuration Discovery"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure, though alerts were generated for PowerShell compiling a DLL file using csc.exe and a suspicious binary write by csc.exe with a PowerShell parent."
  ],
  "Procedure": "Enumerated the domain name using the NetWkstaGetInfo API",
  "Step": "13.B.1",
  "TacticGroup": "Discovery",
  "Technique": "T1016",
  "TechniqueName": "System Network Configuration Discovery"
}
{
  "Detection": [
    "Technique",
    "General",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Configuration Change (Detections)",
    "Correlated",
    "Alert",
    "Correlated",
    "Configuration Change (Detections)"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) was generated for the use of a golden ticket. The detection was correlated to a parent alert for powershell.exe executing with suspicious large command line.",
    "A General alert detection (red indicator) was generated for a credential related module loaded by an unusual process. The detection was correlated to a parent alert for powershell.exe executing with suspicious large command line.",
    "Telemetry showed PowerShell executing Invoke-Mimikatz to create and inject a golden ticket into the current session."
  ],
  "Procedure": "Created Kerberos Golden Ticket using\u00a0Invoke-Mimikatz",
  "Step": "20.B.1",
  "TacticGroup": "Lateral Movement",
  "Technique": "T1097",
  "TechniqueName": "Pass the Ticket"
}
{
  "Detection": [
    "Technique",
    "Technique"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert"
  ],
  "DetectionText": [
    "A Technique alert detection for Windows Admin Shares was generated for PSExec using credentials to execute a remote command.",
    "A Technique alert detection was generated for PsExec64.exe writing a file to a remote admin share through the SMB protocol."
  ],
  "Procedure": "Established SMB session to remote host Scranton's (10.0.1.4) IPC$ share using PsExec",
  "Step": "8.C.2",
  "TacticGroup": "Lateral Movement",
  "Technique": "T1077",
  "TechniqueName": "Windows Admin Shares"
}
{
  "Detection": [
    "Technique"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detections)",
    "Alert"
  ],
  "DetectionText": [
    "A Technique alert detection called \"A New Service Has Been Created\" was generated due to PowerShell creating the new service javamtsup. "
  ],
  "Procedure": "Created a new service (javamtsup) that executes a service binary (javamtsup.exe) at system startup",
  "Step": "5.A.1",
  "TacticGroup": "Persistence",
  "Technique": "T1050",
  "TechniqueName": "New Service"
}
{
  "Detection": [
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Configuration Change (Detections)",
    "Configuration Change (Detections)"
  ],
  "DetectionText": [
    "A Technique alert detection (orange indicator) was generated for PowerShell being used to created a compressed archive. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.",
    "Telemetry showed powershell.exe compressing via Compress-Archive."
  ],
  "Procedure": "Compressed and stored files into ZIP (Draft.zip) using PowerShell",
  "Step": "2.A.4",
  "TacticGroup": "Exfiltration",
  "Technique": "T1002",
  "TechniqueName": "Data Compressed"
}
{
  "Detection": [
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Configuration Change (Detections)",
    "Correlated"
  ],
  "DetectionText": [
    "A Technique alert detection for Data Compressed was generated due to PowerShell loading a module capable of zipping files.",
    "Telemetry showed the file write event for OfficeSupplies.7z. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable."
  ],
  "Procedure": "Compressed\u00a0data from the user's Downloads directory into a ZIP file (OfficeSupplies.7z) using PowerShell",
  "Step": "7.B.2",
  "TacticGroup": "Exfiltration",
  "Technique": "T1002",
  "TechniqueName": "Data Compressed"
}
{
  "Detection": [
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "A Technique alert detection called \"Data Compressed T1002\" was generated due to powershell.exe executing rar.exe with command-line arguments indicative of compression.",
    "Telemetry showed powershell.exe executing rar.exe with command-line arguments. "
  ],
  "Procedure": "Compressed staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe",
  "Step": "9.B.7",
  "TacticGroup": "Exfiltration",
  "Technique": "T1002",
  "TechniqueName": "Data Compressed"
}
{
  "Detection": [
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Configuration Change (Detections)",
    "Configuration Change (Detections)"
  ],
  "DetectionText": [
    "A Technique alert detection was generated for Powershell creating a compressed archive.",
    "Telemetry showed PowerShell compressing collection via ZipFile.CreateFromDirectory .NET method."
  ],
  "Procedure": "Compressed a staging directory using PowerShell",
  "Step": "17.C.1",
  "TacticGroup": "Exfiltration",
  "Technique": "T1002",
  "TechniqueName": "Data Compressed"
}
{
  "Detection": [
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Configuration Change (Detections)",
    "Configuration Change (Detections)"
  ],
  "DetectionText": [
    "A Technique alert detection was generated for getting the BIOS version via Windows Management Instrumentation.",
    "Telemetry showed the PowerShell gwmi queries for Win32_BIOS."
  ],
  "Procedure": "Checked that the BIOS version and serial number are not associated with VirtualBox or VMware using PowerShell",
  "Step": "11.A.3",
  "TacticGroup": "Discovery",
  "Technique": "T1497",
  "TechniqueName": "Virtualization/Sandbox Evasion"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed file read event for Draft.zip and an existing C2 channel (192.168.0.5 over port 1234). The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable."
  ],
  "Procedure": "Read and downloaded ZIP (Draft.zip) over C2 channel (192.168.0.5 over TCP port 1234)",
  "Step": "2.B.1",
  "TacticGroup": "Exfiltration",
  "Technique": "T1041",
  "TechniqueName": "Exfiltration Over Command and Control Channel"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detections)"
  ],
  "DetectionText": [
    "Telemetry showed python.exe reading working.zip and an existing C2 channel (192.168.0.4 over port 8443)."
  ],
  "Procedure": "Read and downloaded ZIP (working.zip on Desktop) over C2 channel (192.168.0.5 over TCP port 8443)",
  "Step": "9.B.8",
  "TacticGroup": "Exfiltration",
  "Technique": "T1041",
  "TechniqueName": "Exfiltration Over Command and Control Channel"
}
{
  "Detection": [
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detections)",
    "Alert",
    "Correlated",
    "Configuration Change (Detections)"
  ],
  "DetectionText": [
    "A Technique detection (yellow indicator) was generated for Windows Management Instrumentation being used for AV discovery. The detection was correlated to a parent alert on rcs.3aka3.doc for the execution of a rogue unusual executable.",
    "Telemetry showed powershell.exe executing Get-WmiObject...\u200b -Class AntiVirusProduct. "
  ],
  "Procedure": "Enumerated anti-virus software using PowerShell",
  "Step": "4.C.7",
  "TacticGroup": "Discovery",
  "Technique": "T1063",
  "TechniqueName": "Security Software Discovery"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "Enumerated firewall software using PowerShell",
  "Step": "4.C.8",
  "TacticGroup": "Discovery",
  "Technique": "T1063",
  "TechniqueName": "Security Software Discovery"
}
{
  "Detection": [
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Alert"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) called \"WMIAntiVirusDiscovery\" was generated due to PowerShell gwmi query for AntiVirusProduct. The alert was correlated to a parent alert identifying the powershell.exe process as malware.",
    "Telemetry showed PowerShell gwmi query for AntiVirusProduct."
  ],
  "Procedure": "Enumerated registered AV products using PowerShell",
  "Step": "12.B.1",
  "TacticGroup": "Discovery",
  "Technique": "T1063",
  "TechniqueName": "Security Software Discovery"
}
