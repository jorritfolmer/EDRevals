{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed that the file was a .scr binary, and that the filename included the unicode character for RTLO."
  ],
  "Procedure": "Used unicode right-to-left override (RTLO) character to obfuscate file name rcs.3aka3.doc (originally cod.3aka.scr)",
  "Step": "1.A.2",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1036",
  "TechniqueName": "Masquerading"
}
{
  "Detection": [
    "General",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "A General alert detection (red indicator) was generated for a \"PUP or Potentially Unwanted Program (PUP: ChromePassRecovery)\".",
    "Telemetry showed accesschk.exe is not a signed Microsoft binary with hash values provided. This can be used to verify it is not the legitimate Sysinternals tool."
  ],
  "Procedure": "Masqueraded a Chrome password dump tool as accesscheck.exe, a legitimate Sysinternals tool",
  "Step": "6.A.3",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1036",
  "TechniqueName": "Masquerading"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing Get-Process. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious."
  ],
  "Procedure": "Enumerated current running processes using PowerShell",
  "Step": "4.B.1",
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "TechniqueName": "Process Discovery"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [
    "Host Interrogation",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation."
  ],
  "Procedure": "Enumerated the current process ID using PowerShell",
  "Step": "4.C.5",
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "TechniqueName": "Process Discovery"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing Get-Process. The detection was correlated to a parent alert for Powershell or WinRM remoting activity."
  ],
  "Procedure": "Enumerated processes on remote host Scranton (10.0.1.4) using PowerShell",
  "Step": "8.A.3",
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "TechniqueName": "Process Discovery"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed the PowerShell gwmi query for Win32_Process."
  ],
  "Procedure": "Checked that processes such as procexp.exe, taskmgr.exe, or wireshark.exe are not running using PowerShell",
  "Step": "11.A.8",
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "TechniqueName": "Process Discovery"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell calling the CreateToolhelp32Snapshot API. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe."
  ],
  "Procedure": "Enumerated running processes using the CreateToolhelp32Snapshot API",
  "Step": "13.D.1",
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "TechniqueName": "Process Discovery"
}
{
  "Detection": [
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated"
  ],
  "DetectionText": [
    "A Technique alert detection (orange indicator) was generated for PowerShell enumerating processes. The detection was correlated to a parent alert for Windows Management Instrumentation.",
    "Telemetry showed PowerShell executing Get-Process."
  ],
  "Procedure": "Enumerated and tracked PowerShell processes using PowerShell",
  "Step": "14.B.2",
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "TechniqueName": "Process Discovery"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure, though data showed a file write of the passwordsdb output."
  ],
  "Procedure": "Read the Chrome SQL database file to extract encrypted credentials",
  "Step": "6.A.1",
  "TacticGroup": "Credential Access",
  "Technique": "T1081",
  "TechniqueName": "Credentials in Files"
}
{
  "Detection": [
    "Technique",
    "General",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) for Windows Management Instrumentation was generated for WmiPrvSE.exe executing powershell.exe.",
    "A General alert detection (red indicator) for Privilege Escalation was generated for suspicious PowerShell behavior. ",
    "Telemetry showed WmiPrvSe.exe executing powershell.exe."
  ],
  "Procedure": "Created and executed a WMI class using PowerShell",
  "Step": "14.B.1",
  "TacticGroup": "Execution",
  "Technique": "T1047",
  "TechniqueName": "Windows Management Instrumentation"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [
    "Host Interrogation",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "No detection capability demonstrated for this procedure, though data showed that the Netapi32.dll was loaded into powershell.exe and the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation."
  ],
  "Procedure": "Enumerated user's domain group membership via the NetUserGetGroups API",
  "Step": "4.C.9",
  "TacticGroup": "Discovery",
  "Technique": "T1069",
  "TechniqueName": "Permission Groups Discovery"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [
    "Host Interrogation",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "No detection capability demonstrated for this procedure, though data showed that the Netapi32.dll was loaded into powershell.exe and the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation."
  ],
  "Procedure": "Enumerated user's local group membership via\u00a0the NetUserGetLocalGroups API",
  "Step": "4.C.11",
  "TacticGroup": "Discovery",
  "Technique": "T1069",
  "TechniqueName": "Permission Groups Discovery"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed rcs.3aka3.doc creating monkey.png. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious."
  ],
  "Procedure": "Dropped stage 2 payload (monkey.png) to disk",
  "Step": "3.A.1",
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "TechniqueName": "Remote File Copy"
}
{
  "Detection": [
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Correlated"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) was generated for \"Sysinternals Tools Downloaded via Command Interpreter.\" The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.",
    "Telemetry showed the file write of the ZIP by PowerShell. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious."
  ],
  "Procedure": "Dropped additional tools (SysinternalsSuite.zip) to disk over C2 channel (192.168.0.5)",
  "Step": "4.A.1",
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "TechniqueName": "Remote File Copy"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed the filemod event for the creation of python.exe on the remote host Scranton (10.0.1.4). Telemetry also showed the file write from the local host. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious."
  ],
  "Procedure": "Copied python.exe payload from a WebDAV share (192.168.0.4) to remote host Scranton (10.0.1.4)",
  "Step": "8.B.1",
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "TechniqueName": "Remote File Copy"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed the file create event for rar.exe by python.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution."
  ],
  "Procedure": "Dropped rar.exe to disk on remote host Scranton (10.0.1.4)\u00a0",
  "Step": "9.A.1",
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "TechniqueName": "Remote File Copy"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed the file create event for sdelete64.exe by python.exe.  The detection was correlated to a parent alert on psexesvc.exe for service execution."
  ],
  "Procedure": "Dropped sdelete.exe to disk on remote host Scranton (10.0.1.4)\u00a0",
  "Step": "9.A.2",
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "TechniqueName": "Remote File Copy"
}
{
  "Detection": [
    "General",
    "General",
    "General",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Alert",
    "Alert",
    "Correlated",
    "Correlated"
  ],
  "DetectionText": [
    "A General alert detection (red indicator) was generated for .Net attempting suspicious network connections. The detection was correlated to a parent alert for Windows Management Instrumentation.\t",
    "A General alert detection (red indicator) was generated for powershell.exe executing a fileless script or command.\t",
    "A General alert detection (red indicator) was generated for PowerShell with network connections spawned by WMI. The detection was correlated to a parent alert for Windows Management Instrumentation.\t",
    "Telemetry showed the PowerShell command to download m.exe. Telemetry also showed the file create event for m.exe into the System32 folder. The detection was correlated to a parent alert for Windows Management Instrumentation."
  ],
  "Procedure": "Downloaded and dropped Mimikatz (m.exe) to disk",
  "Step": "14.B.3",
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "TechniqueName": "Remote File Copy"
}
{
  "Detection": [
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) was generated for a code drop of m.exe (identified as Mimikatz by the file metadata).",
    "Telemetry showed a filemod for the creation of m.exe in the System32 directory by wsmprovhost.exe."
  ],
  "Procedure": "Dropped Mimikatz (m.exe) to disk on the domain controller host NewYork (10.0.0.4) over a WinRM connection",
  "Step": "16.D.1",
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "TechniqueName": "Remote File Copy"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "An MSSP detection was generated for cmd.exe spawning from rcs.3aka3.doc.",
    "Telemetry showed cmd.exe spawning from rcs.3aka3.doc\u200b. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious."
  ],
  "Procedure": "Spawned interactive cmd.exe",
  "Step": "1.B.1",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "TechniqueName": "Command-Line Interface"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "python.exe payload was packed with UPX",
  "Step": "8.B.2",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1045",
  "TechniqueName": "Software Packing"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [
    "Host Interrogation",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation."
  ],
  "Procedure": "Enumerated the computer hostname using PowerShell",
  "Step": "4.C.3",
  "TacticGroup": "Discovery",
  "Technique": "T1082",
  "TechniqueName": "System Information Discovery"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [
    "Host Interrogation",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation."
  ],
  "Procedure": "Enumerated the OS version using PowerShell",
  "Step": "4.C.6",
  "TacticGroup": "Discovery",
  "Technique": "T1082",
  "TechniqueName": "System Information Discovery"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem."
  ],
  "Procedure": "Enumerated computer manufacturer, model, and version information using PowerShell",
  "Step": "11.A.4",
  "TacticGroup": "Discovery",
  "Technique": "T1082",
  "TechniqueName": "System Information Discovery"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell calling the GetComputerNameEx API. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe."
  ],
  "Procedure": "Enumerated the computer name using the GetComputerNameEx API",
  "Step": "13.A.1",
  "TacticGroup": "Discovery",
  "Technique": "T1082",
  "TechniqueName": "System Information Discovery"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of key logging.",
    "Telemetry showed PowerShell calling the GetAsyncKeyState API. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious."
  ],
  "Procedure": "Captured user keystrokes using the GetAsyncKeyState API",
  "Step": "7.A.3",
  "TacticGroup": "Collection",
  "Technique": "T1056",
  "TechniqueName": "Input Capture"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection was generated for rcs.3aka3.doc connecting to 192.168.0.5. ",
    "Telemetry showed the rcs.3aka3.doc process connecting to 192.168.0.5 over TCP port 1234."
  ],
  "Procedure": "Established C2 channel (192.168.0.5) via rcs.3aka3.doc payload over TCP port 1234",
  "Step": "1.A.3",
  "TacticGroup": "Command and Control",
  "Technique": "T1065",
  "TechniqueName": "Uncommonly Used Port"
}
{
  "Detection": [
    "Technique",
    "General",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert",
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) was generated for the creation of a local user with Net.",
    "A General alert detection (red indicator) was generated for a process spawned from PowerShell remoting (WinRM).",
    "An MSSP detection occurred containing evidence of PowerShell adding new user to the remote host Scranton (10.0.1.4) using net.exe.",
    "Telemetry showed the PowerShell command to add the new User Toby to the remote host Scranton (10.0.1.4). Telemetry also subsequently showed wsmprovhost.exe spawning net.exe with the command-line arguments. The detection was correlated to a parent alert for Windows Management Instrumentation."
  ],
  "Procedure": "Added a new user to the remote host Scranton (10.0.1.4) using net.exe",
  "Step": "20.B.3",
  "TacticGroup": "Persistence",
  "Technique": "T1136",
  "TechniqueName": "Create Account"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "An MSSP detection was generated referencing the creation of Draft.zip for later exfiltration.",
    "Telemetry showed file creation of Draft.zip. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious."
  ],
  "Procedure": "Staged files for exfiltration into ZIP (Draft.zip) using PowerShell",
  "Step": "2.A.5",
  "TacticGroup": "Collection",
  "Technique": "T1074",
  "TechniqueName": "Data Staged"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed a filemod event for powershell.exe creating working.zip. The detection was correlated to a parent alert on psexesvc.exe for service execution."
  ],
  "Procedure": "Staged files for exfiltration into ZIP (working.zip in AppData directory) using PowerShell",
  "Step": "9.B.5",
  "TacticGroup": "Collection",
  "Technique": "T1074",
  "TechniqueName": "Data Staged"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of PowerShell staging a collected file into a directory.",
    "Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe."
  ],
  "Procedure": "Staged collected file into directory using PowerShell",
  "Step": "17.B.2",
  "TacticGroup": "Collection",
  "Technique": "T1074",
  "TechniqueName": "Data Staged"
}
{
  "Detection": [
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Correlated"
  ],
  "DetectionText": [
    "A Technique alert detection called \"Persistence - PowerShell Startup Folder\" was generated due to hostui.lnk being written to the Startup folder. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.",
    "Telemetry showed the file write of hostui.lnk in the Startup folder. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious."
  ],
  "Procedure": "Created a LNK file (hostui.lnk) in the Startup folder that executes on login",
  "Step": "5.B.1",
  "TacticGroup": "Persistence",
  "Technique": "T1060",
  "TechniqueName": "Registry Run Keys / Startup Folder"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure, though execution of hostui.bat was observed."
  ],
  "Procedure": "Executed LNK payload (hostui.lnk) in Startup Folder on user login",
  "Step": "10.B.1",
  "TacticGroup": "Persistence",
  "Technique": "T1060",
  "TechniqueName": "Registry Run Keys / Startup Folder"
}
{
  "Detection": [
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) for Registry Run Keys was generated based on powershell.exe modifying the Run key.",
    "Telemetry showed powershell.exe adding Run key persistence into the Registry."
  ],
  "Procedure": "Established Registry Run key persistence using PowerShell",
  "Step": "11.A.11",
  "TacticGroup": "Persistence",
  "Technique": "T1060",
  "TechniqueName": "Registry Run Keys / Startup Folder"
}
{
  "Detection": [
    "General",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "A General alert detection (red indicator) was generated for \"AMSI - Abnormal Fileless command-line length being executed.\" The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.",
    "An MSSP detection was generated for cmd.exe spawning powershell.exe.",
    "Telemetry showing powershell.exe spawning from cmd.exe. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious."
  ],
  "Procedure": "Spawned interactive powershell.exe",
  "Step": "1.B.2",
  "TacticGroup": "Execution",
  "Technique": "T1086",
  "TechniqueName": "PowerShell"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed a new powershell.exe spawning from powershell.exe. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious."
  ],
  "Procedure": "Spawned interactive powershell.exe",
  "Step": "4.A.2",
  "TacticGroup": "Execution",
  "Technique": "T1086",
  "TechniqueName": "PowerShell"
}
{
  "Detection": [
    "General",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Correlated"
  ],
  "DetectionText": [
    "A General alert detection (red indicator) was generated for the execution of a abnormal fileless command-line length. The detection was correlated to a parent alert on psexesvc.exe for service execution.",
    "Telemetry showed python.exe executing powershell.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution."
  ],
  "Procedure": "Spawned interactive powershell.exe",
  "Step": "9.B.1",
  "TacticGroup": "Execution",
  "Technique": "T1086",
  "TechniqueName": "PowerShell"
}
{
  "Detection": [
    "Technique",
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) was generated for PowerShell executing hidden, encoded commands.",
    "A Technique alert detection (red indicator) was generated for powershell.exe executing encoded instructions.",
    "Telemetry showed powershell.exe spawned from a PowerShell stager."
  ],
  "Procedure": "Executed PowerShell stager payload",
  "Step": "11.A.12",
  "TacticGroup": "Execution",
  "Technique": "T1086",
  "TechniqueName": "PowerShell"
}
{
  "Detection": [
    "Technique",
    "General",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) was generated for PowerShell executing hidden, encoded commands.",
    "A General alert detection was generated for a hidden PowerShell with an Unusual Parent.",
    "Telemetry showed powershell.exe spawning from wmiprvse.exe with SYSTEM-level integrity."
  ],
  "Procedure": "Executed PowerShell payload from WMI event subscription persistence",
  "Step": "20.A.3",
  "TacticGroup": "Execution",
  "Technique": "T1086",
  "TechniqueName": "PowerShell"
}
{
  "Detection": [
    "Technique",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) called \"AMSI - Clipboard Monitoring\" was generated for fileless_scriptload of Get-Clipboard. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.",
    "An MSSP detection occurred containing evidence of PowerShell capturing clipboard data.",
    "Telemetry showed powershell.exe executing Get-Clipboard. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious."
  ],
  "Procedure": "Captured clipboard contents using PowerShell",
  "Step": "7.A.2",
  "TacticGroup": "Collection",
  "Technique": "T1115",
  "TechniqueName": "Clipboard Data"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure, though data showed powershell.exe loading of HTTP and cryptographic libraries."
  ],
  "Procedure": "Used HTTPS to transport\u00a0C2 (192.168.0.5) traffic",
  "Step": "3.B.4",
  "TacticGroup": "Command and Control",
  "Technique": "T1071",
  "TechniqueName": "Standard Application Layer Protocol"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "Used HTTPS to transport\u00a0C2 (192.168.0.4) traffic",
  "Step": "11.A.14",
  "TacticGroup": "Command and Control",
  "Technique": "T1071",
  "TechniqueName": "Standard Application Layer Protocol"
}
{
  "Detection": [
    "Technique",
    "Tactic",
    "Tactic",
    "General",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert",
    "Correlated",
    "Correlated",
    "Alert",
    "Alert",
    "Correlated"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) was generated for \"Powershell or WinRM remoting activity\" based on wsmprovhost.exe.",
    "A Tactic alert detection called \"Remote powershell activity\" was generated for the use of powershell.exe with a destination port 5985. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.",
    "A Tactic alert detection called \"Remote Services\" was generated for the use of powershell.exe with a destination port 5985. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.",
    "A General alert detection (red indicator) was generated for suspicious fileless execution not originating from PowerShell.",
    "Telemetry showed network connection to remote host Scranton (10.0.1.4) over port TCP 5985. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious."
  ],
  "Procedure": "Established WinRM connection to remote host Scranton (10.0.1.4)",
  "Step": "8.A.2",
  "TacticGroup": "Execution",
  "Technique": "T1028",
  "TechniqueName": "Windows Remote Management"
}
{
  "Detection": [
    "Technique",
    "Tactic",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Alert",
    "Correlated"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) was generated on NewYork (10.0.0.4) for a remote PowerShell session based on the identification of the WinRM process (wsmprovhost.exe).",
    "A Tactic alert detection (yellow indicator) was generated for powershell.exe accessing the network. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe.",
    "Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe."
  ],
  "Procedure": "Established a WinRM connection to the domain controller host NewYork (10.0.0.4) ",
  "Step": "16.C.1",
  "TacticGroup": "Execution",
  "Technique": "T1028",
  "TechniqueName": "Windows Remote Management"
}
{
  "Detection": [
    "Technique",
    "Tactic",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert",
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) called \"Powershell or WinRM remoting activity\" was generated for a powershell WinRM session on the remote host Scranton (10.0.1.4).",
    "A Tactic alert detection (red indicator) called for remote PowerShell activity was generated for a PowerShell WinRM session. ",
    "An MSSP detection occurred containing evidence of PowerShell create a WinRM session to remote host Scranton (10.0.1.4).",
    "Telemetry showed PowerShell executing the Enter-PSSession cmdlet to open a network connection to the remote host Scranton (10.0.1.4). The detection was correlated to a parent alert for Windows Management Instrumentation."
  ],
  "Procedure": "Established a WinRM connection to the remote host Scranton (10.0.1.4) using the Golden Ticket as credentials",
  "Step": "20.B.2",
  "TacticGroup": "Execution",
  "Technique": "T1028",
  "TechniqueName": "Windows Remote Management"
}
{
  "Detection": [
    "General",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A General alert detection (blue indicator) was generated for rcs.3aka3.doc being tagged as suspicious.  ",
    "An MSSP detection for the execution of the malicious document rcs.3aka3.doc file.",
    "Telemetry showed explorer.exe executing rcs.3aka3.doc. "
  ],
  "Procedure": "User Pam executed payload rcs.3aka3.doc",
  "Step": "1.A.1",
  "TacticGroup": "Execution",
  "Technique": "T1204",
  "TechniqueName": "User Execution"
}
{
  "Detection": [
    "General",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "A General alert detection (red indicator) was generated for the execution of powershell.exe from explorer.exe. ",
    "Telemetry showed explorer.exe spawning powershell.exe."
  ],
  "Procedure": "User Oscar executed payload 37486-the-shocking-truth-about-election-rigging-in-america.rtf.lnk",
  "Step": "11.A.1",
  "TacticGroup": "Execution",
  "Technique": "T1204",
  "TechniqueName": "User Execution"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of PowerShell querying the registry.",
    "Telemetry showed script block with registry query for installed software. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe."
  ],
  "Procedure": "Enumerated installed software via the Registry (Wow6432 Uninstall key) using PowerShell",
  "Step": "12.C.1",
  "TacticGroup": "Discovery",
  "Technique": "T1012",
  "TechniqueName": "Query Registry"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of PowerShell querying the registry.",
    "Telemetry showed script block with registry query for installed software. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe."
  ],
  "Procedure": "Enumerated installed software via the Registry (Uninstall key) using PowerShell",
  "Step": "12.C.2",
  "TacticGroup": "Discovery",
  "Technique": "T1012",
  "TechniqueName": "Query Registry"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell",
  "Step": "2.A.3",
  "TacticGroup": "Collection",
  "Technique": "T1005",
  "TechniqueName": "Data from Local System"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "Read data in the user's Downloads directory using PowerShell",
  "Step": "7.B.1",
  "TacticGroup": "Collection",
  "Technique": "T1005",
  "TechniqueName": "Data from Local System"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell",
  "Step": "9.B.4",
  "TacticGroup": "Collection",
  "Technique": "T1005",
  "TechniqueName": "Data from Local System"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "Read and collected a local file using PowerShell",
  "Step": "17.B.1",
  "TacticGroup": "Collection",
  "Technique": "T1005",
  "TechniqueName": "Data from Local System"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "An MSSP detection was generated for the use of ChildItem. ",
    "Telemetry showed powershell.exe executing ChildItem. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious."
  ],
  "Procedure": "Scripted search of filesystem for document and media files using PowerShell\u00a0",
  "Step": "2.A.2",
  "TacticGroup": "Collection",
  "Technique": "T1119",
  "TechniqueName": "Automated Collection"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing ChildItem. The detection was correlated to a parent alert on psexesvc.exe for service execution."
  ],
  "Procedure": "Scripted search of filesystem for document and media files using PowerShell\u00a0",
  "Step": "9.B.3",
  "TacticGroup": "Collection",
  "Technique": "T1119",
  "TechniqueName": "Automated Collection"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Host Interrogation"
  ],
  "DetectionText": [
    "No detection capability demonstrated for this procedure, though data showed that the Netapi32.dll was loaded into powershell.exe and the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation."
  ],
  "Procedure": "Executed API call by reflectively loading Netapi32.dll",
  "Step": "4.C.10",
  "TacticGroup": "Execution",
  "Technique": "T1106",
  "TechniqueName": "Execution through API"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [
    "Host Interrogation",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "No detection capability demonstrated for this procedure, though data showed that the Netapi32.dll was loaded into powershell.exe and the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation."
  ],
  "Procedure": "Executed API call by reflectively loading Netapi32.dll",
  "Step": "4.C.12",
  "TacticGroup": "Execution",
  "Technique": "T1106",
  "TechniqueName": "Execution through API"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure, though data showed svchost.exe interacting with powershell.exe via OpenProcess."
  ],
  "Procedure": "Executed PowerShell payload via the CreateProcessWithToken API",
  "Step": "10.B.2",
  "TacticGroup": "Execution",
  "Technique": "T1106",
  "TechniqueName": "Execution through API"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell reflectively loading Advapi32.dll inorder to execute the ConvertSidToStringSid API function. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe."
  ],
  "Procedure": "Executed the ConvertSidToStringSid API call by reflectively loading Advapi32.dll",
  "Step": "16.B.2",
  "TacticGroup": "Execution",
  "Technique": "T1106",
  "TechniqueName": "Execution through API"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure, though data showed rcs.3aka3.doc loading cryptographic libraries."
  ],
  "Procedure": "Used RC4 stream cipher to encrypt C2 (192.168.0.5) traffic",
  "Step": "1.A.4",
  "TacticGroup": "Command and Control",
  "Technique": "T1032",
  "TechniqueName": "Standard Cryptographic Protocol"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure, though data showed powershell.exe loading of HTTP and cryptographic libraries."
  ],
  "Procedure": "Used HTTPS to encrypt C2 (192.168.0.5) traffic",
  "Step": "3.B.5",
  "TacticGroup": "Command and Control",
  "Technique": "T1032",
  "TechniqueName": "Standard Cryptographic Protocol"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure, though data showed powershell.exe loading cryptographic libraries."
  ],
  "Procedure": "Used HTTPS to encrypt C2 (192.168.0.4) traffic",
  "Step": "11.A.15",
  "TacticGroup": "Command and Control",
  "Technique": "T1032",
  "TechniqueName": "Standard Cryptographic Protocol"
}
{
  "Detection": [
    "General",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Correlated"
  ],
  "DetectionText": [
    "A General alert detection was generated for net.exe making network connections. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe.",
    "Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe."
  ],
  "Procedure": "Mapped a network drive to an online OneDrive account using PowerShell",
  "Step": "18.A.1",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1102",
  "TechniqueName": "Web Service"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed the PowerShell gwmi query for Win32_PnPEntity."
  ],
  "Procedure": "Enumerated devices/adapters to check for presence of VirtualBox driver(s) using PowerShell",
  "Step": "11.A.5",
  "TacticGroup": "Discovery",
  "Technique": "T1120",
  "TechniqueName": "Peripheral Device Discovery"
}
{
  "Detection": [
    "General",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated"
  ],
  "DetectionText": [
    "A General alert detection (yellow indicator) for powershell.exe fileless script or command was generated for \"code_drop\" and \"detected_pup_app\". ",
    "Telemetry showed PowerShell decompressing the ZIP via Expand-Archive as well as the subsequent file writes. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious."
  ],
  "Procedure": "Decompressed ZIP (SysinternalsSuite.zip) file using PowerShell",
  "Step": "4.A.3",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1140",
  "TechniqueName": "Deobfuscate/Decode Files or Information"
}
{
  "Detection": [
    "Technique",
    "Technique",
    "General",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert",
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) for \"Deobfuscate/Decode Files or Information - certuil\" was generated for the use of certutil.exe decoding a payload.",
    "A Technique alert detection (red indicator) for \"Deobfuscate/Decode Files or Information\" was generated for the use of certutil.exe decoding a payload.",
    "A General alert detection (red indicator) was generated for a executable file found in memory.",
    "An MSSP detection for was received that described the adversary executing certutil.exe to decode a base64 blob into the payload kxwn.lock.",
    "Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload."
  ],
  "Procedure": "Decoded an embedded DLL payload to disk using certutil.exe",
  "Step": "11.A.10",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1140",
  "TechniqueName": "Deobfuscate/Decode Files or Information"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell reading encoded content from the WMI class. The detection was correlated to a parent alert for Windows Management Instrumentation."
  ],
  "Procedure": "Read and decoded Mimikatz output from a WMI class property using PowerShell",
  "Step": "14.B.6",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1140",
  "TechniqueName": "Deobfuscate/Decode Files or Information"
}
{
  "Detection": [
    "General",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "A General alert detection (red indicator) was generated for the use of PowerShell executing with Invoke-Expression. ",
    "Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX."
  ],
  "Procedure": "Executed an alternate data stream (ADS) using PowerShell",
  "Step": "11.A.2",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1096",
  "TechniqueName": "NTFS File Attributes"
}
{
  "Detection": [
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) called \"T1035 & T1077 - Service Execution - psexec - target\" was generated due to a process running remotely with PsExec.",
    "Telemetry showed python.exe spawned by PSEXESVC.exe"
  ],
  "Procedure": "Executed python.exe using PSExec",
  "Step": "8.C.3",
  "TacticGroup": "Execution",
  "Technique": "T1035",
  "TechniqueName": "Service Execution"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed rundll32.exe with a parent process of javamtsup.exe (identified as being spawned from services.exe)."
  ],
  "Procedure": "Executed persistent service (javamtsup) on system startup",
  "Step": "10.A.1",
  "TacticGroup": "Execution",
  "Technique": "T1035",
  "TechniqueName": "Service Execution"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [
    "Host Interrogation",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation."
  ],
  "Procedure": "Encrypted data from the user's Downloads directory using PowerShell",
  "Step": "7.B.3",
  "TacticGroup": "Exfiltration",
  "Technique": "T1022",
  "TechniqueName": "Data Encrypted"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing rar.exe with command-line arguments. The detection was correlated to a parent alert on psexesvc.exe for service execution."
  ],
  "Procedure": "Encrypted staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe",
  "Step": "9.B.6",
  "TacticGroup": "Exfiltration",
  "Technique": "T1022",
  "TechniqueName": "Data Encrypted"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of rundll32.exe executing kxwn.lock.",
    "Telemetry showed rundll32.exe executing kxwn.lock."
  ],
  "Procedure": "Executed Run key persistence payload on user login using RunDll32",
  "Step": "20.A.1",
  "TacticGroup": "Execution",
  "Technique": "T1085",
  "TechniqueName": "Rundll32"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe establishing a connection to NewYork (10.0.0.4) over TCP port 389. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious."
  ],
  "Procedure": "Enumerated remote systems using LDAP queries",
  "Step": "8.A.1",
  "TacticGroup": "Discovery",
  "Technique": "T1018",
  "TechniqueName": "Remote System Discovery"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe making a network connection to the domain controller NewYork (10.0.0.4) over TCP port 389 and a modload for System.DirectoryServices.dll. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe."
  ],
  "Procedure": "Enumerated the domain controller host NewYork (10.0.0.4) using LDAP queries",
  "Step": "16.A.1",
  "TacticGroup": "Discovery",
  "Technique": "T1018",
  "TechniqueName": "Remote System Discovery"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed the deletion of the command subkey. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious."
  ],
  "Procedure": "Modified the Registry to remove artifacts of COM hijacking",
  "Step": "3.C.1",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1112",
  "TechniqueName": "Modify Registry"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of the deletion of the DelegateExecute Registry value.",
    "Telemetry showed the deletion of the Registry value. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe."
  ],
  "Procedure": "Modified the Registry to remove artifacts of COM hijacking using PowerShell",
  "Step": "14.A.3",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1112",
  "TechniqueName": "Modify Registry"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell creating OfficeSupplies.7z on a remote adversary WebDav network share (192.168.0.4). The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious."
  ],
  "Procedure": "Exfiltrated collection (OfficeSupplies.7z) to WebDAV network share using PowerShell",
  "Step": "7.B.4",
  "TacticGroup": "Exfiltration",
  "Technique": "T1048",
  "TechniqueName": "Exfiltration Over Alternative Protocol"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of PowerShell executing Copy-Item to exfiltrate data to a previously mapped OneDrive account.",
    "Telemetry showed PowerShell executing Copy-Item to exfiltrate data to a OneDrive account, along with the creation of the exfiltrated data within the OneDrive. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe."
  ],
  "Procedure": "Exfiltrated staged collection to an online OneDrive account using PowerShell",
  "Step": "18.A.2",
  "TacticGroup": "Exfiltration",
  "Technique": "T1048",
  "TechniqueName": "Exfiltration Over Alternative Protocol"
}
{
  "Detection": [
    "N/A"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Due to execution inconsistencies Step 19 has been omitted from the evaluation results."
  ],
  "Procedure": "Reflectively injected SDelete binary into PowerShell",
  "Step": "19.A.2",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1055",
  "TechniqueName": "Process Injection"
}
{
  "Detection": [
    "N/A"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Due to execution inconsistencies Step 19 has been omitted from the evaluation results."
  ],
  "Procedure": "Reflectively injected SDelete binary into PowerShell",
  "Step": "19.B.2",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1055",
  "TechniqueName": "Process Injection"
}
{
  "Detection": [
    "N/A"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Due to execution inconsistencies Step 19 has been omitted from the evaluation results."
  ],
  "Procedure": "Reflectively injected SDelete binary into PowerShell",
  "Step": "19.C.2",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1055",
  "TechniqueName": "Process Injection"
}
{
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection was generated for the execution of accesschk.exe to dump passwords."
  ],
  "Procedure": "Executed the CryptUnprotectedData API call to decrypt Chrome passwords",
  "Step": "6.A.2",
  "TacticGroup": "Credential Access",
  "Technique": "T1003",
  "TechniqueName": "Credential Dumping"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe opening a handle to a lsass.exe thread. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious."
  ],
  "Procedure": "Dumped password hashes from the Windows Registry by injecting a malicious DLL into Lsass.exe",
  "Step": "6.C.1",
  "TacticGroup": "Credential Access",
  "Technique": "T1003",
  "TechniqueName": "Credential Dumping"
}
{
  "Detection": [
    "Technique",
    "General",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Alert",
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) for \"Credential Dumping\" was generated for command-line arguments indicative of Mimikatz credential dumping. The detection was correlated to a parent alert for Windows Management Instrumentation.",
    "A General alert detection (red indicator) was generated for powershell.exe executing a fileless script or command.",
    "An MSSP detection occurred containing evidence of PowerShell executing Mimikatz to obtain login credentials.",
    "Telemetry showed m.exe opening lsass.exe with OpenProcess. The detection was correlated to a parent alert for Windows Management Instrumentation."
  ],
  "Procedure": "Dumped plaintext credentials using Mimikatz (m.exe)",
  "Step": "14.B.4",
  "TacticGroup": "Credential Access",
  "Technique": "T1003",
  "TechniqueName": "Credential Dumping"
}
{
  "Detection": [
    "Technique",
    "General",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Correlated"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) for \"Credential Dumping\" was generated for command-line arguments indicative of Mimikatz credential dumping.",
    "A General detection was generated for process injection by m.exe. The detection was correlated to a parent alert for a code drop of m.exe.",
    "Telemetry showed m.exe opening lsass.exe with OpenProcess. The detection was correlated to a parent alert for a code drop of m.exe."
  ],
  "Procedure": "Dumped the KRBTGT hash on the domain controller host NewYork (10.0.0.4) using Mimikatz (m.exe)",
  "Step": "16.D.2",
  "TacticGroup": "Credential Access",
  "Technique": "T1003",
  "TechniqueName": "Credential Dumping"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of PowerShell modifying filesystem access and write times of the kxwn.lock file.",
    "Telemetry showed script block with commands to timestomp kxwn.lock as well as the execution of the timestomp function against the kxwn.lock file. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe."
  ],
  "Procedure": "Modified the time attributes of the kxwn.lock persistence payload using PowerShell",
  "Step": "12.A.2",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1099",
  "TechniqueName": "Timestomp"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [
    "Host Interrogation",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "No detection capability demonstrated for this procedure, though the analyst was able to query to get a list of users logged on to remote host Scranton (10.0.1.4)."
  ],
  "Procedure": "Logged on to remote host Scranton (10.0.1.4) using\u00a0valid credentials for user Pam",
  "Step": "8.C.1",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1078",
  "TechniqueName": "Valid Accounts"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [
    "Host Interrogation",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "No detection capability demonstrated for this procedure, though the analyst was able to query the DC to get a list of users logged on."
  ],
  "Procedure": "Logged on to the domain controller host NewYork (10.0.0.4) using\u00a0valid credentials for user MScott\u00a0",
  "Step": "16.C.2",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1078",
  "TechniqueName": "Valid Accounts"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [
    "Host Interrogation",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation."
  ],
  "Procedure": "Enumerated the current username using PowerShell",
  "Step": "4.C.2",
  "TacticGroup": "Discovery",
  "Technique": "T1033",
  "TechniqueName": "System Owner/User Discovery"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem."
  ],
  "Procedure": "Checked that the username is not related to admin or a generic value (ex: user) using PowerShell",
  "Step": "11.A.6",
  "TacticGroup": "Discovery",
  "Technique": "T1033",
  "TechniqueName": "System Owner/User Discovery"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell calling the GetUserNameEx API. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe."
  ],
  "Procedure": "Enumerated the current username using the GetUserNameEx API",
  "Step": "13.C.1",
  "TacticGroup": "Discovery",
  "Technique": "T1033",
  "TechniqueName": "System Owner/User Discovery"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell script block executing $env:UserName. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe."
  ],
  "Procedure": "Enumerated logged on users using PowerShell",
  "Step": "15.A.1",
  "TacticGroup": "Discovery",
  "Technique": "T1033",
  "TechniqueName": "System Owner/User Discovery"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell executing the ConvertSidToStringSid API function. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe."
  ],
  "Procedure": "Enumerated the domain SID (from current user SID) using\u00a0the ConvertSidToStringSid API",
  "Step": "16.B.1",
  "TacticGroup": "Discovery",
  "Technique": "T1033",
  "TechniqueName": "System Owner/User Discovery"
}
{
  "Detection": [
    "Tactic",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "A Tactic alert detection was generated for \"Privilege Escalation\" based on suspicious PowerShell behavior.",
    "An MSSP detection was generated for the use of sdclt.exe as a high privilege process, which called control.exe.",
    "Telemetry showed control.exe creating a high integrity powershell.exe. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious."
  ],
  "Procedure": "Executed elevated PowerShell payload",
  "Step": "3.B.2",
  "TacticGroup": "Privilege Escalation",
  "Technique": "T1088",
  "TechniqueName": "Bypass User Account Control"
}
{
  "Detection": [
    "Technique",
    "Tactic",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection was generated for bypassing UAC with sdclt.exe.",
    "A Tactic alert detection was generated for supicious privilege escalation process behavior by PowerShell.",
    "An MSSP detection occurred containing evidence of PowerShell elevating privileges via a UAC bypass using sdclt.exe and control.exe."
  ],
  "Procedure": "Executed elevated PowerShell payload",
  "Step": "14.A.2",
  "TacticGroup": "Privilege Escalation",
  "Technique": "T1088",
  "TechniqueName": "Bypass User Account Control"
}
{
  "Detection": [
    "Technique",
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Alert",
    "Correlated",
    "Correlated"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) called \"File Deletion - sdelete execution\" was generated due to Sdelete64.exe deleting rcs.3aka3.doc. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.",
    "A Technique alert detection (red indicator) for secure delete of sensitive data was generated due to Sdelete64.exe deleting rcs.3aka3.doc. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.",
    "Telemetry showed sdelete.exe running with command-line arguments and subsequently writing to and deleting the file. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious."
  ],
  "Procedure": "Deleted rcs.3aka3.doc on disk using SDelete",
  "Step": "4.B.2",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1107",
  "TechniqueName": "File Deletion"
}
{
  "Detection": [
    "Technique",
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Alert",
    "Correlated",
    "Correlated"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) called \"File Deletion - sdelete execution\"  was generated due to Sdelete64.exe deleting Draft.zip. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.",
    "A Technique alert detection (red indicator) for secure delete of sensitive data was generated due to Sdelete64.exe deleting Draft.Zip. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.",
    "Telemetry showed sdelete.exe running with command-line arguments and subsequently writing to and deleting the file. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious."
  ],
  "Procedure": "Deleted Draft.zip on disk using SDelete",
  "Step": "4.B.3",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1107",
  "TechniqueName": "File Deletion"
}
{
  "Detection": [
    "Technique",
    "Technique",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Alert",
    "Correlated",
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) called \"File Deletion - sdelete execution\" was generated due to Sdelete64.exe deleting SysinternalsSuite.zip. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.",
    "A Technique alert detection (red indicator) for secure delete of sensitive data was generated due to Sdelete64.exe deleting SysinternalsSuite.zip. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.",
    "An MSSP detection was generated for the of SysinternalsSuite.zip.",
    "Telemetry showed sdelete.exe running with command-line arguments and subsequently writing to and deleting the file. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious."
  ],
  "Procedure": "Deleted SysinternalsSuite.zip on disk using SDelete",
  "Step": "4.B.4",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1107",
  "TechniqueName": "File Deletion"
}
{
  "Detection": [
    "Technique",
    "Technique",
    "General",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Alert",
    "Correlated",
    "Alert",
    "Correlated",
    "Correlated"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) called File Deletion was generated when sdelete64.exe with command-line arguments was used to delete Rar.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution.",
    "A Technique alert detection (red indicator) for secure delete of sensitive data was generated due to Sdelete64.exe deleting Rar.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution.",
    "A General alert detection (red indicator) for potential malware was generated for cmd.exe running multiple commands on behalf of python.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution.",
    "Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution."
  ],
  "Procedure": "Deleted rar.exe on disk using SDelete",
  "Step": "9.C.1",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1107",
  "TechniqueName": "File Deletion"
}
{
  "Detection": [
    "Technique",
    "Technique",
    "General",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Correlated",
    "Alert",
    "Alert",
    "Correlated",
    "Correlated"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) called File Deletion was generated when sdelete64.exe with command-line arguments was used to delete Desktop\\working.zip. The detection was correlated to a parent alert on psexesvc.exe for service execution.",
    "A Technique alert detection (red indicator) for secure delete of sensitive data was generated due to Sdelete64.exe deleting Desktop\\working.zip. The detection was correlated to a parent alert on psexesvc.exe for service execution.",
    "A General alert detection (red indicator) for potential malware was generated for cmd.exe running multiple commands on behalf of python.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution.",
    "Telemetry showed sdelete64.exe with command-line arguments to delete Desktop\\working.zip. The detection was correlated to a parent alert on psexesvc.exe for service execution."
  ],
  "Procedure": "Deleted working.zip (from Desktop) on disk using SDelete",
  "Step": "9.C.2",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1107",
  "TechniqueName": "File Deletion"
}
{
  "Detection": [
    "General",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Correlated"
  ],
  "DetectionText": [
    "A General alert detection (red indicator) for potential malware was generated for cmd.exe running multiple commands on behalf of python.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution.",
    "Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip. The detection was correlated to a parent alert on psexesvc.exe for service execution."
  ],
  "Procedure": "Deleted working.zip (from AppData directory) on disk using SDelete",
  "Step": "9.C.3",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1107",
  "TechniqueName": "File Deletion"
}
{
  "Detection": [
    "General",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Correlated"
  ],
  "DetectionText": [
    "A General alert detection (red indicator) for potential malware was generated for cmd.exe running multiple commands on behalf of python.exe. The detection was correlated to a parent alert on psexesvc.exe for service execution.",
    "Telemetry showed cmd.exe deleting sdelete64.exe and filemod(delete) event. The detection was correlated to a parent alert on psexesvc.exe for service execution."
  ],
  "Procedure": "Deleted SDelete on disk using cmd.exe del command",
  "Step": "9.C.4",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1107",
  "TechniqueName": "File Deletion"
}
{
  "Detection": [
    "N/A"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Due to execution inconsistencies Step 19 has been omitted from the evaluation results."
  ],
  "Procedure": "Deleted Mimikatz (m.exe) on disk using SDelete",
  "Step": "19.A.1",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1107",
  "TechniqueName": "File Deletion"
}
{
  "Detection": [
    "N/A"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Due to execution inconsistencies Step 19 has been omitted from the evaluation results."
  ],
  "Procedure": "Deleted exfiltrated data on disk using SDelete",
  "Step": "19.B.1",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1107",
  "TechniqueName": "File Deletion"
}
{
  "Detection": [
    "N/A"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Due to execution inconsistencies Step 19 has been omitted from the evaluation results."
  ],
  "Procedure": "Deleted staged data on disk using SDelete",
  "Step": "19.C.1",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1107",
  "TechniqueName": "File Deletion"
}
{
  "Detection": [
    "Technique",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator)  called \"Screen Capture using Powershell\" was generated for a powershell.exe modload for gdiplus.dll. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.",
    "An MSSP detection was generated containing evidence of PowerShell capturing screenshots.",
    "Telemetry showed powershell.exe executing CopyFromScreen from System.Drawing.dll. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious."
  ],
  "Procedure": "Captured and saved screenshots using PowerShell",
  "Step": "7.A.1",
  "TacticGroup": "Collection",
  "Technique": "T1113",
  "TechniqueName": "Screen Capture"
}
{
  "Detection": [
    "Technique",
    "General",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert",
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) called \"Fileless Reconnaissance of Outlook Folder data\"  was generated for powershell.exe interacting with Outlook.",
    "A General alert detection (red indicator) called \"Suspicious loading of Outlook .NET assembly\"  was generated for powershell.exe interacting with an Outlook DLL.",
    "An MSSP detection occurred containing evidence of PowerShell collecting emails.",
    "Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe."
  ],
  "Procedure": "Dumped messages from the local Outlook inbox using PowerShell",
  "Step": "17.A.1",
  "TacticGroup": "Collection",
  "Technique": "T1114",
  "TechniqueName": "Email Collection"
}
{
  "Detection": [
    "General",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Correlated"
  ],
  "DetectionText": [
    "A General alert detection was generated for the execution of the PowerShell executing a fileless script or command. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.",
    "Telemetry showed PowerShell extracting and executing the code embedded within monkey.png. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious."
  ],
  "Procedure": "Embedded PowerShell payload in monkey.png using steganography",
  "Step": "3.A.2",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1027",
  "TechniqueName": "Obfuscated Files or Information"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell writing encoded content into the WMI class. The detection was correlated to a parent alert for Windows Management Instrumentation."
  ],
  "Procedure": "Encoded and wrote Mimikatz output to a WMI class property using PowerShell",
  "Step": "14.B.5",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1027",
  "TechniqueName": "Obfuscated Files or Information"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell appending the GIF file header to the compressed file. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe."
  ],
  "Procedure": "Prepended the GIF file header to a compressed staging file using PowerShell",
  "Step": "17.C.2",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1027",
  "TechniqueName": "Obfuscated Files or Information"
}
{
  "Detection": [
    "General",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "A General alert detection (red indicator) was generated for \"PFX Extraction via PowerShell\" on filemod of the $RandomFileName.pfx file. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.",
    "An MSSP detection was generated for a file create event of $RandomFileName.pfx file by powershell.exe. ",
    "Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious."
  ],
  "Procedure": "Exported a local certificate to a PFX file using PowerShell",
  "Step": "6.B.1",
  "TacticGroup": "Credential Access",
  "Technique": "T1145",
  "TechniqueName": "Private Keys"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe connecting to 192.168.0.5 on TCP port 443. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious."
  ],
  "Procedure": "Established C2 channel (192.168.0.5) via PowerShell payload over TCP port 443",
  "Step": "3.B.3",
  "TacticGroup": "Command and Control",
  "Technique": "T1043",
  "TechniqueName": "Commonly Used Port"
}
{
  "Detection": [
    "General",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "A General alert detection (red indicator) was generated for .NET attempting to make suspicious network connections.",
    "Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over TCP port 443."
  ],
  "Procedure": "Established C2 channel (192.168.0.4) via PowerShell payload over port 443",
  "Step": "11.A.13",
  "TacticGroup": "Command and Control",
  "Technique": "T1043",
  "TechniqueName": "Commonly Used Port"
}
{
  "Detection": [
    "Technique",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) was generated for PowerShell establishing WMI event subscription persistence.",
    "An MSSP detection occurred containing evidence of PowerShell establishing WMI event subscription persistence.",
    "Telemetry showed the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe."
  ],
  "Procedure": "Established WMI event subscription persistence using PowerShell",
  "Step": "15.A.2",
  "TacticGroup": "Persistence",
  "Technique": "T1084",
  "TechniqueName": "Windows Management Instrumentation Event Subscription"
}
{
  "Detection": [
    "Technique",
    "Technique",
    "General",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert",
    "Alert"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) was generated for a PowerShell with network connections launched by WMI.",
    "A Technique alert detection (red indicator) was generated for Windows Management Instrumentation based on wmiprvse.exe executing PowerShell stager.",
    "A General alert detection was generated for PowerShell having an unusual parent.",
    "Telemetry showed wmiprvse.exe executing the PowerShell stager."
  ],
  "Procedure": "Executed WMI persistence on user login",
  "Step": "20.A.2",
  "TacticGroup": "Persistence",
  "Technique": "T1084",
  "TechniqueName": "Windows Management Instrumentation Event Subscription"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "Manipulated the token of the PowerShell payload via the CreateProcessWithToken API",
  "Step": "10.B.3",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1134",
  "TechniqueName": "Access Token Manipulation"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "An MSSP detection was generated for the use of ChildItem. ",
    "Telemetry showed powershell.exe executing ChildItem. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious."
  ],
  "Procedure": "Searched filesystem for document and media files using PowerShell\u00a0",
  "Step": "2.A.1",
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "TechniqueName": "File and Directory Discovery"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [
    "Host Interrogation",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation."
  ],
  "Procedure": "Enumerated user's temporary directory path using PowerShell",
  "Step": "4.C.1",
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "TechniqueName": "File and Directory Discovery"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing ChildItem. The detection was correlated to a parent alert on psexesvc.exe for service execution."
  ],
  "Procedure": "Searched filesystem for document and media files using PowerShell",
  "Step": "9.B.2",
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "TechniqueName": "File and Directory Discovery"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed PowerShell executing Get-Item for the current path."
  ],
  "Procedure": "Checked that the payload is not inside a folder path that contains \"sample\" or is the length of a hash value using PowerShell",
  "Step": "11.A.9",
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "TechniqueName": "File and Directory Discovery"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell enumeration of System32. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe."
  ],
  "Procedure": "Enumerated the System32 directory using PowerShell",
  "Step": "12.A.1",
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "TechniqueName": "File and Directory Discovery"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "An MSSP detection was generated for the Registry Modification of the command subkey.",
    "Telemetry showed the Registry modifications of the DelegateExecute \u200bRegistry value. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious."
  ],
  "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell",
  "Step": "3.B.1",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1122",
  "TechniqueName": "Component Object Model Hijacking"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of the addition of the DelegateExecute Registry value.",
    "Telemetry showed the addition of the DelegateExecute Registry value. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe."
  ],
  "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell",
  "Step": "14.A.1",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1122",
  "TechniqueName": "Component Object Model Hijacking"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [
    "Host Interrogation",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation."
  ],
  "Procedure": "Enumerated the current domain name using PowerShell",
  "Step": "4.C.4",
  "TacticGroup": "Discovery",
  "Technique": "T1016",
  "TechniqueName": "System Network Configuration Discovery"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem."
  ],
  "Procedure": "Checked that the computer is joined to a domain using PowerShell",
  "Step": "11.A.7",
  "TacticGroup": "Discovery",
  "Technique": "T1016",
  "TechniqueName": "System Network Configuration Discovery"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell calling the NetWkstaGetInfo API. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe."
  ],
  "Procedure": "Enumerated the domain name using the NetWkstaGetInfo API",
  "Step": "13.B.1",
  "TacticGroup": "Discovery",
  "Technique": "T1016",
  "TechniqueName": "System Network Configuration Discovery"
}
{
  "Detection": [
    "General",
    "General",
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert",
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "A General alert detection (red indicator) was generated for a Credential Theft Application Running. ",
    "A General alert detection (red indicator) was generated for PowerShell running Mimikatz.",
    "An MSSP detection occurred containing evidence of PowerShell executing Invoke-Mimikatz to create and inject a golden ticket into the current session.",
    "Telemetry showed the contents of the Invoke-Mimikatz script along with PowerShell executing Invoke-Mimikatz to create and inject a golden ticket into the current session. The detection was correlated to a parent alert for Windows Management Instrumentation."
  ],
  "Procedure": "Created Kerberos Golden Ticket using\u00a0Invoke-Mimikatz",
  "Step": "20.B.1",
  "TacticGroup": "Lateral Movement",
  "Technique": "T1097",
  "TechniqueName": "Pass the Ticket"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 135. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious."
  ],
  "Procedure": "Established SMB session to remote host Scranton's (10.0.1.4) IPC$ share using PsExec",
  "Step": "8.C.2",
  "TacticGroup": "Lateral Movement",
  "Technique": "T1077",
  "TechniqueName": "Windows Admin Shares"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [
    "Host Interrogation",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "No detection capability demonstrated for this procedure, though a manual query for the showed the new service and the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation."
  ],
  "Procedure": "Created a new service (javamtsup) that executes a service binary (javamtsup.exe) at system startup",
  "Step": "5.A.1",
  "TacticGroup": "Persistence",
  "Technique": "T1050",
  "TechniqueName": "New Service"
}
{
  "Detection": [
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Correlated"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) called \"Data Compressed via Command Interpreter for Staging\" was generated for a file modification with the .zip extension. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious.",
    "Telemetry showed powershell.exe compressing via Compress-Archive. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious."
  ],
  "Procedure": "Compressed and stored files into ZIP (Draft.zip) using PowerShell",
  "Step": "2.A.4",
  "TacticGroup": "Exfiltration",
  "Technique": "T1002",
  "TechniqueName": "Data Compressed"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed the file creation event for OfficeSupplies.7z. The detection was correlated to a parent alert identifying rcs.3aka3.doc as suspicious."
  ],
  "Procedure": "Compressed\u00a0data from the user's Downloads directory into a ZIP file (OfficeSupplies.7z) using PowerShell",
  "Step": "7.B.2",
  "TacticGroup": "Exfiltration",
  "Technique": "T1002",
  "TechniqueName": "Data Compressed"
}
{
  "Detection": [
    "Technique",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated"
  ],
  "DetectionText": [
    "A Technique alert detection (red indicator) called \"Data Compressed via Command Interpreter for Staging\" was generated due to powershell.exe executing rar.exe creating a filemod event for working.zip.",
    "Telemetry showed powershell.exe executing rar.exe with command-line arguments. The detection was correlated to a parent alert on psexesvc.exe for service execution."
  ],
  "Procedure": "Compressed staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe",
  "Step": "9.B.7",
  "TacticGroup": "Exfiltration",
  "Technique": "T1002",
  "TechniqueName": "Data Compressed"
}
{
  "Detection": [
    "MSSP",
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Correlated"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of PowerShell compressed a staging directory.",
    "Telemetry showed PowerShell compressing collection via the ZipFile.CreateFromDirectory .NET method. The detection was correlated to a parent alert for bypassing UAC with sdclt.exe."
  ],
  "Procedure": "Compressed a staging directory using PowerShell",
  "Step": "17.C.1",
  "TacticGroup": "Exfiltration",
  "Technique": "T1002",
  "TechniqueName": "Data Compressed"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed the PowerShell gwmi query for Win32_BIOS."
  ],
  "Procedure": "Checked that the BIOS version and serial number are not associated with VirtualBox or VMware using PowerShell",
  "Step": "11.A.3",
  "TacticGroup": "Discovery",
  "Technique": "T1497",
  "TechniqueName": "Virtualization/Sandbox Evasion"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "Read and downloaded ZIP (Draft.zip) over C2 channel (192.168.0.5 over TCP port 1234)",
  "Step": "2.B.1",
  "TacticGroup": "Exfiltration",
  "Technique": "T1041",
  "TechniqueName": "Exfiltration Over Command and Control Channel"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "No detection capability demonstrated for this procedure."
  ],
  "Procedure": "Read and downloaded ZIP (working.zip on Desktop) over C2 channel (192.168.0.5 over TCP port 8443)",
  "Step": "9.B.8",
  "TacticGroup": "Exfiltration",
  "Technique": "T1041",
  "TechniqueName": "Exfiltration Over Command and Control Channel"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [
    "Host Interrogation",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation."
  ],
  "Procedure": "Enumerated anti-virus software using PowerShell",
  "Step": "4.C.7",
  "TacticGroup": "Discovery",
  "Technique": "T1063",
  "TechniqueName": "Security Software Discovery"
}
{
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [
    "Host Interrogation",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "No detection capability demonstrated for this procedure, though the script containing the variables in scope was manually recovered from the AMSI execution log locally on the sensor, so it is identified as Host Interrogation."
  ],
  "Procedure": "Enumerated firewall software using PowerShell",
  "Step": "4.C.8",
  "TacticGroup": "Discovery",
  "Technique": "T1063",
  "TechniqueName": "Security Software Discovery"
}
{
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell gwmi query for AntiVirusProduct. The detection was correlated to a parent alert for the execution of powershell.exe from explorer.exe."
  ],
  "Procedure": "Enumerated registered AV products using PowerShell",
  "Step": "12.B.1",
  "TacticGroup": "Discovery",
  "Technique": "T1063",
  "TechniqueName": "Security Software Discovery"
}
