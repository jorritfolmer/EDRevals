{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "The rcs.3aka3.doc process spawning from explorer.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed explorer.exe executing rcs.3aka3.doc.",
    "A Technique alert detection (yellow; medium severity) called \"User Execution\" was generated due to execution of rcs.3aka3.doc file by explorer.exe.",
    "An MSSP detection contained evidence of \"User Execution\" due to execution of rcs.3aka3.doc by explorer.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "User Pam executed payload rcs.3aka3.doc",
  "ScreenshotDatasources": [],
  "Step": "1. Initial Compromise",
  "Substep": "1.A.1",
  "Subtechnique": "T1204.002",
  "Subtechnique_Name": "User Execution: Malicious File",
  "TacticGroup": "Execution",
  "Technique": "T1204",
  "Technique_Name": "User Execution"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Evidence of the right-to-left override character (U+202E) in the rcs.3aka.doc process OR the original filename (cod.3aka.scr)",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed the original filename cod.3aka.scr as well as the RTLO ASCII characters.",
    "A Technique alert detection (yellow; medium severity) called Masquerading was generated due to altered file name by the RTLO character.",
    "An MSSP detection contained evidence of \"Defense Evasion\" contained evidence of RTLO character in rcs.3aka.doc."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Used unicode right-to-left override (RTLO) character to obfuscate file name rcs.3aka3.doc (originally cod.3aka.scr)",
  "ScreenshotDatasources": [],
  "Step": "1. Initial Compromise",
  "Substep": "1.A.2",
  "Subtechnique": "T1036.002",
  "Subtechnique_Name": "Masquerading: Right-to-Left Override",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1036",
  "Technique_Name": "Masquerading"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Established network channel over port 1234",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed the rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Established C2 channel (192.168.0.5) via rcs.3aka3.doc payload over TCP port 1234",
  "ScreenshotDatasources": [],
  "Step": "1. Initial Compromise",
  "Substep": "1.A.3",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1095",
  "Technique_Name": "Non-Application Layer Protocol"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Evidence that the network data sent over the C2 channel is encrypted",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Used RC4 stream cipher to encrypt C2 (192.168.0.5) traffic",
  "ScreenshotDatasources": [],
  "Step": "1. Initial Compromise",
  "Substep": "1.A.4",
  "Subtechnique": "T1573.001",
  "Subtechnique_Name": "Encrypted Channel: Symmetric Cryptography",
  "TacticGroup": "Command and Control",
  "Technique": "T1573",
  "Technique_Name": "Encrypted Channel"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "cmd.exe spawning from the rcs.3aka3.doc process",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed rcs.3aka3.doc spawning from cmd.exe.",
    "A Technique alert detection (yellow; medium severity) called  \"Command Line Interface\" was generated due to cmd.exe spawning from rcs.3aka3.doc.",
    "An MSSP detection contained evidence of rcs.3aka3.doc spawning cmd.exe"
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Spawned interactive cmd.exe",
  "ScreenshotDatasources": [],
  "Step": "1. Initial Compromise",
  "Substep": "1.B.1",
  "Subtechnique": "T1059.003",
  "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe spawning from cmd.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe spawning from cmd.exe.",
    "A Technique alert detection (yellow; medium severity) called PowerShell was generated due to the execution of powershell.exe by cmd.exe. The alert was correlated to a parent alert for command line execution.",
    "An MSSP detection contained evidence of cmd.exe spawning powershell.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Spawned interactive powershell.exe",
  "ScreenshotDatasources": [],
  "Step": "1. Initial Compromise",
  "Substep": "1.B.2",
  "Subtechnique": "T1059.001",
  "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing (Get-)ChildItem",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Searched filesystem for document and media files using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "2. Collection and Exfiltration",
  "Substep": "2.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "Technique_Name": "File and Directory Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing (Get-)ChildItem",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Scripted search of filesystem for document and media files using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "2. Collection and Exfiltration",
  "Substep": "2.A.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Collection",
  "Technique": "T1119",
  "Technique_Name": "Automated Collection"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe reading files in C:\\Users\\Pam\\",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "2. Collection and Exfiltration",
  "Substep": "2.A.3",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Collection",
  "Technique": "T1005",
  "Technique_Name": "Data from Local System"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Compress-Archive",
  "Datasources": [],
  "Detection": [
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Configuration Change (Detections)",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection (green indicator; low severity) called Data Compressed was generated due to the creation of Draft.Zip by powershell.exe.",
    "An MSSP detection contained evidence of draft.zip being created and compressed by PowerShell."
  ],
  "Footnotes": [
    "Additional PowerShell logging was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change."
  ],
  "Participant_Name": "kaspersky",
  "Procedure": "Compressed and stored files into ZIP (Draft.zip) using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "2. Collection and Exfiltration",
  "Substep": "2.A.4",
  "Subtechnique": "T1560.001",
  "Subtechnique_Name": "Archive Collected Data: Archive via Utility",
  "TacticGroup": "Collection",
  "Technique": "T1560",
  "Technique_Name": "Archive Collected Data"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe creating the file draft.zip",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed the creation of Draft.Zip. The event was correlated to a parent Technique detection for a suspicious PowerShell process.",
    "An MSSP detection contained evidence of the creation of Draft.Zip by powershell.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Staged files for exfiltration into ZIP (Draft.zip) using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "2. Collection and Exfiltration",
  "Substep": "2.A.5",
  "Subtechnique": "T1560.001",
  "Subtechnique_Name": "Archive Collected Data: Archive via Utility",
  "TacticGroup": "Collection",
  "Technique": "T1560",
  "Technique_Name": "Archive Collected Data"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "The rcs.3aka3.doc process reading the file draft.zip while connected to the C2 channel",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Read and downloaded ZIP (Draft.zip) over C2 channel (192.168.0.5 over TCP port 1234)",
  "ScreenshotDatasources": [],
  "Step": "2. Collection and Exfiltration",
  "Substep": "2.B.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Exfiltration",
  "Technique": "T1041",
  "Technique_Name": "Exfiltration Over Command and Control Channel"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "The rcs.3aka3.doc process creating the file monkey.png",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed rcs.3aka3.doc creating monkey.png. The event was correlated to a parent detection for masquerading."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Dropped stage 2 payload (monkey.png) to disk",
  "ScreenshotDatasources": [],
  "Step": "3. Deploy Stealth Toolkit",
  "Substep": "3.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Evidence that a PowerShell payload was within monkey.png",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell extracting and executing the code embedded within monkey.png.",
    "A Technique alert detection (red; high severity) for suspicious command-line obfuscation was generated for PowerShell extracting and executing the code embedded within monkey.png. The detection was correlated to a parent alert for suspicious PowerShell.",
    "An MSSP detection contained evidence of a PowerShell script in monkey.png."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Embedded PowerShell payload in monkey.png using steganography",
  "ScreenshotDatasources": [],
  "Step": "3. Deploy Stealth Toolkit",
  "Substep": "3.A.2",
  "Subtechnique": "T1027.003",
  "Subtechnique_Name": "Obfuscated Files or Information: Steganography",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1027",
  "Technique_Name": "Obfuscated Files or Information"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Addition of the DelegateExecute subkey in HKCU\\Software\\Classes\\Folder\\shell\\open\\command",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection contained evidence of the addition of DelegateExecute value in the Registry."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "3. Deploy Stealth Toolkit",
  "Substep": "3.B.1",
  "Subtechnique": "T1546.015",
  "Subtechnique_Name": "Event Triggered Execution: Component Object Model Hijacking",
  "TacticGroup": "Privilege Escalation",
  "Technique": "T1546",
  "Technique_Name": "Event Triggered Execution"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "High integrity powershell.exe spawning from control.exe (spawned from sdclt.exe)",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "General",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell spawning from control.exe.",
    "A General alert detection (red; high severity) for \"Suspicious PowerShell\" was generated due to execution of powershell.exe by control.exe.",
    "An MSSP detection for \"Possible UAC Bypass\" contained evidence of a new highiIntegrity PowerShell callback spawning from control.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Executed elevated PowerShell payload",
  "ScreenshotDatasources": [],
  "Step": "3. Deploy Stealth Toolkit",
  "Substep": "3.B.2",
  "Subtechnique": "T1548.002",
  "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control",
  "TacticGroup": "Privilege Escalation",
  "Technique": "T1548",
  "Technique_Name": "Abuse Elevation Control Mechanism"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Established network channel over port 443",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe connecting to 192.168.0.5 on port 443.",
    "A Technique alert detection (red; high severity) called \"Commonly Used Port\" was generated due to powershell.exe connecting to 192.168.0.5 on TCP 443."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Established C2 channel (192.168.0.5) via PowerShell payload over TCP port 443",
  "ScreenshotDatasources": [],
  "Step": "3. Deploy Stealth Toolkit",
  "Substep": "3.B.3",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1043",
  "Technique_Name": "Commonly Used Port"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Evidence that the network data sent over the C2 channel is HTTPS",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [
    "Although telemetry showed a network connection over port 443 no protocol was identified for this traffic, so a detection does not apply."
  ],
  "Participant_Name": "kaspersky",
  "Procedure": "Used HTTPS to transport C2 (192.168.0.5) traffic",
  "ScreenshotDatasources": [],
  "Step": "3. Deploy Stealth Toolkit",
  "Substep": "3.B.4",
  "Subtechnique": "T1071.001",
  "Subtechnique_Name": "Application Layer Protocol: Web Protocols",
  "TacticGroup": "Command and Control",
  "Technique": "T1071",
  "Technique_Name": "Application Layer Protocol"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Evidence that the network data sent over the C2 channel is encrypted",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [
    "Although telemetry showed a network connection over port 443 no protocol was identified for this traffic, so a detection does not apply."
  ],
  "Participant_Name": "kaspersky",
  "Procedure": "Used HTTPS to encrypt C2 (192.168.0.5) traffic",
  "ScreenshotDatasources": [],
  "Step": "3. Deploy Stealth Toolkit",
  "Substep": "3.B.5",
  "Subtechnique": "T1573.002",
  "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography",
  "TacticGroup": "Command and Control",
  "Technique": "T1573",
  "Technique_Name": "Encrypted Channel"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Deletion of of the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command subkey",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Modified the Registry to remove artifacts of COM hijacking",
  "ScreenshotDatasources": [],
  "Step": "3. Deploy Stealth Toolkit",
  "Substep": "3.C.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Defense Evasion",
  "Technique": "T1112",
  "Technique_Name": "Modify Registry"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe creating the file SysinternalsSuite.zip",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed the file write of the ZIP by PowerShell. The detection was correlated to a parent alert for suspicious PowerShell.",
    "An MSSP detection contained evidence of the file write of the ZIP by PowerShell."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Dropped additional tools (SysinternalsSuite.zip) to disk over C2 channel (192.168.0.5)",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe spawning from powershell.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Alert",
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed a new powershell.exe spawning from powershell.exe. The detection  was correlated to a parent alert for suspicious PowerShell.",
    "A Technique alert detection (yellow; medium severity) called \"PowerShell\" was generated due to powershell.exe spawning a new powershell.exe. The detection  was correlated to a parent alert for suspicious PowerShell.",
    "An MSSP detection occurred containing evidence of powershell.exe spawning from powershell.exe and indicated the new PowerShell process was a meterpreter shell."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Spawned interactive powershell.exe",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.A.2",
  "Subtechnique": "T1059.001",
  "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Expand-Archive",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed PowerShell writing the files that were decompressed from the ZIP.",
    "An MSSP detection occurred containing evidence of powershell.exe decompressing SysinternalsSuite.zip via Expand-Archive."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Decompressed ZIP (SysinternalsSuite.zip) file using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.A.3",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Defense Evasion",
  "Technique": "T1140",
  "Technique_Name": "Deobfuscate/Decode Files or Information"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Get-Process",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Enumerated current running processes using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.B.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "Technique_Name": "Process Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "sdelete64.exe deleting the file rcs.3aka3.doc",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed sdelete.exe running with command-line arguments to delete the file.",
    "An MSSP detection contained evidence of sdelete64.exe deleting rcs.3aka3.doc."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Deleted rcs.3aka3.doc on disk using SDelete",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.B.2",
  "Subtechnique": "T1070.004",
  "Subtechnique_Name": "Indicator Removal on Host: File Deletion",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1070",
  "Technique_Name": "Indicator Removal on Host"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "sdelete64.exe deleting the file draft.zip",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed sdelete.exe running with command-line arguments to delete the file.",
    "An MSSP detection contained evidence of sdelete64.exe deleting Draft.Zip."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Deleted Draft.zip on disk using SDelete",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.B.3",
  "Subtechnique": "T1070.004",
  "Subtechnique_Name": "Indicator Removal on Host: File Deletion",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1070",
  "Technique_Name": "Indicator Removal on Host"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "sdelete64.exe deleting the file SysinternalsSuite.zip",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed sdelete.exe running with command-line arguments to delete the file.",
    "An MSSP detection contained evidence of sdelete64.exe deleting SysinternalsSuite.zip."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Deleted SysinternalsSuite.zip on disk using SDelete",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.B.4",
  "Subtechnique": "T1070.004",
  "Subtechnique_Name": "Indicator Removal on Host: File Deletion",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1070",
  "Technique_Name": "Indicator Removal on Host"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing $env:TEMP",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Enumerated user's temporary directory path using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "Technique_Name": "File and Directory Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing $env:USERNAME",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Enumerated the current username using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1033",
  "Technique_Name": "System Owner/User Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing $env:COMPUTERNAME",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Enumerated the computer hostname using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.3",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1082",
  "Technique_Name": "System Information Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing $env:USERDOMAIN",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Enumerated the current domain name using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.4",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1016",
  "Technique_Name": "System Network Configuration Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing $PID",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Enumerated the current process ID using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.5",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "Technique_Name": "Process Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Gwmi Win32_OperatingSystem",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Enumerated the OS version using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.6",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1082",
  "Technique_Name": "System Information Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Get-WmiObject ... -Class AntiVirusProduct",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Enumerated anti-virus software using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.7",
  "Subtechnique": "T1518.001",
  "Subtechnique_Name": "Software Discovery: Security Software Discovery",
  "TacticGroup": "Discovery",
  "Technique": "T1518",
  "Technique_Name": "Software Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Get-WmiObject ... -Class FireWallProduct",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Enumerated firewall software using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.8",
  "Subtechnique": "T1518.001",
  "Subtechnique_Name": "Software Discovery: Security Software Discovery",
  "TacticGroup": "Discovery",
  "Technique": "T1518",
  "Technique_Name": "Software Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing the NetUserGetGroups API",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Enumerated user's domain group membership via the NetUserGetGroups API",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.9",
  "Subtechnique": "T1069.002",
  "Subtechnique_Name": "Permission Groups Discovery: Domain Groups",
  "TacticGroup": "Discovery",
  "Technique": "T1069",
  "Technique_Name": "Permission Groups Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "The NetUserGetGroups API function loaded into powershell.exe from Netapi32.dll",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Executed API call by reflectively loading Netapi32.dll",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.10",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Execution",
  "Technique": "T1106",
  "Technique_Name": "Native API"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing the NetUserGetLocalGroups API",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Enumerated user's local group membership via the NetUserGetLocalGroups API",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.11",
  "Subtechnique": "T1069.001",
  "Subtechnique_Name": "Permission Groups Discovery: Local Groups",
  "TacticGroup": "Discovery",
  "Technique": "T1069",
  "Technique_Name": "Permission Groups Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "The NetUserGetLocalGroups API function loaded into powershelle.exe from Netapi32.dll",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Executed API call by reflectively loading Netapi32.dll",
  "ScreenshotDatasources": [],
  "Step": "4. Clean Up and Reconnaissance",
  "Substep": "4.C.12",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Execution",
  "Technique": "T1106",
  "Technique_Name": "Native API"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe creating the Javamtsup service",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed a registry event for the creation of javamtsup service. The event was correlated to a parent General detection for suspicious PowerShell.",
    "An MSSP detection contained evidence of the creation of the javamtsup service."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Created a new service (javamtsup) that executes a service binary (javamtsup.exe) at system startup",
  "ScreenshotDatasources": [],
  "Step": "5. Establish Persistence",
  "Substep": "5.A.1",
  "Subtechnique": "T1543.003",
  "Subtechnique_Name": "Create or Modify System Process: Windows Service",
  "TacticGroup": "Persistence",
  "Technique": "T1543",
  "Technique_Name": "Create or Modify System Process"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe creating the file hostui.lnk in the Startup folder",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe creating the hostui.lnk file in the Startup folder. The event was correlated to a parent General detection for suspicious PowerShell.",
    "An MSSP detection contained evidence of the creation of hostui.lnk."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Created a LNK file (hostui.lnk) in the Startup folder that executes on login",
  "ScreenshotDatasources": [],
  "Step": "5. Establish Persistence",
  "Substep": "5.B.1",
  "Subtechnique": "T1547.001",
  "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder",
  "TacticGroup": "Persistence",
  "Technique": "T1547",
  "Technique_Name": "Boot or Logon Autostart Execution"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "accesschk.exe reading files within %APPDATALOCAL%\\Google\\chrome\\user data\\default\\",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Read the Chrome SQL database file to extract encrypted credentials",
  "ScreenshotDatasources": [],
  "Step": "6. Credential Access",
  "Substep": "6.A.1",
  "Subtechnique": "T1552.001",
  "Subtechnique_Name": "Unsecured Credentials: Credentials in Files",
  "TacticGroup": "Credential Access",
  "Technique": "T1552",
  "Technique_Name": "Unsecured Credentials"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "accesschk.exe executing the CryptUnprotectedData API",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Executed the CryptUnprotectedData API call to decrypt Chrome passwords",
  "ScreenshotDatasources": [],
  "Step": "6. Credential Access",
  "Substep": "6.A.2",
  "Subtechnique": "T1555.003",
  "Subtechnique_Name": "Credentials from Password Stores: Credentials from Web Browsers",
  "TacticGroup": "Credential Access",
  "Technique": "T1555",
  "Technique_Name": "Credentials from Password Stores"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Evidence that accesschk.exe is not the legitimate Sysinternals tool",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed hash of accesschk.exe which can be used to verify it is not the legitimate Sysinternals tool.",
    "An MSSP detection contained evidence showing accesschk.exe is not the legitimate Sysinternals tool."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Masqueraded a Chrome password dump tool as accesscheck.exe, a legitimate Sysinternals tool",
  "ScreenshotDatasources": [],
  "Step": "6. Credential Access",
  "Substep": "6.A.3",
  "Subtechnique": "T1036.005",
  "Subtechnique_Name": "Masquerading: Match Legitimate Name or Location",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1036",
  "Technique_Name": "Masquerading"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe creating a certificate file exported from the system",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe. The event was correlated to a parent General detection for suspicious PowerShell."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Exported a local certificate to a PFX file using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "6. Credential Access",
  "Substep": "6.B.1",
  "Subtechnique": "T1552.004",
  "Subtechnique_Name": "Unsecured Credentials: Private Keys",
  "TacticGroup": "Credential Access",
  "Technique": "T1552",
  "Technique_Name": "Unsecured Credentials"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe injecting into lsass.exe OR lsass.exe reading Registry keys under HKLM:\\SAM\\SAM\\Domains\\Account\\Users\\",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [
    "Unable to test because execution blocked by the vendor solution."
  ],
  "Participant_Name": "kaspersky",
  "Procedure": "Dumped password hashes from the Windows Registry by injecting a malicious DLL into Lsass.exe",
  "ScreenshotDatasources": [],
  "Step": "6. Credential Access",
  "Substep": "6.C.1",
  "Subtechnique": "T1003.002",
  "Subtechnique_Name": "OS Credential Dumping: Security Account Manager",
  "TacticGroup": "Credential Access",
  "Technique": "T1003",
  "Technique_Name": "OS Credential Dumping"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing the CopyFromScreen function from System.Drawing.dll",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection contained evidence of PowerShell loading .Net assemblies to capture screenshots."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Captured and saved screenshots using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "7. Collection and Exfiltration",
  "Substep": "7.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Collection",
  "Technique": "T1113",
  "Technique_Name": "Screen Capture"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Get-Clipboard",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Captured clipboard contents using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "7. Collection and Exfiltration",
  "Substep": "7.A.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Collection",
  "Technique": "T1115",
  "Technique_Name": "Clipboard Data"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing the GetAsyncKeyState API",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection contained evidence of PowerShell loading .NET assemblies to capture key strokes."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Captured user keystrokes using the GetAsyncKeyState API",
  "ScreenshotDatasources": [],
  "Step": "7. Collection and Exfiltration",
  "Substep": "7.A.3",
  "Subtechnique": "T1056.001",
  "Subtechnique_Name": "Input Capture: Keylogging",
  "TacticGroup": "Collection",
  "Technique": "T1056",
  "Technique_Name": "Input Capture"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe reading files in C:\\Users\\pam\\Downloads\\",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Read data in the user's Downloads directory using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "7. Collection and Exfiltration",
  "Substep": "7.B.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Collection",
  "Technique": "T1005",
  "Technique_Name": "Data from Local System"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe creating the file OfficeSupplies.7z",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Correlated"
  ],
  "DetectionText": [
    "Telemetry showed the file write event for OfficeSupplies.7z. The detection was correlated to a parent alert for suspicious PowerShell.",
    "An MSSP detection occurred containing evidence of the file create of OfficeSupplies.7z."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Compressed data from the user's Downloads directory into a ZIP file (OfficeSupplies.7z) using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "7. Collection and Exfiltration",
  "Substep": "7.B.2",
  "Subtechnique": "T1560.001",
  "Subtechnique_Name": "Archive Collected Data: Archive via Utility",
  "TacticGroup": "Collection",
  "Technique": "T1560",
  "Technique_Name": "Archive Collected Data"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Compress-7Zip with the password argument used for encryption",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Host Interrogation"
  ],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Encrypted data from the user's Downloads directory using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "7. Collection and Exfiltration",
  "Substep": "7.B.3",
  "Subtechnique": "T1560.001",
  "Subtechnique_Name": "Archive Collected Data: Archive via Utility",
  "TacticGroup": "Collection",
  "Technique": "T1560",
  "Technique_Name": "Archive Collected Data"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell executing Copy-Item pointing to an attack-controlled WebDav network share (192.168.0.4:80)",
  "Datasources": [],
  "Detection": [
    "None",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Host Interrogation",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure.",
    "An MSSP detection occurred containing evidence of OfficeSupplies.7z being uploaded to 192.168.0.4 using WebDav."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Exfiltrated collection (OfficeSupplies.7z) to WebDAV network share using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "7. Collection and Exfiltration",
  "Substep": "7.B.4",
  "Subtechnique": "T1048.003",
  "Subtechnique_Name": "Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol",
  "TacticGroup": "Exfiltration",
  "Technique": "T1048",
  "Technique_Name": "Exfiltration Over Alternative Protocol"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe making LDAP queries over port 389 to the Domain Controller (10.0.0.4)",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed powershell.exe establishing a connection to NewYork (10.0.0.4) over port 389."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Enumerated remote systems using LDAP queries",
  "ScreenshotDatasources": [],
  "Step": "8. Expand Access",
  "Substep": "8.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1018",
  "Technique_Name": "Remote System Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Network connection to Scranton (10.0.1.4) over port 5985",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "General"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "Telemetry showed a connection to Scranton (10.0.1.4) over port 5985.",
    "A General alert detection (red; high severity) was generated for \"PowerShell with network activity\"."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Established WinRM connection to remote host Scranton (10.0.1.4)",
  "ScreenshotDatasources": [],
  "Step": "8. Expand Access",
  "Substep": "8.A.2",
  "Subtechnique": "T1021.006",
  "Subtechnique_Name": "Remote Services: Windows Remote Management",
  "TacticGroup": "Lateral Movement",
  "Technique": "T1021",
  "Technique_Name": "Remote Services"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Get-Process",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Enumerated processes on remote host Scranton (10.0.1.4) using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "8. Expand Access",
  "Substep": "8.A.3",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "Technique_Name": "Process Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "The file python.exe created on Scranton (10.0.1.4)",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection contained evidence of remote file copy of python.exe to Scranton (10.0.1.4)."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Copied python.exe payload from a WebDAV share (192.168.0.4) to remote host Scranton (10.0.1.4)",
  "ScreenshotDatasources": [],
  "Step": "8. Expand Access",
  "Substep": "8.B.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Evidence that the file python.exe is packed",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)",
    "Host Interrogation"
  ],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "python.exe payload was packed with UPX",
  "ScreenshotDatasources": [],
  "Step": "8. Expand Access",
  "Substep": "8.B.2",
  "Subtechnique": "T1027.002",
  "Subtechnique_Name": "Obfuscated Files or Information: Software Packing",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1027",
  "Technique_Name": "Obfuscated Files or Information"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Successful logon as user Pam on Scranton (10.0.1.4)",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed a valid logon on Scranton (10.0.1.4) as user Pam.",
    "An MSSP detection occurred containing evidence of a valid logon on Scranton (10.0.1.4) as user Pam."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Logged on to remote host Scranton (10.0.1.4) using valid credentials for user Pam",
  "ScreenshotDatasources": [],
  "Step": "8. Expand Access",
  "Substep": "8.C.1",
  "Subtechnique": "T1078.002",
  "Subtechnique_Name": "Valid Accounts: Domain Accounts",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1078",
  "Technique_Name": "Valid Accounts"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "SMB session to Scranton (10.0.1.4) over TCP port 445/135 OR evidence of usage of a Windows share",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 135.",
    "An MSSP detection occurred containing evidence of psexec64 establishing an IPC share on Scranton (10.0.1.4)."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Established SMB session to remote host Scranton's (10.0.1.4) IPC$ share using PsExec",
  "ScreenshotDatasources": [],
  "Step": "8. Expand Access",
  "Substep": "8.C.2",
  "Subtechnique": "T1021.002",
  "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares",
  "TacticGroup": "Lateral Movement",
  "Technique": "T1021",
  "Technique_Name": "Remote Services"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "python.exe spawned by PSEXESVC.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed PSEXESVC.exe with command-line arguments to execute python.exe.",
    "An MSSP detection occurred containing evidence of the execution of psexecsvc.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Executed python.exe using PSExec",
  "ScreenshotDatasources": [],
  "Step": "8. Expand Access",
  "Substep": "8.C.3",
  "Subtechnique": "T1569.002",
  "Subtechnique_Name": "System Services: Service Execution",
  "TacticGroup": "Execution",
  "Technique": "T1569",
  "Technique_Name": "System Services"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "python.exe creating the file rar.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed a file create event for python.exe creating rar.exe.",
    "An MSSP detection contained evidence of the creation of rar.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Dropped rar.exe to disk on remote host Scranton (10.0.1.4)",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "python.exe creating the file sdelete64.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed a file create event for python.exe creating sdelete64.exe.",
    "An MSSP detection contained evidence of the creation of sdelete64.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Dropped sdelete.exe to disk on remote host Scranton (10.0.1.4)",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.A.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe spawning from python.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed python.exe executing powershell.exe.",
    "A Technique alert detection (yellow; medium severity) called \"T1086_PowerShell\" was generated due to python.exe spawning powershell.exe.",
    "An MSSP detection contained evidence of python spawning powershell.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Spawned interactive powershell.exe",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.B.1",
  "Subtechnique": "T1059.001",
  "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing (Get-)ChildItem",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Searched filesystem for document and media files using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.B.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "Technique_Name": "File and Directory Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing (Get-)ChildItem",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Scripted search of filesystem for document and media files using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.B.3",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Collection",
  "Technique": "T1119",
  "Technique_Name": "Automated Collection"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe reading files in C:\\Users\\Pam\\",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.B.4",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Collection",
  "Technique": "T1005",
  "Technique_Name": "Data from Local System"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe creating the file working.zip",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed a file create event for powershell.exe creating working.zip.",
    "An MSSP detection contained evidence of the creation of working.zip."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Staged files for exfiltration into ZIP (working.zip in AppData directory) using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.B.5",
  "Subtechnique": "T1074.001",
  "Subtechnique_Name": "Data Staged: Local Data Staging",
  "TacticGroup": "Collection",
  "Technique": "T1074",
  "Technique_Name": "Data Staged"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing rar.exe with the -a parameter for a password to use for encryption",
  "Datasources": [],
  "Detection": [
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Correlated",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection (green; low severity) called Data Encrypted was generated due to powershell.exe executing rar.exe with command-line arguments to encrypt working.zip. The event was correlated to a parent Technique detection on powershell.exe.",
    "An MSSP detection contained evidence of execution of rar.exe with command line arguments to encrypt working.zip."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Encrypted staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.B.6",
  "Subtechnique": "T1560.001",
  "Subtechnique_Name": "Archive Collected Data: Archive via Utility",
  "TacticGroup": "Collection",
  "Technique": "T1560",
  "Technique_Name": "Archive Collected Data"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing rar.exe",
  "Datasources": [],
  "Detection": [
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection (green; low severity) called \"T1002_Data_Compressed\" was generated due to powershell.exe executing rar.exe with command-line arguments indicative of compression.",
    "An MSSP detection contained evidence of execution of rar.exe with command line arguments to compress working.zip."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Compressed staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.B.7",
  "Subtechnique": "T1560.001",
  "Subtechnique_Name": "Archive Collected Data: Archive via Utility",
  "TacticGroup": "Collection",
  "Technique": "T1560",
  "Technique_Name": "Archive Collected Data"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "python.exe reading the file working.zip while connected to the C2 channel",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Read and downloaded ZIP (working.zip on Desktop) over C2 channel (192.168.0.5 over TCP port 8443)",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.B.8",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1041",
  "Technique_Name": "Exfiltration Over Command and Control Channel"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "sdelete64.exe deleting the file rar.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Deleted rar.exe on disk using SDelete",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.C.1",
  "Subtechnique": "T1070.004",
  "Subtechnique_Name": "Indicator Removal on Host: File Deletion",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1070",
  "Technique_Name": "Indicator Removal on Host"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "sdelete64.exe deleting the file \\Desktop\\working.zip",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed sdelete64.exe with command-line arguments to delete Desktop\\working.zip."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Deleted working.zip (from Desktop) on disk using SDelete",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.C.2",
  "Subtechnique": "T1070.004",
  "Subtechnique_Name": "Indicator Removal on Host: File Deletion",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1070",
  "Technique_Name": "Indicator Removal on Host"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "sdelete64.exe deleting the file \\AppData\\Roaming\\working.zip",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Deleted working.zip (from AppData directory) on disk using SDelete",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.C.3",
  "Subtechnique": "T1070.004",
  "Subtechnique_Name": "Indicator Removal on Host: File Deletion",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1070",
  "Technique_Name": "Indicator Removal on Host"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "cmd.exe deleting the file sdelete64.exe",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Deleted SDelete on disk using cmd.exe del command",
  "ScreenshotDatasources": [],
  "Step": "9. Clean Up, Collection, and Exfiltration",
  "Substep": "9.C.4",
  "Subtechnique": "T1070.004",
  "Subtechnique_Name": "Indicator Removal on Host: File Deletion",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1070",
  "Technique_Name": "Indicator Removal on Host"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "javamtsup.exe spawning from services.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed javamtsup.exe with parent process services.exe.",
    "An MSSP detection contained evidence of javamtsup.exe spawning from services.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Executed persistent service (javamtsup) on system startup",
  "ScreenshotDatasources": [],
  "Step": "10. Persistence Execution",
  "Substep": "10.A.1",
  "Subtechnique": "T1569.002",
  "Subtechnique_Name": "System Services: Service Execution",
  "TacticGroup": "Execution",
  "Technique": "T1569",
  "Technique_Name": "System Services"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Evidence that the file hostui.lnk (which executes hostui.bat as a byproduct) was executed from the Startup Folder",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Executed LNK payload (hostui.lnk) in Startup Folder on user login",
  "ScreenshotDatasources": [],
  "Step": "10. Persistence Execution",
  "Substep": "10.B.1",
  "Subtechnique": "T1547.001",
  "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder",
  "TacticGroup": "Persistence",
  "Technique": "T1547",
  "Technique_Name": "Boot or Logon Autostart Execution"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "hostui.exe executing the CreateProcessWithToken API",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Executed PowerShell payload via the CreateProcessWithToken API",
  "ScreenshotDatasources": [],
  "Step": "10. Persistence Execution",
  "Substep": "10.B.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Execution",
  "Technique": "T1106",
  "Technique_Name": "Native API"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "hostui.exe manipulating the token of powershell.exe via the CreateProcessWithToken API OR powershell.exe executing with the stolen token of explorer.exe",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Manipulated the token of the PowerShell payload via the CreateProcessWithToken API",
  "ScreenshotDatasources": [],
  "Step": "10. Persistence Execution",
  "Substep": "10.B.3",
  "Subtechnique": "T1134.002",
  "Subtechnique_Name": "Access Token Manipulation: Create Process with Token",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1134",
  "Technique_Name": "Access Token Manipulation"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe spawning from explorer.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [
    "Alert"
  ],
  "DetectionText": [
    "Telemetry showed explorer.exe spawning powershell.exe.",
    "A Technique alert detection (yellow tag) called \"User Execution\" was generated due to the execution of powershell.exe from explorer.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "User Oscar executed payload 37486-the-shocking-truth-about-election-rigging-in-america.rtf.lnk",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.1",
  "Subtechnique": "T1204.002",
  "Subtechnique_Name": "User Execution: Malicious File",
  "TacticGroup": "Execution",
  "Technique": "T1204",
  "Technique_Name": "User Execution"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing the schemas ADS via Get-Content and IEX",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.",
    "A Technique alert detection (yellow; medium severity) called NTFS File Attributes was generated due to execution of schemas ADS by powershell.exe.",
    "An MSSP detection contained evidence of PowerShell executing schemas ADS via Get-Content and IEX."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Executed an alternate data stream (ADS) using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.2",
  "Subtechnique": "T1564.004",
  "Subtechnique_Name": "Hide Artifacts: NTFS File Attributes",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1564",
  "Technique_Name": "Hide Artifacts"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_BIOS",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of execution of an WMI query for Win32_BIOS."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Checked that the BIOS version and serial number are not associated with VirtualBox or VMware using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.3",
  "Subtechnique": "T1497.001",
  "Subtechnique_Name": "Virtualization/Sandbox Evasion: System Checks",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1497",
  "Technique_Name": "Virtualization/Sandbox Evasion"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing a Get-WmiObject gwmi queries for Win32_BIOS and Win32_ComputerSystem",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of execution of WMI queries for Win32_BIOS and Win32_ComputerSystem."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Enumerated computer manufacturer, model, and version information using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.4",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1082",
  "Technique_Name": "System Information Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_PnPEntity",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence for the execution of an WMI query for Win32_PnPEntity."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Enumerated devices/adapters to check for presence of VirtualBox driver(s) using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.5",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1120",
  "Technique_Name": "Peripheral Device Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of execution of an WMI query for Win32_ComputerSystem."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Checked that the username is not related to admin or a generic value (ex: user) using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.6",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1033",
  "Technique_Name": "System Owner/User Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of execution of an WMI query for Win32_ComputerSystem."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Checked that the computer is joined to a domain using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.7",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1016",
  "Technique_Name": "System Network Configuration Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_Process",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of execution of an WMI query for Win32_Process."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Checked that processes such as procexp.exe, taskmgr.exe, or wireshark.exe are not running using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.8",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "Technique_Name": "Process Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing (Get-Item -Path \".\\\" -Verbose).FullName",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Checked that the payload is not inside a folder path that contains \"sample\" or is the length of a hash value using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.9",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "Technique_Name": "File and Directory Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "certutil.exe decoding kxwn.lock",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.",
    "A Technique alert detection (yellow; medium severity) called \"suspicious_certutil_usage_decoding\" was generated due to certutil.exe decoding kxwn.lock.",
    "An MSSP detection contained evidence of certutil.exe decoding the kxwn.lock payload."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Decoded an embedded DLL payload to disk using certutil.exe",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.10",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Defense Evasion",
  "Technique": "T1140",
  "Technique_Name": "Deobfuscate/Decode Files or Information"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Addition of the Webcache subkey in HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe adding Run key persistence into the Registry.",
    "A Technique alert detection (yellow tag) called Registy Run Keys Startup Folder  was generated due to powershell.exe adding the Webcache subkey Run key persistence into the Registry.",
    "An MSSP detection contained evidence of the Webcache subkey added to the Registry to establish persistence."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Established Registry Run key persistence using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.11",
  "Subtechnique": "T1547.001",
  "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder",
  "TacticGroup": "Persistence",
  "Technique": "T1547",
  "Technique_Name": "Boot or Logon Autostart Execution"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe spawning from from the schemas ADS (powershell.exe)",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "General",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe spawned from a PowerShell stager.",
    "A General alert detection (high severity) called \"PDM:Exploit.Win32.Generic\" was generated for a potential threat.",
    "A Technique alert detection (yellow indicator) for \"PowerShell\" was generated for powershell.exe spawned from a PowerShell stager.",
    "An MSSP detection contained evidence of PowerShell executing from schemas ADS."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Executed PowerShell stager payload",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.12",
  "Subtechnique": "T1059.001",
  "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Established network channel over port 443",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.",
    "A Technique alert detection (red indicator) called Commonly Used Port was generated for powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.",
    "An MSSP detection contained evidence of PowerShell establishing C2 with 192.168.0.4 over TCP port 443."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Established C2 channel (192.168.0.4) via PowerShell payload over port 443",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.13",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1043",
  "Technique_Name": "Commonly Used Port"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Established network channel over the HTTPS protocol",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Used HTTPS to transport C2 (192.168.0.4) traffic",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.14",
  "Subtechnique": "T1071.001",
  "Subtechnique_Name": "Application Layer Protocol: Web Protocols",
  "TacticGroup": "Command and Control",
  "Technique": "T1071",
  "Technique_Name": "Application Layer Protocol"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Evidence that the network data sent over the C2 channel is encrypted",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Used HTTPS to encrypt C2 (192.168.0.4) traffic",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.15",
  "Subtechnique": "T1573.002",
  "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography",
  "TacticGroup": "Command and Control",
  "Technique": "T1573",
  "Technique_Name": "Encrypted Channel"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing (gci ((gci env:windir).Value + '\\system32')",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Enumerated the System32 directory using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "12. Fortify Access",
  "Substep": "12.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "Technique_Name": "File and Directory Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe modifying the creation, last access, and last write times of kxwn.lock",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of timestomping of kxwn.lock."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Modified the time attributes of the kxwn.lock persistence payload using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "12. Fortify Access",
  "Substep": "12.A.2",
  "Subtechnique": "T1070.006",
  "Subtechnique_Name": "Indicator Removal on Host: Timestomp",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1070",
  "Technique_Name": "Indicator Removal on Host"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing a Get-WmiObject query for AntiVirusProduct",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of a PowerShell gwmi query for AntiVirusProduct."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Enumerated registered AV products using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "12. Fortify Access",
  "Substep": "12.B.1",
  "Subtechnique": "T1518.001",
  "Subtechnique_Name": "Software Discovery: Security Software Discovery",
  "TacticGroup": "Discovery",
  "Technique": "T1518",
  "Technique_Name": "Software Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Enumerated installed software via the Registry (Wow6432 Uninstall key) using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "12. Fortify Access",
  "Substep": "12.C.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1012",
  "Technique_Name": "Query Registry"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Enumerated installed software via the Registry (Uninstall key) using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "12. Fortify Access",
  "Substep": "12.C.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1012",
  "Technique_Name": "Query Registry"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing the GetComputerNameEx API",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of PowerShell executing the GetComputerNameEx API."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Enumerated the computer name using the GetComputerNameEx API",
  "ScreenshotDatasources": [],
  "Step": "13. Reconnaissance",
  "Substep": "13.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1082",
  "Technique_Name": "System Information Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing the NetWkstaGetInfo API",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection contained evidence of PowerShell executing the NetWKstaGetInfo API."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Enumerated the domain name using the NetWkstaGetInfo API",
  "ScreenshotDatasources": [],
  "Step": "13. Reconnaissance",
  "Substep": "13.B.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1016",
  "Technique_Name": "System Network Configuration Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing the GetUserNameEx API",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection contained evidence of PowerShell executing the GetUserNameEx API."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Enumerated the current username using the GetUserNameEx API",
  "ScreenshotDatasources": [],
  "Step": "13. Reconnaissance",
  "Substep": "13.C.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1033",
  "Technique_Name": "System Owner/User Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing the CreateToolhelp32Snapshot API",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence of PowerShell executing the CreateToolhelp32Snapshot API."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Enumerated running processes using the CreateToolhelp32Snapshot API",
  "ScreenshotDatasources": [],
  "Step": "13. Reconnaissance",
  "Substep": "13.D.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "Technique_Name": "Process Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Addition of the DelegateExecute subkey in HKCU\\Software\\Classes\\Folder\\shell\\open\\command",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred containing evidence for a well-known UAC bypass technique."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "14. Elevation & Credential Access",
  "Substep": "14.A.1",
  "Subtechnique": "T1546.015",
  "Subtechnique_Name": "Event Triggered Execution: Component Object Model Hijacking",
  "TacticGroup": "Privilege Escalation",
  "Technique": "T1546",
  "Technique_Name": "Event Triggered Execution"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "High integrity powrshell.exe spawning from control.exe (spawned from sdclt.exe)",
  "Datasources": [],
  "Detection": [
    "General",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A General alert detection (red; high severity) for \"Suspicious PowerShell\" was generated due to execution of powershell.exe by control.exe.",
    "An MSSP detection contained evidence of High Integrity PowerShell process spawned from control.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Executed elevated PowerShell payload",
  "ScreenshotDatasources": [],
  "Step": "14. Elevation & Credential Access",
  "Substep": "14.A.2",
  "Subtechnique": "T1548.002",
  "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control",
  "TacticGroup": "Privilege Escalation",
  "Technique": "T1548",
  "Technique_Name": "Abuse Elevation Control Mechanism"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Deletion of the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command subkey",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Modified the Registry to remove artifacts of COM hijacking using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "14. Elevation & Credential Access",
  "Substep": "14.A.3",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Defense Evasion",
  "Technique": "T1112",
  "Technique_Name": "Modify Registry"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "WMI Process (WmiPrvSE.exe) executing powershell.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed WmiPrvSE.exe executing powershell.exe.",
    "A Technique alert detection (red; high severity) called \"commandline_wmi_event_consumer_triggered\"  was generated due to WmiPrvSE.exe executing powershell.exe.",
    "An MSSP detection contained evidence of WmiPrvSE.exe executing powershell.exe to execute the Win32_AuditCode WMI class."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Created and executed a WMI class using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "14. Elevation & Credential Access",
  "Substep": "14.B.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Execution",
  "Technique": "T1047",
  "Technique_Name": "Windows Management Instrumentation"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Get-Process",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection contained evidence of PowerShell collecting information about running processes."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Enumerated and tracked PowerShell processes using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "14. Elevation & Credential Access",
  "Substep": "14.B.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "Technique_Name": "Process Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe downloading and/or the file write of m.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed the file create event for m.exe into the System32 folder."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Downloaded and dropped Mimikatz (m.exe) to disk",
  "ScreenshotDatasources": [],
  "Step": "14. Elevation & Credential Access",
  "Substep": "14.B.3",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "m.exe injecting into lsass.exe to dump credentials",
  "Datasources": [],
  "Detection": [
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection (red; high severity) called \"mimikatz_command_patterns\" was generated for m.exe executing with command-line arguments indicative of Mimikatz credential dumping.",
    "An MSSP detection contained evidence of Mimikatz dumping credentials."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Dumped plaintext credentials using Mimikatz (m.exe)",
  "ScreenshotDatasources": [],
  "Step": "14. Elevation & Credential Access",
  "Substep": "14.B.4",
  "Subtechnique": "T1003.001",
  "Subtechnique_Name": "OS Credential Dumping: LSASS Memory",
  "TacticGroup": "Credential Access",
  "Technique": "T1003",
  "Technique_Name": "OS Credential Dumping"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Set-WmiInstance",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Encoded and wrote Mimikatz output to a WMI class property using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "14. Elevation & Credential Access",
  "Substep": "14.B.5",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Defense Evasion",
  "Technique": "T1027",
  "Technique_Name": "Obfuscated Files or Information"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Get-WmiInstance",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Read and decoded Mimikatz output from a WMI class property using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "14. Elevation & Credential Access",
  "Substep": "14.B.6",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Defense Evasion",
  "Technique": "T1140",
  "Technique_Name": "Deobfuscate/Decode Files or Information"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing $env:UserName",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Enumerated logged on users using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "15. Establish Persistence",
  "Substep": "15.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1033",
  "Technique_Name": "System Owner/User Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe creating the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection contained evidence of WMI persistence established for user Oscar."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Established WMI event subscription persistence using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "15. Establish Persistence",
  "Substep": "15.A.2",
  "Subtechnique": "T1546.003",
  "Subtechnique_Name": "Event Triggered Execution: Windows Management Instrumentation Event Subscription",
  "TacticGroup": "Persistence",
  "Technique": "T1546",
  "Technique_Name": "Event Triggered Execution"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe making LDAP queries over port 389 via functions from System.DirectoryServices.dll",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection contained evidence of System.DirectoryServices.ni.dll loaded into PowerShell, which can be used to execute LDAP queries."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Enumerated the domain controller host NewYork (10.0.0.4) using LDAP queries",
  "ScreenshotDatasources": [],
  "Step": "16. Expand Access",
  "Substep": "16.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1018",
  "Technique_Name": "Remote System Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing the ConvertSidToStringSid API",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Enumerated the domain SID (from current user SID) using the ConvertSidToStringSid API",
  "ScreenshotDatasources": [],
  "Step": "16. Expand Access",
  "Substep": "16.B.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1033",
  "Technique_Name": "System Owner/User Discovery"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing the ConvertSidToStringSid API function by loading Advapi32.dll",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Executed the ConvertSidToStringSid API call by reflectively loading Advapi32.dll",
  "ScreenshotDatasources": [],
  "Step": "16. Expand Access",
  "Substep": "16.B.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Execution",
  "Technique": "T1106",
  "Technique_Name": "Native API"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Network connection to NewYork (10.0.0.4) over port 5985",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "General",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985.",
    "A General detection alert (red; high severity) for PowerShell with network activity was generated for to powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985.",
    "An MSSP detection contained evidence of a WinRM connection on NewYork (10.0.0.4)."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Established a WinRM connection to the domain controller host NewYork (10.0.0.4)",
  "ScreenshotDatasources": [],
  "Step": "16. Expand Access",
  "Substep": "16.C.1",
  "Subtechnique": "T1021.006",
  "Subtechnique_Name": "Remote Services: Windows Remote Management",
  "TacticGroup": "Lateral Movement",
  "Technique": "T1021",
  "Technique_Name": "Remote Services"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Successful logon as user MScott on NewYork (10.0.0.4)",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed a successful logon on NewYork (10.0.0.4) as user MScott.",
    "An MSSP detection contained evidence of the successful logon of MScott on NewYork (10.0.0.4)."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Logged on to the domain controller host NewYork (10.0.0.4) using valid credentials for user MScott",
  "ScreenshotDatasources": [],
  "Step": "16. Expand Access",
  "Substep": "16.C.2",
  "Subtechnique": "T1078.002",
  "Subtechnique_Name": "Valid Accounts: Domain Accounts",
  "TacticGroup": "Initial Access",
  "Technique": "T1078",
  "Technique_Name": "Valid Accounts"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "File write of m.exe by the WinRM process (wsmprovhost.exe)",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed the creation of m.exe in the System32 directory by wsmprovhost.exe.",
    "An MSSP detection contained evidence of the write of m.exe to the System32 directory by wsmprovhost.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Dropped Mimikatz (m.exe) to disk on the domain controller host NewYork (10.0.0.4) over a WinRM connection",
  "ScreenshotDatasources": [],
  "Step": "16. Expand Access",
  "Substep": "16.D.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Lateral Movement",
  "Technique": "T1570",
  "Technique_Name": "Lateral Tool Transfer"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "m.exe injecting into lsass.exe to dump credentials",
  "Datasources": [],
  "Detection": [
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "A Technique alert detection (red; high severity) for Credential Dumping was generated for m.exe with command-line arguments indicative of Mimikatz credential dumping.",
    "An MSSP detection contained evidence of Mimikatz command-line arguments to dump credentials."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Dumped the KRBTGT hash on the domain controller host NewYork (10.0.0.4) using Mimikatz (m.exe)",
  "ScreenshotDatasources": [],
  "Step": "16. Expand Access",
  "Substep": "16.D.2",
  "Subtechnique": "T1003.001",
  "Subtechnique_Name": "OS Credential Dumping: LSASS Memory",
  "TacticGroup": "Credential Access",
  "Technique": "T1003",
  "Technique_Name": "OS Credential Dumping"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "outlook.exe spawning from svchost.exe or powershell.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails.",
    "An MSSP detection contained evidence of PowerShell interacting with Outlook."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Dumped messages from the local Outlook inbox using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "17. Collection",
  "Substep": "17.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Collection",
  "Technique": "T1114",
  "Technique_Name": "Email Collection"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe reading the file MITRE-ATTACK-EVALS.HTML",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Read and collected a local file using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "17. Collection",
  "Substep": "17.B.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Collection",
  "Technique": "T1005",
  "Technique_Name": "Data from Local System"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe creating the file \\WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML.",
    "An MSSP detection occurred containing the file write event for WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Staged collected file into directory using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "17. Collection",
  "Substep": "17.B.2",
  "Subtechnique": "T1074.001",
  "Subtechnique_Name": "Data Staged: Local Data Staging",
  "TacticGroup": "Collection",
  "Technique": "T1074",
  "Technique_Name": "Data Staged"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing the ZipFile.CreateFromDirectory .NET method",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection occurred contained evidence of data compression."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Compressed a staging directory using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "17. Collection",
  "Substep": "17.C.1",
  "Subtechnique": "T1560.001",
  "Subtechnique_Name": "Archive Collected Data: Archive via Utility",
  "TacticGroup": "Collection",
  "Technique": "T1560",
  "Technique_Name": "Archive Collected Data"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Set-Content",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection contained evidence that WindowsParentalControlMigration.tmp was a ZIP archive with a gif file header."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Prepended the GIF file header to a compressed staging file using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "17. Collection",
  "Substep": "17.C.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Defense Evasion",
  "Technique": "T1027",
  "Technique_Name": "Obfuscated Files or Information"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "net.exe with command-line arguments then making a network connection to a public IP over port 443",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Mapped a network drive to an online OneDrive account using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "18. Exfiltration",
  "Substep": "18.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1102",
  "Technique_Name": "Web Service"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Copy-Item pointing to drive mapped to an attack-controlled OneDrive account",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Exfiltrated staged collection to an online OneDrive account using PowerShell",
  "ScreenshotDatasources": [],
  "Step": "18. Exfiltration",
  "Substep": "18.A.2",
  "Subtechnique": "T1567.002",
  "Subtechnique_Name": "Exfiltration Over Web Service: Exfiltration to Cloud Storage",
  "TacticGroup": "Exfiltration",
  "Technique": "T1567",
  "Technique_Name": "Exfiltration Over Web Service"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "rundll32.exe executing kxwn.lock",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed rundll32.exe executing kxwn.lock.",
    "A Technique alert detection (yellow, medium severity) called Rundll32 Execution was generated due to rundll32.exe executing kxwn.lock.",
    "An MSSP detection contained evidence of rundll32.exe executing kxwn.lock."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Executed Run key persistence payload on user login using RunDll32",
  "ScreenshotDatasources": [],
  "Step": "20. Persistence Execution",
  "Substep": "20.A.1",
  "Subtechnique": "T1218.011",
  "Subtechnique_Name": "Signed Binary Proxy Execution: Rundll32",
  "TacticGroup": "Execution",
  "Technique": "T1218",
  "Technique_Name": "Signed Binary Proxy Execution"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "The WMI process (wmiprvse.exe) executing powershell.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed wmiprvse.exe executing the PowerShell stager.",
    "A Technique alert detection (red; high severity) called \"WMI Event Consumer Triggered\" was generated due to wmiprvse.exe executing powershell.exe.",
    "An MSSP detection contained evidence of wmiprvse.exe executing the PowerShell stager."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Executed WMI persistence on user login",
  "ScreenshotDatasources": [],
  "Step": "20. Persistence Execution",
  "Substep": "20.A.2",
  "Subtechnique": "T1546.003",
  "Subtechnique_Name": "Event Triggered Execution: Windows Management Instrumentation Event Subscription",
  "TacticGroup": "Persistence",
  "Technique": "T1546",
  "Technique_Name": "Event Triggered Execution"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "SYSTEM-level powershell.exe spawned from the powershell.exe",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Technique",
    "MSSP"
  ],
  "DetectionModifiers": [
    "Alert",
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "Telemetry showed execution of SYSTEM level PowerShell.",
    "A Technique alert detection (red; high severity) called PowerShell was generated due to powershell executing a SYSTEM-level powershell.exe.",
    "An MSSP detection contained evidence of PowerShell spawned from a WMI event subscription."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Executed PowerShell payload from WMI event subscription persistence",
  "ScreenshotDatasources": [],
  "Step": "20. Persistence Execution",
  "Substep": "20.A.3",
  "Subtechnique": "T1059.001",
  "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executing Invoke-Mimikatz with command-line arguments to create a golden ticket",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection contained evidence of use of a suspicious Kerberos ticket."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Created Kerberos Golden Ticket using Invoke-Mimikatz",
  "ScreenshotDatasources": [],
  "Step": "20. Persistence Execution",
  "Substep": "20.B.1",
  "Subtechnique": "T1550.003",
  "Subtechnique_Name": "Use Alternate Authentication Material: Pass the Ticket",
  "TacticGroup": "Lateral Movement",
  "Technique": "T1550",
  "Technique_Name": "Use Alternate Authentication Material"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "Network connection to Scranton (10.0.1.4) over port 5985",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection contained evidence of a WinRM session to remote host SchruteFarms (10.0.1.7)."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Established a WinRM connection to the remote host Scranton (10.0.1.4) using the Golden Ticket as credentials",
  "ScreenshotDatasources": [],
  "Step": "20. Persistence Execution",
  "Substep": "20.B.2",
  "Subtechnique": "T1021.006",
  "Subtechnique_Name": "Remote Services: Windows Remote Management",
  "TacticGroup": "Lateral Movement",
  "Technique": "T1021",
  "Technique_Name": "Remote Services"
}
{
  "Adversary": "apt29",
  "Capability_Requirements": [],
  "Criteria": "net.exe adding the user Toby",
  "Datasources": [],
  "Detection": [
    "MSSP"
  ],
  "DetectionModifiers": [
    "Delayed (Manual)"
  ],
  "DetectionText": [
    "An MSSP detection contained evidence of the creation of the user Toby on Scranton (10.0.1.4)."
  ],
  "Footnotes": [],
  "Participant_Name": "kaspersky",
  "Procedure": "Added a new user to the remote host Scranton (10.0.1.4) using net.exe",
  "ScreenshotDatasources": [],
  "Step": "20. Persistence Execution",
  "Substep": "20.B.3",
  "Subtechnique": "T1136.001",
  "Subtechnique_Name": "Create Account: Local Account",
  "TacticGroup": "Persistence",
  "Technique": "T1136",
  "Technique_Name": "Create Account"
}
