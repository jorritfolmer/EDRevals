{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "explorer.exe spawns winword.exe when user clicks 1-list.rtf",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"ProcessExecutedByUser - T1204 User Execution\" (suspicious) was generated when explorer.exe spawned winword.exe when the user clicks 1-list.rtf."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "1. Initial Breach",
  "Substep": "1.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Execution",
  "Technique": "T1204",
  "Technique_Name": "User Execution"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "winword.exe loads VBE7.DLL",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "1. Initial Breach",
  "Substep": "1.A.2",
  "Subtechnique": "T1559.001",
  "Subtechnique_Name": "Inter-Process Communication: Component Object Model",
  "TacticGroup": "Execution",
  "Technique": "T1559",
  "Technique_Name": "Inter-Process Communication"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "wscript.exe executes unprotected.vbe",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring",
    "File Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "General",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A General detection named \"Antimalware detected wscript.exe executed with a suspicious command line - T1059 Command and Scripting Interpreter\" (High) was generated when wscript.exe spawned unprotected.vbe.",
    "A Technique detection named \"Microsoft Office Suspicious Child - T1059.005 Visual Basic\" was generated when wscript.exe spawned unprotected.vbe."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "1. Initial Breach",
  "Substep": "1.A.3",
  "Subtechnique": "T1059.005",
  "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "unprotected.vbe is an encoded file",
  "Datasources": [
    "Process Monitoring"
  ],
  "Detection": [
    "Technique"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detection Logic)"
  ],
  "DetectionText": [
    "A Technique detection named \"WscriptEncodedScript - T1027 Obfuscated Files or Information\" was generated when unprotected.vbe was encoded."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "1. Initial Breach",
  "Substep": "1.A.4",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Defense Evasion",
  "Technique": "T1027",
  "Technique_Name": "Obfuscated Files or Information"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "wscript.exe decodes content and creates starter.vbs",
  "Datasources": [
    "Process Monitoring",
    "File Monitoring",
    "Process Monitoring",
    "File Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detection Logic)"
  ],
  "DetectionText": [
    "A Technique detection named \"ScriptDecodeAndDrop - T1140 Deobfuscate/Decode Files or Information\" (Low) was generated when wscript.exe decoded and created starter.vbs."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "1. Initial Breach",
  "Substep": "1.A.5",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Defense Evasion",
  "Technique": "T1140",
  "Technique_Name": "Deobfuscate/Decode Files or Information"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "wscript.exe decodes content and creates TransBaseOdbcDriver.js",
  "Datasources": [
    "Process Monitoring",
    "File Monitoring",
    "Process Monitoring",
    "File Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detection Logic)"
  ],
  "DetectionText": [
    "A Technique detection named \"ScriptDecodeAndDrop - T1140 Deobfuscate/Decode Files or Information\" (Low) was generated when wscript.exe decoded and created TransBaseOdbcDriver.js."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "1. Initial Breach",
  "Substep": "1.A.6",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Defense Evasion",
  "Technique": "T1140",
  "Technique_Name": "Deobfuscate/Decode Files or Information"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "wscript.exe executes starter.vbs",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "General",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A General detection named \"Antimalware detected wscript.exe executed a suspicious command line\" (High) was generated when wscipt.exe executed starter.vbs.",
    "A Technique detection named \"SuspiciousProcessChain - T1059.005 Visual Basic\" was generated when wscript.exe executed starter.vbs."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "1. Initial Breach",
  "Substep": "1.A.7",
  "Subtechnique": "T1059.005",
  "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "wscript.exe spawns cmd.exe",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"SuspiciousProcessChain - T1059.003 Windows Command Shell\" (Info) was generated when wscript.exe spawned cmd.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "1. Initial Breach",
  "Substep": "1.A.8",
  "Subtechnique": "T1059.003",
  "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "cmd.exe spawns wscript.exe to execute TransBaseOdbcDriver.js",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring",
    "Script Logs",
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "General",
    "Technique",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A General detection named \"WscriptSuspiciousExecution\" was generated when wscript.exe executed TransBaseOdbcDriver.js.",
    "A Technique detection named \"SuspiciousProcessChain - T1059 Command and Scripting Interpreter\" (High) was generated when wscript.exe executed TransBaseOdbcDriver.js.",
    "A Technique detection named \"T1059.007 JavaScript/JScript\" was generated when cmd.exe spawned wscript.exe to execute TransBaseOdbcDriver.js."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "1. Initial Breach",
  "Substep": "1.A.9",
  "Subtechnique": "T1059.007",
  "Subtechnique_Name": "Command and Scripting Interpreter: JavaScript/JScript",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "wscript.exe transmits data to 192.168.0.4 over HTTPS protocol",
  "Datasources": [
    "Process Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "Network Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [
    "Configuration Change (Data Sources)"
  ],
  "DetectionText": [
    "A Technique detection named \"ConnectionProtocolIdentified - T1071.001 Web Protocols\" (Info) was generated when wscript.exe connected to 192.168.0.4 over HTTP(S) (port 443)."
  ],
  "Footnotes": [
    "reactivated man in the middle functionality for the internal IP range"
  ],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "1. Initial Breach",
  "Substep": "1.A.10",
  "Subtechnique": "T1071.001",
  "Subtechnique_Name": "Application Layer Protocol: Web Protocols",
  "TacticGroup": "Command and Control",
  "Technique": "T1071",
  "Technique_Name": "Application Layer Protocol"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "wscript.exe transmits data to 192.168.0.4 over HTTPS protocol",
  "Datasources": [
    "Process Monitoring",
    "Network Monitoring"
  ],
  "Detection": [
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"StandardCryptographicProtocol - T1573 Encrypted Channel\" (Info) was generated when wscript.exe connected to 192.168.0.4 over HTTPS (port 443)."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "1. Initial Breach",
  "Substep": "1.A.11",
  "Subtechnique": "T1573.002",
  "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography",
  "TacticGroup": "Command and Control",
  "Technique": "T1573",
  "Technique_Name": "Encrypted Channel"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "wscript.exe makes WMI queries for Win32_Processor &  Win32_OperatingSystem",
  "Datasources": [
    "System Calls/API Monitoring",
    "Process Monitoring",
    "WMI Objects"
  ],
  "Detection": [
    "Technique",
    "Technique"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detection Logic)"
  ],
  "DetectionText": [
    "A Technique detection named \"WindowsDiscoveryAPIUsed - T1082 System Information Discovery\" (Low) was generated when wscript.exe called an API function for Windows discovery.",
    "A Technique detection named \"WMIOperatingSystemDiscovery - T1082 System Information Discovery\" (Low) was generated when wscript.exe made a WMI query for Win32_OperatingSystem."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "2. Target Assessment",
  "Substep": "2.A.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1082",
  "Technique_Name": "System Information Discovery"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "wscript.exe makes a WMI query for Win32_Process",
  "Datasources": [
    "Process Monitoring",
    "WMI Objects",
    "Process Monitoring",
    "WMI Objects"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detection Logic)",
    "Configuration Change (Detection Logic)"
  ],
  "DetectionText": [
    "A Technique detection named \"WMIProcessQuery - T1057 Process Discovery\" (Low) was generated when wscript.exe made a WMI query for Win32_Process."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "2. Target Assessment",
  "Substep": "2.A.4",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "Technique_Name": "Process Discovery"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "wscript.exe downloads screenshot__.ps1 from 192.168.0.4",
  "Datasources": [
    "File Monitoring",
    "Process Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "File Monitoring",
    "Network Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "General",
    "Technique"
  ],
  "DetectionModifiers": [
    "Configuration Change (Data Sources)",
    "Configuration Change (Data Sources)"
  ],
  "DetectionText": [
    "A General detection named \"HTTP Script File Downloaded\" (High) was generated when wscript.exe downloaded take-screenshot.ps1 (screenshot__.ps1) from 192.168.0.4.",
    "A Technique detection named \"ScriptDecodeAndDrop - T1105 Ingress Tool Transfer\" (Low) was generated when wscript.exe decoded and wrote screenshot__.ps1 to disk."
  ],
  "Footnotes": [
    "reactivated man in the middle functionality for the internal IP range",
    "reactivated man in the middle functionality for the internal IP range"
  ],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "2. Target Assessment",
  "Substep": "2.B.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "wscript.exe spawns cmd.exe",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"SuspiciousProcessChain - T1059.003 Windows Command Shell\" (Info) was generated when wscript.exe spawned cmd.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "2. Target Assessment",
  "Substep": "2.B.2",
  "Subtechnique": "T1059.003",
  "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "cmd.exe spawns powershell.exe",
  "Datasources": [
    "Process Monitoring",
    "Script Logs",
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "General",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A General detection named \"AMSI detected potentially harmful artifacts scanning the Memory Buffer Register\" (High) was generated when cmd.exe spawned powershell.exe.",
    "A Technique detection named \"Cmd Spawns PowerShell Child - T1059.001 PowerShell\" (Low) was generated when cmd.exe spawned powershell.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "2. Target Assessment",
  "Substep": "2.B.3",
  "Subtechnique": "T1059.001",
  "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "powershell.exe executes CopyFromScreen()",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring",
    "System Calls/API Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"Desktop Capture - T1113 Screen Capture\" (Low) was generated when powershell.exe took a screenshot of the desktop using GetDC.",
    "A Technique detection named \"PowershellScreenshotTaken - T1113 Screen Capture\" (Low) was generated when powershell.exe executed CopyFromScreen()."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "2. Target Assessment",
  "Substep": "2.B.4",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Collection",
  "Technique": "T1113",
  "Technique_Name": "Screen Capture"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "wscript.exe reads and uploads screenshot__.png to 192.168.0.4",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "2. Target Assessment",
  "Substep": "2.B.5",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Exfiltration",
  "Technique": "T1041",
  "Technique_Name": "Exfiltration Over Command and Control Channel"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "wscript.exe spawns cmd.exe",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"SuspiciousProcessChain - T1059.003 Windows Command Shell\" (Low) was generated when wscript.exe spawned cmd.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "3. Deploy Toolkit",
  "Substep": "3.A.1",
  "Subtechnique": "T1059.003",
  "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "cmd.exe spawns reg.exe to add a value under HKCU\\Software\\InternetExplorer\\AppDataLow\\Software\\Microsoft\\InternetExplorer",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "General",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A General detection named \"Reg Usage from Shell\" was generated when cmd.exe spawned reg.exe.",
    "A Technique detection named \"Registry Manipulation - T1112 Modify Registry\" was generated when cmd.exe spawned reg.exe to add a value to the registry key."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "3. Deploy Toolkit",
  "Substep": "3.A.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Defense Evasion",
  "Technique": "T1112",
  "Technique_Name": "Modify Registry"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "Value added to Registry is base64 encoded",
  "Datasources": [
    "Process Monitoring",
    "Windows Registry"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detection Logic)"
  ],
  "DetectionText": [
    "A Technique detection named \"IExplorerRegAdd - T1027 Obfuscated Files or Information\" (Low) was generated when the value added to the Registry was base64 encoded."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "3. Deploy Toolkit",
  "Substep": "3.A.3",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Defense Evasion",
  "Technique": "T1027",
  "Technique_Name": "Obfuscated Files or Information"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "wscript.exe downloads LanCradDriver.ps1 from 192.168.0.4",
  "Datasources": [
    "File Monitoring",
    "Process Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "File Monitoring",
    "Network Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "General",
    "Technique"
  ],
  "DetectionModifiers": [
    "Configuration Change (Data Sources)",
    "Configuration Change (Data Sources)"
  ],
  "DetectionText": [
    "A General detection named \" HTTP Script File Download / PowershellDownloadedScript\" (High) was generated when wscript.exe downloaded reverse.ps1 (LanCradDriver.ps1) from 192.168.0.4.",
    "A Technique detection named \"ScriptDecodeAndDrop - T1105 Ingress Tool Transfer\" was generated when wscript.exe decoded and created LanCradDriver.ps1."
  ],
  "Footnotes": [
    "reactivated man in the middle functionality for the internal IP range",
    "reactivated man in the middle functionality for the internal IP range"
  ],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "3. Deploy Toolkit",
  "Substep": "3.B.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "wscript.exe spawns cmd.exe",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"SuspiciousProcessChain - T1059.003 Windows Command Shell\" (Info) was generated when wscript.exe spawned cmd.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "3. Deploy Toolkit",
  "Substep": "3.B.2",
  "Subtechnique": "T1059.003",
  "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "cmd.exe spawns powershell.exe",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "General",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A General detection named \"SuspiciousProcessChain\" was generated when cmd.exe spawned powershell.exe.",
    "A Technique detection named \"Cmd Spawns PowerShell Child - T1059.001 PowerShell\" was generated when cmd.exe spawned powershell.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "3. Deploy Toolkit",
  "Substep": "3.B.3",
  "Subtechnique": "T1059.001",
  "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "powershell.exe reads HKCU\\Software\\InternetExplorer\\AppDataLow\\Software\\Microsoft\\InternetExplorer via Get-ItemProperty",
  "Datasources": [
    "Process Monitoring",
    "System Calls/API Monitoring",
    "Process Monitoring",
    "System Calls/API Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"PowershellRegistryQuery - T1012 Query Registry\" was generated when powershell.exe read a value from the registry via Get-ItemProperty."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "3. Deploy Toolkit",
  "Substep": "3.B.4",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1012",
  "Technique_Name": "Query Registry"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "powershell.exe decrypts, decompresses, and base64 decodes the Registry value into plaintext shellcode",
  "Datasources": [
    "Script Logs",
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"PowershellDecompressArchive - T1140 Deobfuscate/Decode Files or Information\" (Low) was generated when powershell.exe decompressed an archive."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "3. Deploy Toolkit",
  "Substep": "3.B.5",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Defense Evasion",
  "Technique": "T1140",
  "Technique_Name": "Deobfuscate/Decode Files or Information"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "powershell.exe executes the shellcode from the Registry by calling the CreateThread() API",
  "Datasources": [
    "Script Logs",
    "Process Monitoring",
    "System Calls/API Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detection Logic)"
  ],
  "DetectionText": [
    "A Technique detection named \"PowershellCreateThread - T1106 Native API\" was generated when powershell.exe executed the shellcode from the Registry by calling the CreateThread() API."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "3. Deploy Toolkit",
  "Substep": "3.B.6",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Execution",
  "Technique": "T1106",
  "Technique_Name": "Native API"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "powershell.exe transmits data to 192.168.0.4 over TCP",
  "Datasources": [
    "Process Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "Network Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "General",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A General detection named \"PowershellSuspiciousPortUsage - Command and Control\" (Low) was generated when powershell.exe connected to 192.168.0.4 over port 8080.",
    "A Technique detection named \"StandardNonApplicationLayerProtocol - T1095 Non-Application Layer Protocol\" (Info) was generated when powershell.exe connected to 192.168.0.4 over TCP port 8080."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "3. Deploy Toolkit",
  "Substep": "3.B.7",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1095",
  "Technique_Name": "Non-Application Layer Protocol"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "powershell.exe calls the FindFirstFileW() and FindNextFileW() APIs",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "4. Escalate Privileges",
  "Substep": "4.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "Technique_Name": "File and Directory Discovery"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "powershell.exe executes Get-NetComputer to query LDAP (port 389) via a network connection to 10.0.0.4",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "Network Monitoring",
    "Script Logs",
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "General",
    "General",
    "Technique",
    "Technique"
  ],
  "DetectionModifiers": [
    "Configuration Change"
  ],
  "DetectionText": [
    "A General detection named \"PowershellLdapBind\" (Low) was generated when powershell.exe executed Get-NetComputer to query LDAP (port 389) via a network connection to 10.0.0.4.",
    "A General detection named \"LdapBind\" was generated when powershell.exe executed Get-NetComputer to query LDAP (port 389) via a network connection to 10.0.0.4.",
    "A Technique detection named \"Powerview Network Scan - T1018 Remote System Discovery\" was generated when powershell.exe executed Get-NetComputer to query LDAP (port 389) via a network connection to 10.0.0.4.",
    "A Technique detection named \"PowershellGetNetComputer\" (Low) was generated when powershell.exe executed Get-NetComputer to query LDAP (port 389) via a network connection to 10.0.0.4."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "4. Escalate Privileges",
  "Substep": "4.A.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1018",
  "Technique_Name": "Remote System Discovery"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "powershell.exe executes Find-LocalAdminAccess, which attempts a DCOM/RPC (port 135) connection to multiple hosts to check for access",
  "Datasources": [
    "Network Monitoring",
    "Network Monitoring",
    "Network Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "General",
    "General"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A General detection named \"ConnectionOverCommonPortScripting\" (Low) was generated when powershell.exe executed Find-LocalAdminAccess, which connected to multiple hosts over port 135 to check for access.",
    "A General detection named \"Network Connection Start\" (Info) was generated when powershell.exe executed Find-LocalAdminAccess, which connected to multiple hosts over port 135 to check for access."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "4. Escalate Privileges",
  "Substep": "4.A.3",
  "Subtechnique": "T1110.003",
  "Subtechnique_Name": "Brute Force: Password Spraying",
  "TacticGroup": "Credential Access",
  "Technique": "T1110",
  "Technique_Name": "Brute Force"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "powershell.exe successfully logs in to host 10.0.0.4 or 10.0.0.5 as user kmitnick",
  "Datasources": [
    "Authentication Logs",
    "Authentication Logs"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"T1078 Valid Accounts\" was generated when user kmitnick successfully logged into bankdc (10.0.0.4) and cfo (10.0.0.5)."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "4. Escalate Privileges",
  "Substep": "4.A.4",
  "Subtechnique": "T1078.002",
  "Subtechnique_Name": "Valid Accounts: Domain Accounts",
  "TacticGroup": "Persistence",
  "Technique": "T1078",
  "Technique_Name": "Valid Accounts"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "powershell.exe downloads rad353F7.ps1 from 192.168.0.4",
  "Datasources": [
    "Process Monitoring",
    "File Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "File Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "File Monitoring",
    "Network Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "General",
    "Technique"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detection Logic)"
  ],
  "DetectionText": [
    "A General detection named \"ScriptFileWrittenByPowershell\" (Suspicious) was generated when powershell.exe downloaded rad353F7.ps1 from 192.168.0.4.",
    "A Technique detection named \"ScriptFileWrittenByPowerShell - T1105 Ingress Tool Transfer\" was generated when powershell.exe creates rad353F7.ps1."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "4. Escalate Privileges",
  "Substep": "4.B.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "powershell.exe downloads smrs.exe from 192.168.0.4",
  "Datasources": [
    "Process Monitoring",
    "File Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "File Monitoring",
    "Process Monitoring",
    "File Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "General",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A General detection named \"Gen:Heur.Mimikatz\" was generated when smrs.exe detected as Mimikatz.",
    "A Technique detection named \"SuspiciousBinaryWrittenByPowershell - T1105 Ingress Tool Transfer\" (Low) was generated when powershell.exe downloaded smrs.exe from 192.168.0.4."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "4. Escalate Privileges",
  "Substep": "4.B.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "powershell.exe executes rad353F7.ps1",
  "Datasources": [
    "Process Monitoring",
    "Script Logs",
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "General",
    "General",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A General detection named \"AMSI detected potentially harmful artifacts scanning the Memory Buffer Register\" (High) was generated when powershell.exe executed rad353F7.ps1.",
    "A General detection named \"PowershellStartedByMaliciousPowershell\" was generated when powershell.exe executed rad353F7.ps1.",
    "A Technique detection named \"PowershellStartedByPowershell - T1059.001 PowerShell\" (Low) was generated when powershell.exe executed rad353F7.ps1."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "4. Escalate Privileges",
  "Substep": "4.B.3",
  "Subtechnique": "T1059.001",
  "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "powershell.exe adds a value under HKCU:\\Software\\Classes\\ms-settings\\shell\\open\\command via New-Item and New-ItemProperty",
  "Datasources": [
    "Process Monitoring",
    "Script Logs",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"PowershellNewRegistry - T1112 Modify Registry\" was generated when powershell.exe added a value to the Registry via New-Item and New-ItemProperty."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "4. Escalate Privileges",
  "Substep": "4.B.4",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Defense Evasion",
  "Technique": "T1112",
  "Technique_Name": "Modify Registry"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "fodhelper.exe spawns cmd.exe as a high-integrity process (note: Due to the configuration of the environment, the adversary's process was high by default. This sub-step was evaluated based on the criteria of detecting data related to process integrity level as well as the executed mechanics of the UAC bypass)",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring",
    "Windows Registry"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"User Account Control Registry Bypass - T1548.002 Bypass User Account Control\" (Low) was generated when a registry entry used for User Account Control bypass was set."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "4. Escalate Privileges",
  "Substep": "4.B.5",
  "Subtechnique": "T1548.002",
  "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control",
  "TacticGroup": "Privilege Escalation",
  "Technique": "T1548",
  "Technique_Name": "Abuse Elevation Control Mechanism"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "cmd.exe spawns smrs.exe",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring",
    "File Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"Mimikatz - T1059 Command and Scripting Interpreter\" (High) was generated when cmd.exe executed smrs.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "4. Escalate Privileges",
  "Substep": "4.B.6",
  "Subtechnique": "T1059.003",
  "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "smrs.exe opens and reads lsass.exe",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"LsassMemoryRead - T1003.001 LSASS Memory\" (Low) was generated when smrs.exe opened and read lsass.exe.",
    "A Technique detection named \"Read Memory Process Critical - T1003 OS Credential Dumping\" (Low) was generated when smrs.exe opened and read lsass.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "4. Escalate Privileges",
  "Substep": "4.B.7",
  "Subtechnique": "T1003.001",
  "Subtechnique_Name": "OS Credential Dumping: LSASS Memory",
  "TacticGroup": "Credential Access",
  "Technique": "T1003",
  "Technique_Name": "OS Credential Dumping"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe downloads pscp.exe from 192.168.0.4",
  "Datasources": [
    "Process Monitoring",
    "File Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "File Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"SuspiciousBinaryWrittenByPowershell - T1105 Ingress Tool Transfer\" (25) was generated when powershell.exe created pscp.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "5. Expand Access",
  "Substep": "5.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe downloads psexec.py from 192.168.0.4",
  "Datasources": [
    "Process Monitoring",
    "File Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "File Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detection Logic)",
    "Configuration Change (Detection Logic)"
  ],
  "DetectionText": [
    "A Technique detection named \"SuspiciousFileWrite - T1105 Ingress Tool Transfer\" (1) was generated when powershell.exe created psexec.py."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "5. Expand Access",
  "Substep": "5.A.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe downloads runtime from 192.168.0.4",
  "Datasources": [
    "Process Monitoring",
    "File Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "File Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "General"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A General detection named \"Suspicious File Write\" (1) was generated when powershell.exe created runtime."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "5. Expand Access",
  "Substep": "5.A.3",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe downloads plink.exe from 192.168.0.4",
  "Datasources": [
    "Process Monitoring",
    "File Monitoring",
    "Network Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"SuspiciousBinaryWrittenByPowershell - T1105 Ingress Tool Transfer\" was generated when powershell.exe downloaded plink.exe from 192.168.0.4."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "5. Expand Access",
  "Substep": "5.A.4",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe downloads tiny.exe from 192.168.0.4",
  "Datasources": [
    "Process Monitoring",
    "File Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "File Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"SuspiciousBinaryWrittenByPowershell - T1105 Ingress Tool Transfer\" (25) was generated when powershell.exe created tiny.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "5. Expand Access",
  "Substep": "5.A.5",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe spawns cmd.exe",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"SuspiciousProcessChain - T1059.003 Windows Command Shell\" (5) was generated when powershell.exe spawned cmd.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "5. Expand Access",
  "Substep": "5.A.6",
  "Subtechnique": "T1059.003",
  "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Linux Capability"
  ],
  "Criteria": "Pscp.exe connects over SCP (port 22) to 10.0.0.7",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "Network Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "General",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A General detection named \"StandardCryptographicProtocol\" (1) was generated when pscp.exe connected over SCP (port 22) to bankfileserver (10.0.0.7).",
    "A Technique detection named \"SSHConnection - T1021 Remote Services\" (Low) was generated when a connection was made over port 22 to bankfileserver (10.0.0.7)."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "5. Expand Access",
  "Substep": "5.A.7",
  "Subtechnique": "T1021.004",
  "Subtechnique_Name": "Remote Services: SSH",
  "TacticGroup": "Lateral Movement",
  "Technique": "T1021",
  "Technique_Name": "Remote Services"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Linux Capability"
  ],
  "Criteria": "User kmitnick logs on to bankfileserver (10.0.0.7)",
  "Datasources": [
    "Authentication Logs",
    "Authentication Logs"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"ValidAccounts - T1078 Valid Accounts\" (10) was generated when user kmitnick logged on to bankfileserver (10.0.0.7)."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "5. Expand Access",
  "Substep": "5.A.8",
  "Subtechnique": "T1078.002",
  "Subtechnique_Name": "Valid Accounts: Domain Accounts",
  "TacticGroup": "Persistence",
  "Technique": "T1078",
  "Technique_Name": "Valid Accounts"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Linux Capability"
  ],
  "Criteria": "Pscp.exe copies psexec.py to 10.0.0.7",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"RemoteFileCopy - T1105 Remote File Copy\" (20) was generated when scp on bankfileserver (10.0.0.7) was invoked by another scp instance to receive psexec.py."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "5. Expand Access",
  "Substep": "5.A.9",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Lateral Movement",
  "Technique": "T1570",
  "Technique_Name": "Lateral Tool Transfer"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Linux Capability"
  ],
  "Criteria": "Pscp.exe copies runtime to 10.0.0.7",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"RemoteFileCopy - T1105 Remote File Copy\" (20) was generated when scp on bankfileserver (10.0.0.7) was invoked by another scp instance to receive runtime."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "5. Expand Access",
  "Substep": "5.A.10",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Lateral Movement",
  "Technique": "T1570",
  "Technique_Name": "Lateral Tool Transfer"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Linux Capability"
  ],
  "Criteria": "Pscp.exe copies tiny.exe to 10.0.0.7",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"RemoteFileCopy - T1105 Remote File Copy\" (20) was generated when scp on bankfileserver (10.0.0.7) was invoked by another scp instance to receive tiny.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "5. Expand Access",
  "Substep": "5.A.11",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Lateral Movement",
  "Technique": "T1570",
  "Technique_Name": "Lateral Tool Transfer"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Linux Capability"
  ],
  "Criteria": "plink.exe connects over SSH (port 22) to 10.0.0.7",
  "Datasources": [
    "Process Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "Network Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"SSHConnection - T1021 Remote Services\" (Low) was generated when a connection was made over SSH (port 22) to bankfileserver (10.0.0.7)."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "5. Expand Access",
  "Substep": "5.B.1",
  "Subtechnique": "T1021.004",
  "Subtechnique_Name": "Remote Services: SSH",
  "TacticGroup": "Lateral Movement",
  "Technique": "T1021",
  "Technique_Name": "Remote Services"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Linux Capability"
  ],
  "Criteria": "User kmitnick logs on to bankfileserver (10.0.0.7)",
  "Datasources": [
    "Authentication Logs",
    "Authentication Logs"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"Login - T1078 Valid Accounts\" (10) was generated when user kmitnick logged on to bankfileserver (10.0.0.7)."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "5. Expand Access",
  "Substep": "5.B.2",
  "Subtechnique": "T1078.002",
  "Subtechnique_Name": "Valid Accounts: Domain Accounts",
  "TacticGroup": "Persistence",
  "Technique": "T1078",
  "Technique_Name": "Valid Accounts"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Linux Capability"
  ],
  "Criteria": "User kmitnick executes ps ax",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"ProcessDiscovery - T1057 Process Discovery\" (Low) was generated when user kmitnick executed ps ax."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "5. Expand Access",
  "Substep": "5.B.3",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "Technique_Name": "Process Discovery"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Linux Capability"
  ],
  "Criteria": "User kmitnick executes ls -lsahR /var/",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"FileAndDirectoryDiscovery - T1083 File and Directory Discovery\" was generated when user kmitnick executed ls -lsahR /var/."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "5. Expand Access",
  "Substep": "5.B.4",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "Technique_Name": "File and Directory Discovery"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Linux Capability"
  ],
  "Criteria": "User kmitnick reads network-diagram-financial.xml via cat",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detection Logic)",
    "Configuration Change (UX)",
    "Configuration Change (Detection Logic)",
    "Configuration Change (UX)"
  ],
  "DetectionText": [
    "A Technique detection named \"DataCollection - T1005 Data from Local System\" (Info) was generated when user kmitnick read network-diagram-financial.xml via cat."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "5. Expand Access",
  "Substep": "5.B.5",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Collection",
  "Technique": "T1005",
  "Technique_Name": "Data from Local System"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Linux Capability"
  ],
  "Criteria": "User kmitnick reads help-desk-ticket.txt via cat",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detection Logic)",
    "Configuration Change (UX)",
    "Configuration Change (Detection Logic)",
    "Configuration Change (UX)"
  ],
  "DetectionText": [
    "A Technique detection named \"DataCollection - T1005 Data from Local System\" (Low) was generated when user kmitnick read help-desk-ticket.txt via cat."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "5. Expand Access",
  "Substep": "5.B.6",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Collection",
  "Technique": "T1005",
  "Technique_Name": "Data from Local System"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Linux Capability"
  ],
  "Criteria": "User kmitnick enumerates the domain controller via nslookup, which queries for the DC (10.0.0.4) over DNS (port 53)",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Tactic",
    "Technique"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detection Logic)",
    "Configuration Change (Detection Logic)"
  ],
  "DetectionText": [
    "A Tactic detection named \"DNSLookup - Discovery\" was generated when user kmitnick enumerated the domain controller via nslookup.",
    "A Technique detection named \"DNSLookup - T1018 Remote System Discovery\" (Low) was generated when user kmitnick enumerated the domain controller via nslookup."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "5. Expand Access",
  "Substep": "5.B.7",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1018",
  "Technique_Name": "Remote System Discovery"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "psexec.py creates a logon to 10.0.0.4 as user kmitnick",
  "Datasources": [
    "Process Monitoring",
    "Windows Event Logs",
    "Process Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "Network Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Tactic",
    "Technique"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detection Logic)"
  ],
  "DetectionText": [
    "A Tactic detection named \"PossibleReverseShell - Lateral Movement\" was generated when psexec.py created a logon to 10.0.0.4 as user kmitnick.",
    "A Technique detection named \"GenericPassTheHash - T1075 - Pass the Hash\" (Medium) was generated when psexec.py created a logon to 10.0.0.4 as user kmitnick."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "5. Expand Access",
  "Substep": "5.C.1",
  "Subtechnique": "T1550.002",
  "Subtechnique_Name": "Use Alternate Authentication Material: Pass the Hash",
  "TacticGroup": "Lateral Movement",
  "Technique": "T1550",
  "Technique_Name": "Use Alternate Authentication Material"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "psexec.py connects to SMB shares on 10.0.0.4",
  "Datasources": [
    "Process Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "Network Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Tactic",
    "Technique"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detection Logic)",
    "Configuration Change (Detection Logic)"
  ],
  "DetectionText": [
    "A Tactic detection named \"PossibleReverseShell - Lateral Movement\" was generated when python connects to port 445 on 10.0.0.4.",
    "A Technique detection named \"SMBConnection - T1077 Windows Admin Shares\" was generated when psexec.py connected to SMB shares on bankdc (10.0.0.4)."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "5. Expand Access",
  "Substep": "5.C.2",
  "Subtechnique": "T1021.002",
  "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares",
  "TacticGroup": "Lateral Movement",
  "Technique": "T1021",
  "Technique_Name": "Remote Services"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "cmd.exe spawns from a service executable in C:\\Windows\\",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detection Logic)"
  ],
  "DetectionText": [
    "A Technique detection named \"T1569.002 Service Execution\" was generated when cmd.exe spawns from a service executable in C:\\Windows\\."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "5. Expand Access",
  "Substep": "5.C.3",
  "Subtechnique": "T1569.002",
  "Subtechnique_Name": "System Services: Service Execution",
  "TacticGroup": "Execution",
  "Technique": "T1569",
  "Technique_Name": "System Services"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "tiny.exe is created on 10.0.0.4",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "5. Expand Access",
  "Substep": "5.C.4",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Lateral Movement",
  "Technique": "T1570",
  "Technique_Name": "Lateral Tool Transfer"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "cmd.exe spawns tiny.exe",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"ProcessCreate - T1059 Command Line Interface\" (1) was generated when cmd.exe spawned tiny.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "5. Expand Access",
  "Substep": "5.C.5",
  "Subtechnique": "T1059.003",
  "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "tiny.exe loads shellcode from network connection into memory",
  "Datasources": [
    "Process Monitoring",
    "System Calls/API Monitoring",
    "Process Monitoring",
    "System Calls/API Monitoring"
  ],
  "Detection": [
    "General",
    "Tactic"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A General detection named \"Generic.Exploit.ReflectiveLoader\" (High) was generated when tiny.exe loaded shellcode into memory.",
    "A Tactic detection named \"PEInjected - Defense Evasion\" (Medium) was generated when tiny.exe loaded shellcode into memory."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "5. Expand Access",
  "Substep": "5.C.6",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Defense Evasion",
  "Technique": "T1140",
  "Technique_Name": "Deobfuscate/Decode Files or Information"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "tiny.exe loads system.management.automation.dll",
  "Datasources": [
    "Process Monitoring",
    "DLL Monitoring",
    "Process Monitoring",
    "DLL Monitoring",
    "Process Monitoring",
    "DLL Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique",
    "Technique"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detection Logic)",
    "Configuration Change (Detection Logic)",
    "Configuration Change (Detection Logic)"
  ],
  "DetectionText": [
    "A Technique detection named \"PowershellLoadedIntoMemeory\" (Low) was generated when tiny.exe loaded system.management.automation.dll.",
    "A Technique detection named \"SuspiciousAutomationDllLoaded - T1059.001 PowerShell\" (Low) was generated when tiny.exe loaded system.management.automation.dll."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "6. Discover Potential Targets",
  "Substep": "6.A.1",
  "Subtechnique": "T1059.001",
  "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "PowerShell executes Get-ADComputer",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "6. Discover Potential Targets",
  "Substep": "6.A.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1018",
  "Technique_Name": "Remote System Discovery"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "PowerShell executes Get-NetUser",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "6. Discover Potential Targets",
  "Substep": "6.A.3",
  "Subtechnique": "T1087.002",
  "Subtechnique_Name": "Account Discovery: Domain Account",
  "TacticGroup": "Discovery",
  "Technique": "T1087",
  "Technique_Name": "Account Discovery"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "tiny.exe downloads plink.exe from 192.168.0.4",
  "Datasources": [
    "Process Monitoring",
    "File Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "File Monitoring",
    "Process Monitoring",
    "Network Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "General",
    "Technique"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detection Logic)"
  ],
  "DetectionText": [
    "A General detection named \"Suspicious File Write\" (1) was generated when tiny.exe downloaded plink.exe from 192.168.0.4.",
    "A Technique detection named \"Suspicious File Write - T1105 Ingress Tool Transfer\" was generated when tiny.exe downloaded plink.exe from 192.168.0.4."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "7. Setup Persistence",
  "Substep": "7.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "tiny.exe spawns cmd.exe",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"Suspicious Child of Injected Process - T1059.003 Windows Command Shell\" was generated when tiny.exe spawned cmd.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "7. Setup Persistence",
  "Substep": "7.A.2",
  "Subtechnique": "T1059.003",
  "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "plink.exe transmits data to 192.168.0.4 over SSH protocol",
  "Datasources": [
    "Process Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "Network Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"StandardCryptographicProtocol - T1071 Application Layer Protocol\" (Info) was generated when plink.exe exchanged data with 192.168.0.4 over SSH protocol."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "7. Setup Persistence",
  "Substep": "7.A.3",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1071",
  "Technique_Name": "Application Layer Protocol"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "User kmitnick logs on to bankdc (10.0.0.4)",
  "Datasources": [
    "Windows Event Logs",
    "Windows Event Logs"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"UserLogon - T1078 Valid Accounts\" was generated when user kmitnick logged on to bankdc (10.0.0.4)."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "7. Setup Persistence",
  "Substep": "7.A.4",
  "Subtechnique": "T1078.002",
  "Subtechnique_Name": "Valid Accounts: Domain Accounts",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1078",
  "Technique_Name": "Valid Accounts"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "RDP session from the localhost over TCP port 3389",
  "Datasources": [
    "Process Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "Network Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"RemoteDesktopConnection - T1021.001 Remote Desktop Protocol\" (Low) was generated when an RDP session was created from localhost over port 3389."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "7. Setup Persistence",
  "Substep": "7.A.5",
  "Subtechnique": "T1021.001",
  "Subtechnique_Name": "Remote Services: Remote Desktop Protocol",
  "TacticGroup": "Lateral Movement",
  "Technique": "T1021",
  "Technique_Name": "Remote Services"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executes qwinsta /server:cfo",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"QwinstaProcessExecuted - T1033 System Owner/User Discovery\" (10) was generated when powershell.exe executed qwinsta /server:cfo."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "7. Setup Persistence",
  "Substep": "7.B.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1033",
  "Technique_Name": "System Owner/User Discovery"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "User kmitnick logs on to cfo (10.0.0.5)",
  "Datasources": [
    "Windows Event Logs"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"UserLogon - T1078 Valid Accounts\" (1) was generated when user kmitnick logged on to cfo (10.0.0.5)."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "7. Setup Persistence",
  "Substep": "7.B.2",
  "Subtechnique": "T1078.002",
  "Subtechnique_Name": "Valid Accounts: Domain Accounts",
  "TacticGroup": "Persistence",
  "Technique": "T1078",
  "Technique_Name": "Valid Accounts"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "RDP session from 10.0.0.4 to 10.0.0.5 over TCP port 3389",
  "Datasources": [
    "Process Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "Network Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"RdpConnection - T1021.001 Remote Desktop Protocol\" (1) was generated when an RDP session was created from bankdc (10.0.0.4) to cfo (10.0.0.5) over port 3389."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "7. Setup Persistence",
  "Substep": "7.B.3",
  "Subtechnique": "T1021.001",
  "Subtechnique_Name": "Remote Services: Remote Desktop Protocol",
  "TacticGroup": "Lateral Movement",
  "Technique": "T1021",
  "Technique_Name": "Remote Services"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "scp.exe downloads Java-Update.exe from 192.168.0.4",
  "Datasources": [
    "Process Monitoring",
    "File Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "File Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "General"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A General detection named \"File Written in User Directory\" was generated when scp.exe downloaded Java-Update.exe from 192.168.0.4."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "7. Setup Persistence",
  "Substep": "7.C.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "dir lists the contents of C:\\Users\\Public",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "7. Setup Persistence",
  "Substep": "7.C.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "Technique_Name": "File and Directory Discovery"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "cmd.exe downloads Java-Update.vbs from 192.168.0.4",
  "Datasources": [
    "Process Monitoring",
    "File Monitoring",
    "Network Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "General"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A General detection named \"File Detected as Suspicious by Analysis\" was generated when cmd.exe downloaded Java-Update.vbs from 192.168.0.4."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "7. Setup Persistence",
  "Substep": "7.C.3",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "Java-Update subkey is added to HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run",
  "Datasources": [
    "Process Monitoring",
    "Windows Registry",
    "Process Monitoring",
    "Windows Registry"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"Run Key Write - T1547.001 Registry Run Keys / Startup Folder\" was generated when Java-Update subkey was added to HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "7. Setup Persistence",
  "Substep": "7.C.4",
  "Subtechnique": "T1547.001",
  "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder",
  "TacticGroup": "Persistence",
  "Technique": "T1547",
  "Technique_Name": "Boot or Logon Autostart Execution"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "wscript.exe spawns Java-Update.exe",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring",
    "System Calls/API Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"SuspiciousComObjectUsed - T1059.005 Visual Basic\" (Medium) was generated when wscript.exe used a suspicious COM object in the execution of Java-Update.vbs.",
    "A Technique detection named \"WscriptProcessExecuted - T1059.005 Visual Basic\" was generated when wscript.exe executed Java-Update.vbs and spawned Java-Update.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "8. Gain Covert Access to Target",
  "Substep": "8.A.1",
  "Subtechnique": "T1059.005",
  "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "Java-Update.exe transmits data to 192.168.0.4 over HTTPS protocol",
  "Datasources": [
    "Process Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "Network Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"StandardCryptographicProtocol - T1071.001 Web Protocols\" (Info) was generated when Java-Update.exe exchanged data with 192.168.0.4 over HTTPS protocol (port 80)."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "8. Gain Covert Access to Target",
  "Substep": "8.A.2",
  "Subtechnique": "T1071.001",
  "Subtechnique_Name": "Application Layer Protocol: Web Protocols",
  "TacticGroup": "Command and Control",
  "Technique": "T1071",
  "Technique_Name": "Application Layer Protocol"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "Java-Update.exe transmits data to 192.168.0.4 over HTTPS protocol",
  "Datasources": [
    "Process Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "Network Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"StandardCryptographicProtocol - T1573 Encrypted Channel\" (Info) was generated when Java-Update.exe exchanged data with 192.168.0.4 over HTTPS protocol (port 80)."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "8. Gain Covert Access to Target",
  "Substep": "8.A.3",
  "Subtechnique": "T1573.002",
  "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography",
  "TacticGroup": "Command and Control",
  "Technique": "T1573",
  "Technique_Name": "Encrypted Channel"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "Java-Update.exe downloads DefenderUpgradeExec.exe from 192.168.0.4",
  "Datasources": [
    "Process Monitoring",
    "File Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "File Monitoring",
    "Network Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"Suspicious File Drop - T1105 Ingress Tool Transfer\" (Low) was generated when Java-Update.exe downloaded DefenderUpgradeExec.exe from 192.168.0.4."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "9. Profile a Victim User",
  "Substep": "9.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "DefenderUpgradeExec.exe calls the SetWindowsHookEx API",
  "Datasources": [
    "Process Monitoring",
    "System Calls/API Monitoring",
    "Process Monitoring",
    "System Calls/API Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"UnsafeHooking - T1056 Input Capture\" (Low) was generated when DefenderUpgradeExec.exe executed a hooking command."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "9. Profile a Victim User",
  "Substep": "9.A.2",
  "Subtechnique": "T1056.001",
  "Subtechnique_Name": "Input Capture: Keylogging",
  "TacticGroup": "Credential Access",
  "Technique": "T1056",
  "Technique_Name": "Input Capture"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "Java-Update.exe injects into explorer.exe with CreateRemoteThread",
  "Datasources": [
    "Process Monitoring",
    "System Calls/API Monitoring",
    "Process Monitoring",
    "System Calls/API Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"InjectionCreateThreadKm, InjectionWriteProcMemory - T1055 Process Injection\" (Low) was generated when Java-Update.exe injected into explorer.exe with CreateRemoteThread."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "9. Profile a Victim User",
  "Substep": "9.A.3",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Defense Evasion",
  "Technique": "T1055",
  "Technique_Name": "Process Injection"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "explorer.exe calls the CreateCompatibleBitmap API from Gdi32.dll",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "9. Profile a Victim User",
  "Substep": "9.A.4",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Collection",
  "Technique": "T1113",
  "Technique_Name": "Screen Capture"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "explorer.exe reads C:\\Users\\jsmith\\AppData\\Local\\Temp\\Klog2.txt over to 192.168.0.4",
  "Datasources": [
    "Process Monitoring",
    "File Monitoring",
    "Network Monitoring"
  ],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detection Logic)"
  ],
  "DetectionText": [],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "9. Profile a Victim User",
  "Substep": "9.A.5",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Collection",
  "Technique": "T1005",
  "Technique_Name": "Data from Local System"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "explorer.exe downloads infosMin48.exe from 192.168.0.4",
  "Datasources": [
    "File Monitoring",
    "Network Monitoring"
  ],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "9. Profile a Victim User",
  "Substep": "9.B.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "infosMin48.exe calls the VaultEnumerateItems API from vaultcli.dll",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring",
    "System Calls/API Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detection Logic)",
    "Configuration Change (Detection Logic)"
  ],
  "DetectionText": [
    "A Technique detection named \"VaultEnumerateItemsCall - T1555.003 Credentials from Web Browsers\" (Low) was generated when infosMin48.exe called VaultEnumerateItems API."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "9. Profile a Victim User",
  "Substep": "9.B.2",
  "Subtechnique": "T1555.003",
  "Subtechnique_Name": "Credentials from Password Stores: Credentials from Web Browsers",
  "TacticGroup": "Credential Access",
  "Technique": "T1555",
  "Technique_Name": "Credentials from Password Stores"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe deletes files from C:\\Users\\jsmith\\AppData\\Local\\Temp\\",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring",
    "File Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"TraceFileDeletion - T1070.004 File Deletion\" (Low) was generated when powershell.exe deleted files from C:\\Users\\jsmith\\AppData\\Local\\Temp\\.",
    "A Technique detection named \"PowershellRemoveItem - T1070.004 File Deletion\" (Low) was generated when powershell.exe deleted files from C:\\Users\\jsmith\\AppData\\Local\\Temp\\."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "9. Profile a Victim User",
  "Substep": "9.B.3",
  "Subtechnique": "T1070.004",
  "Subtechnique_Name": "Indicator Removal on Host: File Deletion",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1070",
  "Technique_Name": "Indicator Removal on Host"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "explorer.exe downloads tightvnc-2.8.27-gpl-setup-64bit.msi from 192.168.0.4",
  "Datasources": [
    "Process Monitoring",
    "File Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "File Monitoring",
    "Network Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "General"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A General detection named \"FileWrittenInUserDirectory\" (10) was generated when explorer.exe downloaded tightvnc-2.8.27-gpl-setup-64bit.msi from 192.168.0.4."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "10. Impersonate Victim",
  "Substep": "10.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "explorer.exe downloads vnc-settings.reg from 192.168.0.4",
  "Datasources": [
    "Process Monitoring",
    "File Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "File Monitoring",
    "Network Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "General"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A General detection named \"FileWrittenInUserDirectory\" (10) was generated when explorer.exe downloaded vnc-settings.reg from 192.168.0.4."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "10. Impersonate Victim",
  "Substep": "10.A.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "netsh adds Service Host rule for TCP port 5900",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"NetshDisableFirewall - T1562.004 Disable or Modify System Firewall\" (10) was generated when netsh.exe added 'Service Host' rule to allow TCP port 5900 inbound."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "10. Impersonate Victim",
  "Substep": "10.A.3",
  "Subtechnique": "T1562.004",
  "Subtechnique_Name": "Impair Defenses: Disable or Modify System Firewall",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1562",
  "Technique_Name": "Impair Defenses"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "msiexec.exe adds the tvncontrol subkey in HKLM\\Software\\Microsoft\\CurrentVersion\\Run",
  "Datasources": [
    "Process Monitoring",
    "Windows Registry",
    "Process Monitoring",
    "Windows Registry"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"RunKeyWritten - T1547.001 Registry Run Keys / Startup Folder\" (30) was generated when tvncontrol subkey was added to HKLM\\Software\\Microsoft\\CurrentVersion\\Run."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "10. Impersonate Victim",
  "Substep": "10.A.4",
  "Subtechnique": "T1547.001",
  "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder",
  "TacticGroup": "Persistence",
  "Technique": "T1547",
  "Technique_Name": "Boot or Logon Autostart Execution"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "Addition of subkeys in HKLM\\Software\\TightVNC\\Server",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "10. Impersonate Victim",
  "Substep": "10.A.5",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Defense Evasion",
  "Technique": "T1112",
  "Technique_Name": "Modify Registry"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "Deletion of the Java-Update subkey in HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"RegistryManipulation - T1112 Modify Registry\" (10) was generated when Java-Update subkey at HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run was deleted."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "10. Impersonate Victim",
  "Substep": "10.A.6",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Defense Evasion",
  "Technique": "T1112",
  "Technique_Name": "Modify Registry"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "tvnserver.exe accepts a connection from 192.168.0.4 over TCP port 5900",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "10. Impersonate Victim",
  "Substep": "10.B.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1219",
  "Technique_Name": "Remote Access Software"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "explorer.exe spawns winword.exe when user clicks 2-list.rtf",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"T1204 User Execution\" was generated when explorer.exe spawned winword.exe when the user clicked 2-list.rtf."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "11. Initial Breach",
  "Substep": "11.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Execution",
  "Technique": "T1204",
  "Technique_Name": "User Execution"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "2-list.rtf contains an embedded lnk payload that is dropped to disk",
  "Datasources": [
    "Process Monitoring",
    "File Monitoring",
    "Process Monitoring",
    "File Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "General"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A General detection named \"Antimalware static engines detected a potential security breach\" (High) was generated when 2-list.rtf contained an embedded lnk payload."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "11. Initial Breach",
  "Substep": "11.A.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Defense Evasion",
  "Technique": "T1027",
  "Technique_Name": "Obfuscated Files or Information"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "winword.exe spawns mshta.exe",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring",
    "File Monitoring",
    "Process Monitoring",
    "File Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "General",
    "Technique",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A General detection named \"Antimalware detected mshta.exe executed a suspicious command line \" (High) was generated when winword.exe spawned mshta.exe.",
    "A Technique detection named \"ProcessLaunchFromShortcut - T1218.005 Mshta\" (Low) was generated when unprotected.lnk launched mshta.exe.",
    "A Technique detection named \"Microsoft Office Suspicious Child  - T1218.005 Mshta\" was generated when winword.exe spawned mshta.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "11. Initial Breach",
  "Substep": "11.A.3",
  "Subtechnique": "T1218.005",
  "Subtechnique_Name": "Signed Binary Proxy Execution: Mshta",
  "TacticGroup": "Execution",
  "Technique": "T1218",
  "Technique_Name": "Signed Binary Proxy Execution"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "mshta.exe executes an embedded VBScript payload",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring",
    "File Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"Antimalware detected mshta.exe executed a suspicious command line - T1059 Command and Scripting Interpeter\" (High) was generated when mshta.exe executed an embedded VBScript payload."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "11. Initial Breach",
  "Substep": "11.A.4",
  "Subtechnique": "T1059.005",
  "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "mshta.exe assembles text embedded within 2-list.rtf into a JS payload",
  "Datasources": [
    "Process Monitoring",
    "File Monitoring",
    "Process Monitoring",
    "File Monitoring",
    "Process Monitoring",
    "File Monitoring",
    "Process Monitoring",
    "File Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "General",
    "General",
    "Technique"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detection Logic)"
  ],
  "DetectionText": [
    "A General detection named \"Suspicious File Write\" (Info) was generated when mshta.exe created sql-rat.js.",
    "A General detection named \"Antimalware static engines detected a potential security breach\" (High) was generated when mshta.exe created sql-rat.js.",
    "A Technique detection named \"MshtaJSDrop - T1140 Deobfuscate/Decode Files or Information\" (Low) was generated when mshta.exe assembled text embedded within 2-list.rtf into a JS payload."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "11. Initial Breach",
  "Substep": "11.A.5",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Defense Evasion",
  "Technique": "T1140",
  "Technique_Name": "Deobfuscate/Decode Files or Information"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "mshta.exe makes a copy of the legitimate wscript.exe as Adb156.exe",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [
    "Delayed"
  ],
  "DetectionText": [
    "A Technique detection named \"RenamedWscriptExecuted - T1036.003 Rename System Utilities\" was generated when a renamed wscript.exe was executed as adb156.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "11. Initial Breach",
  "Substep": "11.A.6",
  "Subtechnique": "T1036.003",
  "Subtechnique_Name": "Masquerading: Rename System Utilities",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1036",
  "Technique_Name": "Masquerading"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "winword.exe spawns verclsid.exe and loads VBE7.DLL, VBEUI.DLL, and VBE7INTL.DLL",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"VerClsidProcessExecutedComObject - T1559.001 Component Object Model\" (Low) was generated when winword.exe spawned verclsid.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "11. Initial Breach",
  "Substep": "11.A.7",
  "Subtechnique": "T1559.001",
  "Subtechnique_Name": "Inter-Process Communication: Component Object Model",
  "TacticGroup": "Execution",
  "Technique": "T1559",
  "Technique_Name": "Inter-Process Communication"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "mshta.exe loads taskschd.dll and creates a scheduled task to execute in 5 minutes",
  "Datasources": [
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "11. Initial Breach",
  "Substep": "11.A.8",
  "Subtechnique": "T1053.005",
  "Subtechnique_Name": "Scheduled Task/Job: Scheduled Task",
  "TacticGroup": "Execution",
  "Technique": "T1053",
  "Technique_Name": "Scheduled Task/Job"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "svchost.exe (-s Schedule) spawns Adb156.exe",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detection Logic)"
  ],
  "DetectionText": [
    "A Technique detection named \"ScheduledTaskExecuted - T1053.005 Scheduled Task\" (Info) was generated when svchost.exe (-s Schedule) spawned adb156.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "12. Delayed Malware Execution",
  "Substep": "12.A.1",
  "Subtechnique": "T1053.005",
  "Subtechnique_Name": "Scheduled Task/Job: Scheduled Task",
  "TacticGroup": "Execution",
  "Technique": "T1053",
  "Technique_Name": "Scheduled Task/Job"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "Adb156.exe loads scrobj.dll and executes sql-rat.js using Jscript",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "General",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A General detection named \"ProcessCreate\" (1) was generated when adb156.exe executed sql-rat.js using Jscript.",
    "A Technique detection named \"WscriptProcessExecuted - T1059 Command and Scripting Interpreter\" (1) was generated when adb156.exe executed sql-rat.js using Jscript."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "12. Delayed Malware Execution",
  "Substep": "12.A.2",
  "Subtechnique": "T1059.007",
  "Subtechnique_Name": "Command and Scripting Interpreter: JavaScript/JScript",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "Adb156.exe transmits data to 192.168.0.6 via MSSQL transactions",
  "Datasources": [
    "Process Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "Network Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"T1071 Application Layer Protocol\" (Info) was generated when adb156.exe connected to 192.168.0.56 via MSSQL transactions (port 1433)."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "12. Delayed Malware Execution",
  "Substep": "12.A.3",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1071",
  "Technique_Name": "Application Layer Protocol"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "Adb156.exe makes a WMI query for Win32_NetworkAdapterConfiguration",
  "Datasources": [
    "Process Monitoring",
    "WMI Objects",
    "Process Monitoring",
    "WMI Objects"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"WMINetworkAdapter - T1016 System Network Configuration Discovery\" (Low) was generated when adb156.exe made a WMI query for Win32_NetworkAdapterConfiguration."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "12. Delayed Malware Execution",
  "Substep": "12.A.4",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1016",
  "Technique_Name": "System Network Configuration Discovery"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "Adb156.exe makes a WMI query for Win32_LogicalDisk",
  "Datasources": [
    "Process Monitoring",
    "WMI Objects",
    "Process Monitoring",
    "WMI Objects",
    "Process Monitoring",
    "WMI Objects"
  ],
  "Detection": [
    "Telemetry",
    "Tactic",
    "Technique"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detection Logic)"
  ],
  "DetectionText": [
    "A Tactic detection named \"Discovery\" (Low) was generated when adb156.exe made a WMI query for Win32_LogicalDisk.",
    "A Technique detection named \"WmiPeripheralDeviceDiscovery - T1082 System Information Discovery\" (Low) was generated when adb156.exe makes a WMI query for Win32_LogicalDisk."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "12. Delayed Malware Execution",
  "Substep": "12.A.5",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1082",
  "Technique_Name": "System Information Discovery"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "Adb156.exe downloads stager.ps1 from 192.168.0.6",
  "Datasources": [
    "Process Monitoring",
    "File Monitoring",
    "Process Monitoring",
    "File Monitoring",
    "Process Monitoring",
    "File Monitoring",
    "Network Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "General",
    "Technique"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detection Logic)"
  ],
  "DetectionText": [
    "A General detection named \"Antimalware static engines detected a potential security breach\" (High) was generated when adb156.exe created stager.ps1.",
    "A Technique detection named \"T1105 Ingress Tool Transfer\" was generated when adb156.exe downloads stager.ps1 from 192.168.0.6."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "12. Delayed Malware Execution",
  "Substep": "12.B.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "Adb156.exe makes a WMI query for Win32_Process",
  "Datasources": [
    "Process Monitoring",
    "WMI Objects",
    "Process Monitoring",
    "WMI Objects"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"WmiProcessDiscovery - T1057 Process Discovery\" (Low) was generated when adb156.exe made a WMI query for Win32_Process."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "13. Target Assessment",
  "Substep": "13.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "Technique_Name": "Process Discovery"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "Adb156.exe spawns cmd.exe",
  "Datasources": [
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "13. Target Assessment",
  "Substep": "13.A.2",
  "Subtechnique": "T1059.003",
  "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "cmd.exe executes net view",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"NET Remote System Discovery - T1135 Network Share Discovery\" was generated when cmd.exe executed net view."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "13. Target Assessment",
  "Substep": "13.A.3",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1135",
  "Technique_Name": "Network Share Discovery"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "Adb156.exe makes a WMI query for Win32_BIOS",
  "Datasources": [
    "Process Monitoring",
    "WMI Objects",
    "Process Monitoring",
    "WMI Objects"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"WMIBiosDiscovery - T1497 Virtualization/Sandbox Checks\" (Low) was generated when adb156.exe made a WMI query for Win32_BIOS."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "13. Target Assessment",
  "Substep": "13.A.4",
  "Subtechnique": "T1497.001",
  "Subtechnique_Name": "Virtualization/Sandbox Evasion: System Checks",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1497",
  "Technique_Name": "Virtualization/Sandbox Evasion"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "Adb156.exe queries the USERNAME environment variable",
  "Datasources": [
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "13. Target Assessment",
  "Substep": "13.A.5",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1033",
  "Technique_Name": "System Owner/User Discovery"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "Adb156.exe queries the COMPUTERNAME environment variable",
  "Datasources": [
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "13. Target Assessment",
  "Substep": "13.A.6",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1082",
  "Technique_Name": "System Information Discovery"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "Adb156.exe makes a WMI query for Win32_ComputerSystem",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring",
    "WMI Objects"
  ],
  "Detection": [
    "Telemetry",
    "Tactic"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Tactic detection named \"WmiSystemDiscovery - Discovery\" (Low) was generated when adb156.exe makes a WMI query for Win32_ComputerSystem."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "13. Target Assessment",
  "Substep": "13.A.8",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1016",
  "Technique_Name": "System Network Configuration Discovery"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "Adb156.exe makes a WMI query for Win32_OperatingSystem",
  "Datasources": [
    "Process Monitoring",
    "WMI Objects",
    "Process Monitoring",
    "WMI Objects"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"WMISuspiciousOperatingSystemDiscovery - T1092 System Information Discovery\" (Low) was generated when adb156.exe made a WMI query for Win32_OperatingSystem."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "13. Target Assessment",
  "Substep": "13.A.9",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1082",
  "Technique_Name": "System Information Discovery"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "Adb156.exe downloads takeScreenshot.ps1 from 192.168.0.6 via MSSQL transactions",
  "Datasources": [
    "Process Monitoring",
    "File Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "File Monitoring",
    "Process Monitoring",
    "File Monitoring",
    "Network Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "General",
    "Technique"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detection Logic)"
  ],
  "DetectionText": [
    "A General detection named \"Suspicious File Write\" (1) was generated when adb156.exe created takeScreenshot.ps1.",
    "A Technique detection named \"T1105 Ingress Tool Transfer\" was generated when adb156.exe downloads takeScreenshot.ps1."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "13. Target Assessment",
  "Substep": "13.B.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "Adb156.exe spawns cmd.exe",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"T1059.003 Command and Scripting Interpreter Windows Command Shell \" was generated when adb156.exe spawns cmd.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "13. Target Assessment",
  "Substep": "13.B.2",
  "Subtechnique": "T1059.003",
  "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "cmd.exe spawns powershell.exe",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"Cmd Spawns PowerShell Child - T1059.001 PowerShell\" (Low) was generated when cmd.exe spawned powershell.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "13. Target Assessment",
  "Substep": "13.B.3",
  "Subtechnique": "T1059.001",
  "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executes CopyFromScreen()",
  "Datasources": [
    "Process Monitoring",
    "System Calls/API Monitoring",
    "Process Monitoring",
    "System Calls/API Monitoring",
    "Process Monitoring",
    "File Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"Desktop Capture - T1113 Screen Capture\" (Low) was generated when powershell.exe took a screenshot of the desktop using the function GetDC.",
    "A Technique detection named \"PowershellTakesScreenShot - T1113 Screen Capture\" was generated when powershell.exe loaded a module to take screen captures then wrote a picture file."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "13. Target Assessment",
  "Substep": "13.B.4",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Collection",
  "Technique": "T1113",
  "Technique_Name": "Screen Capture"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "Adb156.exe reads and uploads image.png to 192.168.0.6 via MSSQL transactions",
  "Datasources": [
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "13. Target Assessment",
  "Substep": "13.B.5",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Exfiltration",
  "Technique": "T1041",
  "Technique_Name": "Exfiltration Over Command and Control Channel"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "Adb156.exe spawns cmd.exe",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"T1059.003 Command and Scripting Interpreter Windows Command Shell\" was generated when adb156.exe spawns cmd.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "14. Staging Interactive Toolkit",
  "Substep": "14.A.1",
  "Subtechnique": "T1059.003",
  "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "cmd.exe spawns powershell.exe",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"Cmd Spawns PowerShell Child - T1059.001 PowerShell\" (Low) was generated when cmd.exe spawned powershell.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "14. Staging Interactive Toolkit",
  "Substep": "14.A.2",
  "Subtechnique": "T1059.001",
  "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe decodes an embedded DLL payload",
  "Datasources": [
    "Process Monitoring",
    "System Calls/API Monitoring",
    "Process Monitoring",
    "System Calls/API Monitoring"
  ],
  "Detection": [
    "General",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A General detection named \"ZlibCompressionCommand\" was generated when powershell.exe made function calls related to zlib compression.",
    "A Technique detection named \"PowershellDecompressArchive - T1140 - Deobfuscate/Decode Files or Information\" (Low) was generated when powershell.exe made function calls to decompress an archive."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "14. Staging Interactive Toolkit",
  "Substep": "14.A.3",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Defense Evasion",
  "Technique": "T1140",
  "Technique_Name": "Deobfuscate/Decode Files or Information"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe executes the decoded payload using Invoke-Expression (IEX)",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"T1059.001 - Command and Scripting Interpreter PowerShell\" was generated when powershell.exe executes the decoded payload using Invoke-Expression (IEX)."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "14. Staging Interactive Toolkit",
  "Substep": "14.A.4",
  "Subtechnique": "T1059.001",
  "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe loads shellcode from network connection into memory",
  "Datasources": [
    "Process Monitoring",
    "System Calls/API Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "General",
    "Tactic"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A General detection named \"PEInjected\" was generated when powershell.exe loaded shellcode into memory.",
    "A Tactic detection named \"PEInjected - Defense Evasion\" was generated when powershell.exe loads shellcode from network connection into memory."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "14. Staging Interactive Toolkit",
  "Substep": "14.A.5",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Defense Evasion",
  "Technique": "T1140",
  "Technique_Name": "Deobfuscate/Decode Files or Information"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe transmits data to 192.168.0.4 over HTTPS protocol",
  "Datasources": [
    "Process Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "Network Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "General",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A General detection named \"PowershellSuspiciousPortUsage\" (Low) was generated when powershell.exe connected to 192.168.0.4 over port 443.",
    "A Technique detection named \"PowershellSslConnection - T1071.001 Web Protocols\" (Low) was generated when powershell.exe connected to 192.168.0.4 over HTTPS (port 443)."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "14. Staging Interactive Toolkit",
  "Substep": "14.A.6",
  "Subtechnique": "T1071.001",
  "Subtechnique_Name": "Application Layer Protocol: Web Protocols",
  "TacticGroup": "Command and Control",
  "Technique": "T1071",
  "Technique_Name": "Application Layer Protocol"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe transmits data to 192.168.0.4 over HTTPS protocol",
  "Datasources": [
    "Process Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "Network Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "General",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A General detection named \"PowershellSslConnection\" (Low) was generated when powershell.exe connected to 192.168.0.4 over HTTPS (port 443).",
    "A Technique detection named \"CryptographicProtocolUsage - T1573 Encrypted Channel\" was generated when powershell.exe connected to 192.168.0.4 over HTTPS (port 443)."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "14. Staging Interactive Toolkit",
  "Substep": "14.A.7",
  "Subtechnique": "T1573.002",
  "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography",
  "TacticGroup": "Command and Control",
  "Technique": "T1573",
  "Technique_Name": "Encrypted Channel"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe calls the CreateToolhelp32Snapshot() API",
  "Datasources": [
    "Process Monitoring",
    "System Calls/API Monitoring"
  ],
  "Detection": [
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"FindProcess - T1057 Process Discovery\" (Info) was generated when powershell.exe queried the list of running processes."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "15. Escalate Privileges",
  "Substep": "15.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "Technique_Name": "Process Discovery"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "powershell.exe downloads samcat.exe from 192.168.0.4",
  "Datasources": [
    "Process Monitoring",
    "File Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "File Monitoring",
    "Process Monitoring",
    "File Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "General",
    "Technique"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detection Logic)"
  ],
  "DetectionText": [
    "A General detection named \"Gen:Heur.Mimikatz\" (High) was generated when powershell.exe downloads samcat.exe from 192.168.0.4.",
    "A Technique detection named \"T1105 Ingress Tool Transfer\" was generated when powershell.exe downloads samcat.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "15. Escalate Privileges",
  "Substep": "15.A.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "powershell.exe downloads uac-samcats.ps1 from 192.168.0.4",
  "Datasources": [
    "Process Monitoring",
    "File Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "File Monitoring",
    "Process Monitoring",
    "File Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "General",
    "Technique"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detection Logic)"
  ],
  "DetectionText": [
    "A General detection named \"ScriptFileWrittenByPowershell\" (Low) was generated when powershell.exe downloaded uac-samcats.ps1 from 192.168.0.4.",
    "A Technique detection named \"T1105 Ingress Tool Transfer\" was generated when powershell.exe downloads uac-samcats.ps1."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "15. Escalate Privileges",
  "Substep": "15.A.3",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "powershell.exe spawns powershell.exe",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"PowershellStartedByPowershell - T1059.001 PowerShell\" (Low) was generated when powershell.exe spawned powershell.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "15. Escalate Privileges",
  "Substep": "15.A.4",
  "Subtechnique": "T1059.001",
  "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "powershell.exe spawns samcat.exe as a high-integrity process (note: Due to the configuration of the environment, the adversary's process was high by default. This sub-step was evaluated based on the criteria of detecting data related to process integrity level as well as the executed mechanics of the UAC bypass)",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring",
    "Process Monitoring",
    "Windows Registry"
  ],
  "Detection": [
    "Telemetry",
    "Tactic",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Tactic detection named \"TokenImpersonation - Privilege Escalation\" (Low) was generated when powershell.exe spawned samcat.exe with an elevated token.",
    "A Technique detection named \"User Account Control Registry Bypass - T1548.002 Bypass User Account Control\" (Low) was generated when a Registry entry used for User Account Control bypass was set."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "15. Escalate Privileges",
  "Substep": "15.A.5",
  "Subtechnique": "T1548.002",
  "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control",
  "TacticGroup": "Privilege Escalation",
  "Technique": "T1548",
  "Technique_Name": "Abuse Elevation Control Mechanism"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "samcat.exe opens and reads the SAM via LSASS",
  "Datasources": [
    "Process Monitoring",
    "Windows Registry",
    "Process Monitoring",
    "Windows Registry",
    "Process Monitoring",
    "Windows Registry"
  ],
  "Detection": [
    "Telemetry",
    "Tactic",
    "Technique"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detection Logic)",
    "Configuration Change (Detection Logic)",
    "Configuration Change (Detection Logic)"
  ],
  "DetectionText": [
    "A Tactic detection named \"SecurityAccountManagerRegistryAccess\" (Low) was generated when samcat.exe opened and read the SAM.",
    "A Technique detection named \"Registry Credentials Accessed - T1003 OS Credential Dumping\" (Low) was generated when samcat.exe opened and read the SAM."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "15. Escalate Privileges",
  "Substep": "15.A.6",
  "Subtechnique": "T1003.001",
  "Subtechnique_Name": "OS Credential Dumping: LSASS Memory",
  "TacticGroup": "Credential Access",
  "Technique": "T1003",
  "Technique_Name": "OS Credential Dumping"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "powershell.exe calls the GetIpNetTable() API",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "15. Escalate Privileges",
  "Substep": "15.A.7",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1016",
  "Technique_Name": "System Network Configuration Discovery"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "powershell.exe spawns nslookup.exe, which queries the DC (10.0.1.4) over DNS (port 53)",
  "Datasources": [
    "Process Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Tactic",
    "Technique"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detection Logic)"
  ],
  "DetectionText": [
    "A Tactic detection named \"Nslookup Process Execution\" (Low) was generated when powershell.exe spawned nslookup.exe, which queried the DC (10.0.1.4) over DNS (port 53).",
    "A Technique detection named \"T1018 Remote System Discovery\" was generated when powershell.exe spawned nslookup.exe, which queried the DC (10.0.1.4) over DNS (port 53)."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "15. Escalate Privileges",
  "Substep": "15.A.8",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1018",
  "Technique_Name": "Remote System Discovery"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "powershell.exe downloads paexec.exe from 192.168.0.4",
  "Datasources": [
    "Process Monitoring",
    "File Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "File Monitoring",
    "Process Monitoring",
    "File Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Tactic",
    "Technique"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detection Logic)"
  ],
  "DetectionText": [
    "A Tactic detection named \"Command and Control\" (Low) was generated when powershell.exe created paexec.exe.",
    "A Technique detection named \"T1105 Ingress Tool Transfer\" (Low) was generated when powershell.exe downloads paexec.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "16. Expand Access",
  "Substep": "16.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "powershell.exe downloads hollow.exe from 192.168.0.4",
  "Datasources": [
    "Process Monitoring",
    "File Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "Process Monitoring",
    "File Monitoring",
    "Process Monitoring",
    "File Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "General",
    "Tactic",
    "Technique"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detection Logic)"
  ],
  "DetectionText": [
    "A General detection named \"Antimalware static engines detected a potential security breach\" (High) was generated when powershell.exe created hollow.exe.",
    "A Tactic detection named \"Command and Control\" (Low) was generated when powershell.exe created hollow.exe.",
    "A Technique detection named \"T1105 Ingress Tool Transfer\" was generated when powershell.exe downloads hollow.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "16. Expand Access",
  "Substep": "16.A.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "powershell.exe spawns cmd.exe",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"SuspiciousProcessChain - T1059.003 Windows Command Shell\" (Info) was generated when powershell.exe spawned cmd.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "16. Expand Access",
  "Substep": "16.A.3",
  "Subtechnique": "T1059.003",
  "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "User kmitnick logs on to itadmin (10.0.1.6)",
  "Datasources": [
    "Windows Event Logs",
    "Windows Event Logs"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"UserLogon - T1078 Valid Accounts\" (1) was generated when user kmitnick logged on to itadmin (10.0.1.6)."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "16. Expand Access",
  "Substep": "16.A.4",
  "Subtechnique": "T1078.002",
  "Subtechnique_Name": "Valid Accounts: Domain Accounts",
  "TacticGroup": "Persistence",
  "Technique": "T1078",
  "Technique_Name": "Valid Accounts"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "SMB session from 10.0.1.5 to 10.0.1.6 over TCP port 135 or 445 with admin shares accessed",
  "Datasources": [
    "Process Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "File Monitoring",
    "Network Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "General",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A General detection named \"SMB Suspicious Write - Lateral Movement\" (Low) was generated when paexec.exe wrote PAExec-{PID}-HOTELMANAGER.exe to \\\\10.0.1.6\\admin$.",
    "A Technique detection named \"SmbTreeConnection - T1021.002 SMB/Windows Admin Shares\" (Info) was generated when an SMB session was created from hotelmanager (10.0.1.5) to itadmin (10.0.1.6) over port 445 with admin shares accessed."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "16. Expand Access",
  "Substep": "16.A.5",
  "Subtechnique": "T1021.002",
  "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares",
  "TacticGroup": "Lateral Movement",
  "Technique": "T1021",
  "Technique_Name": "Remote Services"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "Windows service started PAExec-{PID}-HOTELMANAGER.exe, which executes hollow.exe",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"ServiceExecuted\" (Info) was generated when Windows service started PAExec-{PID}-HOTELMANAGER.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "16. Expand Access",
  "Substep": "16.A.6",
  "Subtechnique": "T1569.002",
  "Subtechnique_Name": "System Services: Service Execution",
  "TacticGroup": "Execution",
  "Technique": "T1569",
  "Technique_Name": "System Services"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "hollow.exe spawns svchost.exe and unmaps its memory image via: NtUnmapViewOfSection",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring",
    "System Calls/API Monitoring",
    "Process Monitoring",
    "System Calls/API Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "General",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A General detection named \"InjectionWriteProcMemory\" was generated when hollow.exe wrote to the memory of a process by injection.",
    "A Technique detection named \"T1093 Process Hollowing\" (High) was generated when hollow.exe spawned and injected into svchost.exe ."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "16. Expand Access",
  "Substep": "16.A.7",
  "Subtechnique": "T1055.012",
  "Subtechnique_Name": "Process Injection: Process Hollowing",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1055",
  "Technique_Name": "Process Injection"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "svchost.exe transmits data to 192.168.0.4 over HTTPS protocol",
  "Datasources": [
    "Process Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "Network Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"StandardCryptographicProtocol - T1071.001 Web Protocols\" (Info) was generated when svchost.exe exchanged data with 192.168.0.4 over HTTPS protocol (port 443)."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "16. Expand Access",
  "Substep": "16.A.8",
  "Subtechnique": "T1071.001",
  "Subtechnique_Name": "Application Layer Protocol: Web Protocols",
  "TacticGroup": "Command and Control",
  "Technique": "T1071",
  "Technique_Name": "Application Layer Protocol"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "svchost.exe transmits data to 192.168.0.4 over HTTPS protocol",
  "Datasources": [
    "Process Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "Network Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "General",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A General detection named \"SslConnection\" (Info) was generated when svchost.exe exchanged data with 192.168.0.4 over HTTPS protocol (port 443).",
    "A Technique detection named \"StandardCryptographicProtocol - T1573 Encrypted Channel\" (Info) was generated when svchost.exe exchanged data with 192.168.0.4 over HTTPS protocol (port 443)."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "16. Expand Access",
  "Substep": "16.A.9",
  "Subtechnique": "T1573.002",
  "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography",
  "TacticGroup": "Command and Control",
  "Technique": "T1573",
  "Technique_Name": "Encrypted Channel"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "svchost.exe downloads srrstr.dll from 192.168.0.4 (port 443)",
  "Datasources": [
    "Process Monitoring",
    "File Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "File Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "File Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "General",
    "Technique"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detection Logic)"
  ],
  "DetectionText": [
    "A General detection named \"Suspicious File Write\" (1) was generated when svchost.exe created srrstr.dll.",
    "A Technique detection named \"Suspicious File Write - T1055 Ingress Tool Transfer\" (Info) was generated when svchost.exe downloads srrstr.dll."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "17. Setup User Monitoring",
  "Substep": "17.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "srrstr.dll is not the legitimate Windows System Protection Configuration Library",
  "Datasources": [
    "Sandbox",
    "Process Monitoring",
    "Process Monitoring",
    "File Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique",
    "Technique"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detection Logic)"
  ],
  "DetectionText": [
    "A Technique detection named \"Antimalware static engines identified a potential security breach - T1035 Masquerading\" (High) was generated when srrstr.dll was detected as not legitimate .",
    "A Technique detection named \"DllHijackSyswow - T1036.005 Masquerading: Match Legitimate Name or Location\" (Low) was generated when srrstr.dll was written to disk."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "17. Setup User Monitoring",
  "Substep": "17.A.2",
  "Subtechnique": "T1036.005",
  "Subtechnique_Name": "Masquerading: Match Legitimate Name or Location",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1036",
  "Technique_Name": "Masquerading"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "svchost.exe spawns cmd.exe",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"Suspicious Child of Injected Process - T1059.003 Windows Command Shell\" was generated when svchost.exe spawned cmd.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "17. Setup User Monitoring",
  "Substep": "17.A.3",
  "Subtechnique": "T1059.003",
  "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "SystemPropertiesAdvanced.exe executes code in the illegitimate srrstr.dll",
  "Datasources": [
    "Process Monitoring",
    "DLL Monitoring"
  ],
  "Detection": [
    "General"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A General detection named \"Rundll32 Uncommon Load\" (20) was generated when SystemPropertiesAdvanced.exe spawned rundll32.exe which loaded an uncommon resource."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "17. Setup User Monitoring",
  "Substep": "17.A.4",
  "Subtechnique": "T1574.001",
  "Subtechnique_Name": "Hijack Execution Flow: DLL Search Order Hijacking",
  "TacticGroup": "Privilege Escalation",
  "Technique": "T1574",
  "Technique_Name": "Hijack Execution Flow"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol",
  "Datasources": [
    "Process Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "Network Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"StandardCryptographicProtocol - T1071.001 Web Protocols\" (Info) was generated when rundll32.exe exchanged data with 192.168.0.4 over HTTPS protocol (port 8080)."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "17. Setup User Monitoring",
  "Substep": "17.A.5",
  "Subtechnique": "T1071.001",
  "Subtechnique_Name": "Application Layer Protocol: Web Protocols",
  "TacticGroup": "Command and Control",
  "Technique": "T1071",
  "Technique_Name": "Application Layer Protocol"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol",
  "Datasources": [
    "Process Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "Network Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"StandardCryptographicProtocol - T1573 Encrypted Channel\" (Info) was generated when rundll32.exe exchanged data with 192.168.0.4 over HTTPS protocol (port 8080)."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "17. Setup User Monitoring",
  "Substep": "17.A.6",
  "Subtechnique": "T1573.002",
  "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography",
  "TacticGroup": "Command and Control",
  "Technique": "T1573",
  "Technique_Name": "Encrypted Channel"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "svchost.exe injects into explorer.exe with CreateRemoteThread",
  "Datasources": [
    "Process Monitoring",
    "System Calls/API Monitoring",
    "Process Monitoring",
    "System Calls/API Monitoring"
  ],
  "Detection": [
    "Technique",
    "Technique"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detection Logic)",
    "Configuration Change (Detection Logic)"
  ],
  "DetectionText": [
    "A Technique detection named \"InjectionCreateThread - T1055 Process Injection\" (Low) was generated when svchost.exe injected into explorer.exe with CreateRemoteThread.",
    "A Technique detection named \"InjectionWriteProcMemory - T1055 Process Injection\" (Low) was generated when svchost.exe injected into explorer.exe with CreateRemoteThread."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "18. User Monitoring",
  "Substep": "18.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Defense Evasion",
  "Technique": "T1055",
  "Technique_Name": "Process Injection"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "explorer.exe calls the CreateCompatibleBitmap API from Gdi32.dll",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "18. User Monitoring",
  "Substep": "18.A.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Collection",
  "Technique": "T1113",
  "Technique_Name": "Screen Capture"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "explorer.exe injects into mstsc.exe with CreateRemoteThread",
  "Datasources": [
    "Process Monitoring",
    "System Calls/API Monitoring",
    "Process Monitoring",
    "System Calls/API Monitoring",
    "Process Monitoring",
    "System Calls/API Monitoring",
    "Process Monitoring",
    "System Calls/API Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique",
    "Technique",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"ProcessInjectionVictim - T1055 Process Injection\" (1) was generated when explorer.exe injected into mstsc.exe with CreateRemoteThread.",
    "A Technique detection named \"InjectionWriteProcMemory - T1055 Process Injection\" (40) was generated when explorer.exe injected into mstsc.exe with CreateRemoteThread.",
    "A Technique detection named \"InjectionRemoteThread - T1055 Process Injection\" (40) was generated when explorer.exe injected into mstsc.exe with CreateRemoteThread."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "18. User Monitoring",
  "Substep": "18.A.3",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Defense Evasion",
  "Technique": "T1055",
  "Technique_Name": "Process Injection"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "mstsc.exe calls APIs such as GetAsyncKeyState, GetKeyState, or GetKeyboardState",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "18. User Monitoring",
  "Substep": "18.A.4",
  "Subtechnique": "T1056.001",
  "Subtechnique_Name": "Input Capture: Keylogging",
  "TacticGroup": "Credential Access",
  "Technique": "T1056",
  "Technique_Name": "Input Capture"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "User kmitnick logs on to accounting (10.0.1.7)",
  "Datasources": [
    "Windows Event Logs",
    "Windows Event Logs"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"UserLogon - T1078.003 Local Accounts\" (1) was generated when user kmitnick logged on to accounting (10.0.1.7)."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "19. Setup Shim Persistence",
  "Substep": "19.A.1",
  "Subtechnique": "T1078.002",
  "Subtechnique_Name": "Valid Accounts: Domain Accounts",
  "TacticGroup": "Persistence",
  "Technique": "T1078",
  "Technique_Name": "Valid Accounts"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "RDP session from 10.0.1.6 to 10.0.1.7 over TCP port 3389",
  "Datasources": [
    "Process Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "Network Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"RemoteDesktopConnection - T1021.001 Remote Desktop Protocol\" (20) was generated when an RDP session was created from itadmin (10.0.1.6) to accounting (10.0.1.7) over port 3389."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "19. Setup Shim Persistence",
  "Substep": "19.A.2",
  "Subtechnique": "T1021.001",
  "Subtechnique_Name": "Remote Services: Remote Desktop Protocol",
  "TacticGroup": "Lateral Movement",
  "Technique": "T1021",
  "Technique_Name": "Remote Services"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "itadmin (10.0.1.6) is relaying RDP traffic from attacker infrastructure",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "19. Setup Shim Persistence",
  "Substep": "19.A.3",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1090",
  "Technique_Name": "Proxy"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "powershell.exe spawns powershell.exe",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"PowershellStartedByPowershell - T1059.001 PowerShell\" was generated when powershell.exe spawned powershell.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "19. Setup Shim Persistence",
  "Substep": "19.B.1",
  "Subtechnique": "T1059.001",
  "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "powershell.exe executes base64 encoded commands",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"PowerShell Encoded Command\" (Low) was generated when powershell.exe executed base64 encoded commands."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "19. Setup Shim Persistence",
  "Substep": "19.B.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Defense Evasion",
  "Technique": "T1027",
  "Technique_Name": "Obfuscated Files or Information"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "powershell.exe downloads dll329.dll from 192.168.0.4",
  "Datasources": [
    "Process Monitoring",
    "File Monitoring",
    "Process Monitoring",
    "File Monitoring",
    "Process Monitoring",
    "File Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"SuspiciousBinaryWrittenByPowershell - T1105 Ingress Tool Transfer\" (Low) was generated when powershell.exe created dll329.dll.",
    "A Technique detection named \"SMBSuspiciousAccess - T1105 Ingress Tool Transfer\" (Low) was generated when powershell.exe downloaded dll329.dll from 192.168.0.4 over RDP mounted network drive."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "19. Setup Shim Persistence",
  "Substep": "19.B.3",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "powershell.exe downloads sdbE376.tmp from 192.168.0.4",
  "Datasources": [
    "Process Monitoring",
    "File Monitoring",
    "Process Monitoring",
    "File Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "General"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A General detection named \"Suspicious File Write\" (1) was generated when powershell.exe created sdbE376.tmp."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "19. Setup Shim Persistence",
  "Substep": "19.B.4",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "sdbinst.exe installs sdbE376.tmp shim",
  "Datasources": [
    "Process Monitoring",
    "Process Monitoring",
    "Windows Registry",
    "Process Monitoring",
    "File Monitoring",
    "Process Monitoring",
    "File Monitoring",
    "Process Monitoring",
    "Windows Registry"
  ],
  "Detection": [
    "Telemetry",
    "General",
    "General",
    "Technique",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A General detection named \"ShimRegistryModified\" was generated when sdbinst.exe installed sdbE376.tmp shim database.",
    "A General detection named \"ShimDatabaseWrite\" was generated when sdbinst.exe installed sdbE376.tmp shim database.",
    "A Technique detection named \"ShimDatabaseWrite - T1546.011 Application Shimming\" (Low) was generated when sdbinst.exe installed sdbE376.tmp shim database.",
    "A Technique detection named \"ShimRegistryModified - T1546.011 Application Shimming\" (Low) was generated when sdbinst.exe installed sdbE376.tmp shim database."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "19. Setup Shim Persistence",
  "Substep": "19.B.5",
  "Subtechnique": "T1546.011",
  "Subtechnique_Name": "Event Triggered Execution: Application Shimming",
  "TacticGroup": "Persistence",
  "Technique": "T1546",
  "Technique_Name": "Event Triggered Execution"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "AccountingIQ.exe queries HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\InstalledSDB\\ and loads dll329.dll",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "20. Steal Payment Data",
  "Substep": "20.A.1",
  "Subtechnique": "T1546.011",
  "Subtechnique_Name": "Event Triggered Execution: Application Shimming",
  "TacticGroup": "Persistence",
  "Technique": "T1546",
  "Technique_Name": "Event Triggered Execution"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "AccountingIQ.exe injects into SyncHost.exe with CreateRemoteThread",
  "Datasources": [
    "Process Monitoring",
    "System Calls/API Monitoring",
    "Process Monitoring",
    "System Calls/API Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"InjectionRemoteThread - T1055 Process Injection\" (Low) was generated when AccountingIQ.exe injected into SyncHost.exe with CreateRemoteThread."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "20. Steal Payment Data",
  "Substep": "20.A.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Defense Evasion",
  "Technique": "T1055",
  "Technique_Name": "Process Injection"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol",
  "Datasources": [
    "Process Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "Network Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"StandardCryptographicProtocol - T1071 Application Layer Protocol\" was generated when rundll32.exe exchanged data with 192.168.0.4 over SSL port 53."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "20. Steal Payment Data",
  "Substep": "20.A.3",
  "Subtechnique": "T1071.001",
  "Subtechnique_Name": "Application Layer Protocol: Web Protocols",
  "TacticGroup": "Command and Control",
  "Technique": "T1071",
  "Technique_Name": "Application Layer Protocol"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [
    "Protection Capability"
  ],
  "Criteria": "rundll32.exe transmits data to 192.168.0.4 over HTTPS protocol",
  "Datasources": [
    "Process Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "Network Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "Technique"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Technique detection named \"StandardCryptographicProtocol - T1573 Encrypted Channel\" was generated when rundll32.exe exchanged TLS/SSL encrypted data with 192.168.0.4."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "20. Steal Payment Data",
  "Substep": "20.A.4",
  "Subtechnique": "T1573.002",
  "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography",
  "TacticGroup": "Command and Control",
  "Technique": "T1573",
  "Technique_Name": "Encrypted Channel"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "rundll32.exe downloads debug.exe from 192.168.0.4",
  "Datasources": [
    "Process Monitoring",
    "File Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "File Monitoring",
    "Process Monitoring",
    "File Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "General",
    "Technique"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detection Logic)"
  ],
  "DetectionText": [
    "A General detection named \"Executable Written in User Directory\" (Low) was generated when rundll32.exe created debug.exe.",
    "A Technique detection named \"T1055 Ingress Tool Transfer\" (1) was generated when rundll32.exe downloads debug.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "20. Steal Payment Data",
  "Substep": "20.B.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "debug.exe calls the CreateToolhelp32Snapshot API",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "20. Steal Payment Data",
  "Substep": "20.B.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "Technique_Name": "Process Discovery"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "rundll32.exe downloads 7za.exe from 192.168.0.4",
  "Datasources": [
    "Process Monitoring",
    "File Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "File Monitoring",
    "Network Monitoring",
    "Process Monitoring",
    "File Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "General",
    "Technique"
  ],
  "DetectionModifiers": [
    "Configuration Change (Detection Logic)"
  ],
  "DetectionText": [
    "A General detection named \"File detected as suspicious by analysis\" was generated when rundll32.exe downloaded 7za.exe from 192.168.0.4.",
    "A Technique detection named \"T1055 Ingress Tool Transfer\" (1) was generated when rundll32.exe downloads 7za.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "20. Steal Payment Data",
  "Substep": "20.B.3",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "7za.exe creates C:\\Users\\Public\\log.7z",
  "Datasources": [
    "Process Monitoring",
    "File Monitoring",
    "Process Monitoring",
    "File Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "General"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A General detection named \"File Written in User Directory\" (Low) was generated when 7za.exe created C:\\Users\\Public\\log.7z."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "20. Steal Payment Data",
  "Substep": "20.B.4",
  "Subtechnique": "T1560.001",
  "Subtechnique_Name": "Archive Collected Data: Archive via Utility",
  "TacticGroup": "Exfiltration",
  "Technique": "T1560",
  "Technique_Name": "Archive Collected Data"
}
{
  "Adversary": "carbanak-fin7",
  "Capability_Requirements": [],
  "Criteria": "rundll32.exe reads and uploads log.7z to 192.168.0.4",
  "Datasources": [
    "Process Monitoring",
    "File Monitoring",
    "Process Monitoring",
    "File Monitoring"
  ],
  "Detection": [
    "Telemetry",
    "General"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A General detection named \"PersonalDocumentsRead\" (Low) was generated when rundll32.exe read log.7z."
  ],
  "Footnotes": [],
  "Participant_Name": "bitdefender",
  "Procedure": null,
  "ScreenshotDatasources": [],
  "Step": "20. Steal Payment Data",
  "Substep": "20.B.5",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Exfiltration",
  "Technique": "T1041",
  "Technique_Name": "Exfiltration Over Command and Control Channel"
}
