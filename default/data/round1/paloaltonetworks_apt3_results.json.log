{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed that Resume Viewer.exe was executed and running as a process owned by user Debbie."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Legitimate user Debbie clicked and executed malicious self-extracting archive (Resume Viewer.exe) on 10.0.1.6 (Nimda)",
  "ScreenshotDatasources": [],
  "Step": "1. Initial Compromise",
  "Substep": "1.A.1.1",
  "Subtechnique": "T1204.002",
  "Subtechnique_Name": "User Execution: Malicious File",
  "TacticGroup": "Execution",
  "Technique": "T1204",
  "Technique_Name": "User Execution"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "General Behavior",
    "Specific Behavior"
  ],
  "DetectionModifiers": [
    "Tainted",
    "Tainted",
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed rundll32.exe executing update.dat with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.",
    "A General Behavior alert was generated based on rundll32.exe executing update.dat, identified as a suspicious DLL and malware. The alert was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.",
    "Specific Behavior alerts were generated for rundll32. The alerts were tagged with the correct ATT&CK Technique (Rundll32) and were tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine."
  ],
  "Footnotes": [
    "Vendor stated the capability would have prevented execution of update.dat."
  ],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Previously executed batch file (pdfhelper.cmd) launched a DLL payload (update.dat) using Rundll32",
  "ScreenshotDatasources": [],
  "Step": "1. Initial Compromise",
  "Substep": "1.A.1.2",
  "Subtechnique": "T1218.011",
  "Subtechnique_Name": "Signed Binary Proxy Execution: Rundll32",
  "TacticGroup": "Execution",
  "Technique": "T1218",
  "Technique_Name": "Signed Binary Proxy Execution"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Specific Behavior"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed cmd.exe launching pdfhelper.cmd.",
    "A Specific Behavior alert was generated for execution of the Windows script engine. The alert was tagged with the correct ATT&CK Technique (Scripting)."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Previously executed self-extracting archive (Resume Viewer.exe) launched an embedded batch file (pdfhelper.cmd)",
  "ScreenshotDatasources": [],
  "Step": "1. Initial Compromise",
  "Substep": "1.A.1.3",
  "Subtechnique": "T1059.003",
  "Subtechnique_Name": "Command and Scripting Interpreter: Windows Command Shell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment"
  ],
  "DetectionModifiers": [
    "Tainted",
    "Configuration Change",
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed autoupdate.bat being moved to the user Debbie's Startup folder. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.",
    "The capability enriched a file being created in the Startup folder with the correct ATT&CK Technique (Registry Run Keys / Start Folder). The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine."
  ],
  "Footnotes": [
    "The logic to produce the enrichment was configured after the start of the evaluation so it is identified as a config change."
  ],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Previously executed batch file (pdfhelper.cmd) moved a separate batch file (autoupdate.bat) to the Startup folder",
  "ScreenshotDatasources": [],
  "Step": "1. Initial Compromise",
  "Substep": "1.B.1",
  "Subtechnique": "T1547.001",
  "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder",
  "TacticGroup": "Persistence",
  "Technique": "T1547",
  "Technique_Name": "Boot or Logon Autostart Execution"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Specific Behavior"
  ],
  "DetectionModifiers": [
    "Tainted",
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed port 53 command and control traffic. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.",
    "A Specific Behavior alert was generated for a scripting engine (rundll32.exe) making a network connection over DNS ports. The alert was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine."
  ],
  "Footnotes": [
    "Vendor stated that more information would be available if their firewall appliance was installed and activated."
  ],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: C2 channel established using port 53",
  "ScreenshotDatasources": [],
  "Step": "1. Initial Compromise",
  "Substep": "1.C.1.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1043",
  "Technique_Name": "Commonly Used Port"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [
    "Vendor stated that more information would be available if their firewall appliance was installed and activated."
  ],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: C2 channel established using DNS traffic to freegoogleadsenseinfo.com",
  "ScreenshotDatasources": [],
  "Step": "1. Initial Compromise",
  "Substep": "1.C.1.2",
  "Subtechnique": "T1071.004",
  "Subtechnique_Name": "Application Layer Protocol: DNS",
  "TacticGroup": "Command and Control",
  "Technique": "T1071",
  "Technique_Name": "Application Layer Protocol"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [
    "Vendor stated that more information would be available if their firewall appliance was installed and activated."
  ],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: C2 channel established using both NetBIOS and base64 encoding",
  "ScreenshotDatasources": [],
  "Step": "1. Initial Compromise",
  "Substep": "1.C.1.3",
  "Subtechnique": "T1132.001",
  "Subtechnique_Name": "Data Encoding: Standard Encoding",
  "TacticGroup": "Command and Control",
  "Technique": "T1132",
  "Technique_Name": "Data Encoding"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment",
    "Enrichment",
    "General Behavior"
  ],
  "DetectionModifiers": [
    "Tainted",
    "Tainted",
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed cmd.exe executing ipconfig with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.",
    "The capability enriched ipconfig.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery).",
    "The capability enriched the execution of ipconfig.exe as the execution of an enumeration command. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.",
    "A General Behavior alert was generated for a commonly abused process (cmd.exe) spawning out of rundll32.exe. The alert was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: 'ipconfig -all' via cmd",
  "ScreenshotDatasources": [],
  "Step": "2. Initial Discovery",
  "Substep": "2.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1016",
  "Technique_Name": "System Network Configuration Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment",
    "Enrichment"
  ],
  "DetectionModifiers": [
    "Tainted",
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed cmd.exe executing arp with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.",
    "The capability enriched arp.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery).",
    "The capability enriched the execution of arp.exe as possible reconnaissance as well as the execution of an enumeration command. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: 'arp -a' via cmd",
  "ScreenshotDatasources": [],
  "Step": "2. Initial Discovery",
  "Substep": "2.A.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1016",
  "Technique_Name": "System Network Configuration Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed cmd.exe executing echo with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.",
    "The capability enriched cmd.exe executing echo with the correct ATT&CK Technique (System Owner / User Discovery)."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: 'echo' via cmd to enumerate specific environment variables",
  "ScreenshotDatasources": [],
  "Step": "2. Initial Discovery",
  "Substep": "2.B.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1033",
  "Technique_Name": "System Owner/User Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Enrichment"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "The capability enriched the execution of a specific API call as process enumeration and suspicious activity. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine."
  ],
  "Footnotes": [
    "The process tree showing taintedness is visible within the same UI but did not fit within the current frame."
  ],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs",
  "ScreenshotDatasources": [],
  "Step": "2. Initial Discovery",
  "Substep": "2.C.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "Technique_Name": "Process Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment",
    "Enrichment"
  ],
  "DetectionModifiers": [
    "Tainted",
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed cmd.exe executing tasklist with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.",
    "The capability enriched tasklist.exe executing with a related ATT&CK Technique (System Information Discovery).",
    "The capability enriched the execution of tasklist.exe as the enumeration of running processes via the command line. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: 'tasklist -v' via cmd",
  "ScreenshotDatasources": [],
  "Step": "2. Initial Discovery",
  "Substep": "2.C.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "Technique_Name": "Process Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed cmd.exe executing sc with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: 'sc query' via cmd",
  "ScreenshotDatasources": [],
  "Step": "2. Initial Discovery",
  "Substep": "2.D.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1007",
  "Technique_Name": "System Service Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment"
  ],
  "DetectionModifiers": [
    "Tainted",
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed cmd.exe executing net with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.",
    "The capability enriched the execution of net.exe as the execution of an enumeration command. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: 'net start' via cmd",
  "ScreenshotDatasources": [],
  "Step": "2. Initial Discovery",
  "Substep": "2.D.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1007",
  "Technique_Name": "System Service Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment",
    "Enrichment"
  ],
  "DetectionModifiers": [
    "Tainted",
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed cmd.exe executing systeminfo with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.",
    "The capability enriched cmd.exe executing systeminfo with the correct ATT&CK Technique (System Information Discovery).",
    "The capability enriched the execution of systeminfo.exe as the execution of an enumeration command. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: 'systeminfo' via cmd",
  "ScreenshotDatasources": [],
  "Step": "2. Initial Discovery",
  "Substep": "2.E.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1082",
  "Technique_Name": "System Information Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment",
    "Enrichment"
  ],
  "DetectionModifiers": [
    "Tainted",
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed cmd.exe executing net with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.",
    "The capability enriched cmd.exe executing net with the correct ATT&CK Technique (System Information Discovery).",
    "The capability enriched the execution of net.exe as the execution of an enumeration command. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: 'net config workstation' via cmd",
  "ScreenshotDatasources": [],
  "Step": "2. Initial Discovery",
  "Substep": "2.E.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1082",
  "Technique_Name": "System Information Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Enrichment"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "The capability enriched net.exe executing with the correct ATT&CK Technique (Permission Groups Discovery)."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: 'net localgroup administrators' via cmd",
  "ScreenshotDatasources": [],
  "Step": "2. Initial Discovery",
  "Substep": "2.F.1",
  "Subtechnique": "T1069.001",
  "Subtechnique_Name": "Permission Groups Discovery: Local Groups",
  "TacticGroup": "Discovery",
  "Technique": "T1069",
  "Technique_Name": "Permission Groups Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Enrichment"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "The capability enriched net.exe executing with the correct ATT&CK Technique (Permission Groups Discovery)."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: 'net localgroup administrators -domain' via cmd",
  "ScreenshotDatasources": [],
  "Step": "2. Initial Discovery",
  "Substep": "2.F.2",
  "Subtechnique": "T1069.002",
  "Subtechnique_Name": "Permission Groups Discovery: Domain Groups",
  "TacticGroup": "Discovery",
  "Technique": "T1069",
  "Technique_Name": "Permission Groups Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment",
    "Enrichment"
  ],
  "DetectionModifiers": [
    "Tainted",
    "Tainted",
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed cmd.exe executing net with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.",
    "The capability enriched the execution of net.exe and net1.exe as the possible enumeration of administrator groups. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.",
    "The capability enriched the execution of net.exe as the execution of an enumeration command as well as the execution of net1.exe as the execution of an enumeration command using net or net1. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: 'net group \\\"Domain Admins\\\" -domain' via cmd",
  "ScreenshotDatasources": [],
  "Step": "2. Initial Discovery",
  "Substep": "2.F.3",
  "Subtechnique": "T1069.002",
  "Subtechnique_Name": "Permission Groups Discovery: Domain Groups",
  "TacticGroup": "Discovery",
  "Technique": "T1069",
  "Technique_Name": "Permission Groups Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment"
  ],
  "DetectionModifiers": [
    "Tainted",
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed cmd.exe executing net with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.",
    "The capability enriched the execution of net.exe as the execution of an enumeration command. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: 'net user -domain' via cmd",
  "ScreenshotDatasources": [],
  "Step": "2. Initial Discovery",
  "Substep": "2.G.1",
  "Subtechnique": "T1087.002",
  "Subtechnique_Name": "Account Discovery: Domain Account",
  "TacticGroup": "Discovery",
  "Technique": "T1087",
  "Technique_Name": "Account Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment",
    "Enrichment"
  ],
  "DetectionModifiers": [
    "Tainted",
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed cmd.exe executing net with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.",
    "The capability enriched net1.exe executing with the correct ATT&CK Technique (Account Discovery).",
    "The capability enriched the execution of net.exe as the execution of an enumeration command. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: 'net user george -domain' via cmd",
  "ScreenshotDatasources": [],
  "Step": "2. Initial Discovery",
  "Substep": "2.G.2",
  "Subtechnique": "T1087.002",
  "Subtechnique_Name": "Account Discovery: Domain Account",
  "TacticGroup": "Discovery",
  "Technique": "T1087",
  "Technique_Name": "Account Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed cmd.exe executing reg with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.",
    "The capability enriched reg.exe executing with the correct ATT&CK Technique (Query Registry)."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: 'reg query' via cmd to enumerate a specific Registry key",
  "ScreenshotDatasources": [],
  "Step": "2. Initial Discovery",
  "Substep": "2.H.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1012",
  "Technique_Name": "Query Registry"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed a process integrity level change from parent rundll32.exe (medium / 8192) to child powershell.exe (high / 12288), both running as user Debbie."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: Built-in UAC bypass token duplication capability executed to elevate process integrity level",
  "ScreenshotDatasources": [],
  "Step": "3. Privilege Escalation",
  "Substep": "3.A.1.1",
  "Subtechnique": "T1548.002",
  "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control",
  "TacticGroup": "Privilege Escalation",
  "Technique": "T1548",
  "Technique_Name": "Abuse Elevation Control Mechanism"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed svchost.exe executed with the seclogon command-line argument and a subsequent logon event with an elevated token and new logon ID, indicating token manipulation."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: Built-in UAC bypass token duplication capability executed to modify current process token",
  "ScreenshotDatasources": [],
  "Step": "3. Privilege Escalation",
  "Substep": "3.A.1.2",
  "Subtechnique": "T1134.001",
  "Subtechnique_Name": "Access Token Manipulation: Token Impersonation/Theft",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1134",
  "Technique_Name": "Access Token Manipulation"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Enrichment"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "The capability enriched the execution of a specific API call as process enumeration and suspicious activity. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine."
  ],
  "Footnotes": [
    "The process tree showing taintedness is visible within the same UI but did not fit within the current frame."
  ],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs",
  "ScreenshotDatasources": [],
  "Step": "3. Privilege Escalation",
  "Substep": "3.B.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "Technique_Name": "Process Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Specific Behavior"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "A Specific Behavior alert was generated for PowerShell injecting shellcode. The alert was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine."
  ],
  "Footnotes": [
    "The process tree showing taintedness is visible within the same UI but did not fit within the current frame."
  ],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: Built-in process injection capability executed to inject callback into cmd.exe",
  "ScreenshotDatasources": [],
  "Step": "3. Privilege Escalation",
  "Substep": "3.C.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Execution",
  "Technique": "T1055",
  "Technique_Name": "Process Injection"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment",
    "Enrichment",
    "Enrichment"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed cmd.exe executing net with command-line arguments.",
    "The capability enriched the execution of net.exe as the execution of an enumeration command.",
    "The capability enriched the execution of net.exe as the execution of an enumeration command using net or net1.",
    "The capability enriched cmd.exe executing net with a related ATT&CK Technique (System Network Connections Discovery)."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: 'net group \\\"Domain Controllers\\\" -domain' via cmd",
  "ScreenshotDatasources": [],
  "Step": "4. Discovery for Lateral Movement",
  "Substep": "4.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1018",
  "Technique_Name": "Remote System Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed cmd.exe executing net with command-line arguments.",
    "The capability enriched the execution of net.exe as the execution of an enumeration command using net or net1."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: 'net group \\\"Domain Computers\\\" -domain' via cmd",
  "ScreenshotDatasources": [],
  "Step": "4. Discovery for Lateral Movement",
  "Substep": "4.A.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1018",
  "Technique_Name": "Remote System Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed cmd.exe executing netsh with command-line arguments.",
    "The capability enriched netsh.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery)."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: 'netsh advfirewall show allprofiles' via cmd",
  "ScreenshotDatasources": [],
  "Step": "4. Discovery for Lateral Movement",
  "Substep": "4.B.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1016",
  "Technique_Name": "System Network Configuration Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed cmd.exe executing netsh with command-line arguments.",
    "The capability enriched netstat.exe executing with the correct ATT&CK Technique (System Network Connections Discovery)."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: 'netstat -ano' via cmd",
  "ScreenshotDatasources": [],
  "Step": "4. Discovery for Lateral Movement",
  "Substep": "4.C.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1049",
  "Technique_Name": "System Network Connections Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Specific Behavior"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Specific Behavior alert was generated for a suspicious handle being opened to lsass.exe to dump passwords. The alert was tagged with the correct ATT&CK Technique (Credential Dumping)."
  ],
  "Footnotes": [
    "Vendor stated the capability would have prevented this behavior."
  ],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: Built-in Mimikatz credential dump capability executed",
  "ScreenshotDatasources": [],
  "Step": "5. Credential Access",
  "Substep": "5.A.1.1",
  "Subtechnique": "T1003.001",
  "Subtechnique_Name": "OS Credential Dumping: LSASS Memory",
  "TacticGroup": "Credential Access",
  "Technique": "T1003",
  "Technique_Name": "OS Credential Dumping"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Specific Behavior"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "A Specific Behavior alert was generated for a suspicious handle being opened to lsass.exe. The alert was tagged with a related ATT&CK Technique (Credential Dumping)."
  ],
  "Footnotes": [
    "Vendor stated the capability would have prevented this behavior."
  ],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: Credential dump capability involved process injection into lsass",
  "ScreenshotDatasources": [],
  "Step": "5. Credential Access",
  "Substep": "5.A.1.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Execution",
  "Technique": "T1055",
  "Technique_Name": "Process Injection"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Specific Behavior"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed a code injection into lsass.exe. The telemetry was tainted by a parent process injection alert on cmd.exe.",
    "A Specific Behavior alert was generated for svchost dumping credentials via the Registry. The alert was tagged with the correct ATT&CK Technique (Credential Dumping)."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: Built-in hash dump capability executed",
  "ScreenshotDatasources": [],
  "Step": "5. Credential Access",
  "Substep": "5.A.2.1",
  "Subtechnique": "T1003.002",
  "Subtechnique_Name": "OS Credential Dumping: Security Account Manager",
  "TacticGroup": "Credential Access",
  "Technique": "T1003",
  "Technique_Name": "OS Credential Dumping"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed a code injection into lsass.exe. The telemetry was tainted by a parent process injection alert on cmd.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: Hash dump capability involved process injection into lsass.exe",
  "ScreenshotDatasources": [],
  "Step": "5. Credential Access",
  "Substep": "5.A.2.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Execution",
  "Technique": "T1055",
  "Technique_Name": "Process Injection"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed a cmd.exe associated with user Debbie spawn a cmd.exe associated with user George, indicating user context change via token manipulation. The telemetry was tainted by a parent process injection alert on cmd.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: Built-in token theft capability executed to change user context to George",
  "ScreenshotDatasources": [],
  "Step": "5. Credential Access",
  "Substep": "5.B.1",
  "Subtechnique": "T1134.001",
  "Subtechnique_Name": "Access Token Manipulation: Token Impersonation/Theft",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1134",
  "Technique_Name": "Access Token Manipulation"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment",
    "Enrichment"
  ],
  "DetectionModifiers": [
    "Tainted",
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed cmd.exe executing reg with command-line arguments. The telemetry was tainted by a parent process injection alert on cmd.exe.",
    "The capability enriched the execution of reg.exe as querying a remote key. The data was tainted by a parent process injection alert on cmd.exe.",
    "The capability enriched reg.exe executing with the correct ATT&CK Technique (Query Registry)."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: 'reg query' via cmd to remotely enumerate a specific Registry key on Conficker (10.0.0.5)",
  "ScreenshotDatasources": [],
  "Step": "6. Lateral Movement",
  "Substep": "6.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1012",
  "Technique_Name": "Query Registry"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed port 80 command and control traffic."
  ],
  "Footnotes": [
    "Vendor stated that more information would be available if their firewall appliance was installed and activated."
  ],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: C2 channel modified to use port 80",
  "ScreenshotDatasources": [],
  "Step": "6. Lateral Movement",
  "Substep": "6.B.1.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1043",
  "Technique_Name": "Commonly Used Port"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed port 80 command and control traffic as well as the loading of winhttp.dll, which an analyst could use to determine HTTP was used."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: C2 channel modified to use HTTP traffic to freegoogleadsenseinfo.com",
  "ScreenshotDatasources": [],
  "Step": "6. Lateral Movement",
  "Substep": "6.B.1.2",
  "Subtechnique": "T1071.001",
  "Subtechnique_Name": "Application Layer Protocol: Web Protocols",
  "TacticGroup": "Command and Control",
  "Technique": "T1071",
  "Technique_Name": "Application Layer Protocol"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed command and control traffic for both ports 80 and 53 ."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: C2 channel modified to split communications between both HTTP and DNS",
  "ScreenshotDatasources": [],
  "Step": "6. Lateral Movement",
  "Substep": "6.B.1.3",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1026",
  "Technique_Name": "Multiband Communication"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "General Behavior"
  ],
  "DetectionModifiers": [
    "Tainted",
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed cmd.exe establishing an outbound RDP connection over port 3389 to 10.0.0.5 (Conficker). The telemetry was tainted by a parent process injection alert on cmd.exe.",
    "A General Behavior alert was generated for an unexpected process using the RDP port. The data was tainted by a parent process injection alert on cmd.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: C2 channel modified to proxy RDP connection to Conficker (10.0.0.5)",
  "ScreenshotDatasources": [],
  "Step": "6. Lateral Movement",
  "Substep": "6.C.1",
  "Subtechnique": "T1021.001",
  "Subtechnique_Name": "Remote Services: Remote Desktop Protocol",
  "TacticGroup": "Lateral Movement",
  "Technique": "T1021",
  "Technique_Name": "Remote Services"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed mmc.exe creating a Registry key for user Jesse, indicating that the user is new.",
    "The capability enriched the Local Users and Groups snap-in (lusrmgr.msc) executing with the correct ATT&CK Technique (Create Account)."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Added user Jesse to Conficker (10.0.0.5) through RDP connection",
  "ScreenshotDatasources": [],
  "Step": "7. Persistence",
  "Substep": "7.A.1.1",
  "Subtechnique": "T1136.001",
  "Subtechnique_Name": "Create Account: Local Account",
  "TacticGroup": "Persistence",
  "Technique": "T1136",
  "Technique_Name": "Create Account"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed mmc.exe, the Microsoft Management Console, executing the lusrmgr.msc (Local Users and Groups snap-in) which displays local account information.",
    "The capability enriched the Local Users and Groups snap-in (lusrmgr.msc) executing with the correct ATT&CK Technique (Graphical User Interface)."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Microsoft Management Console (Local Users and Groups snap-in) GUI utility used to add new user through RDP connection",
  "ScreenshotDatasources": [],
  "Step": "7. Persistence",
  "Substep": "7.A.1.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Execution",
  "Technique": "T1061",
  "Technique_Name": "Graphical User Interface"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed mmc.exe, the Microsoft Management Console, executing the GUI-based lusrmgr.msc (Local Users and Groups snap-in).",
    "The capability enriched mmc.exe, the Microsoft Management Console, executing the GUI-based lusrmgr.msc (Local Users and Groups snap-in) as reconnaissance via the MMC utility with local users and groups view."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Microsoft Management Console (Local Users and Groups snap-in) GUI utility displayed user account information",
  "ScreenshotDatasources": [],
  "Step": "7. Persistence",
  "Substep": "7.A.1.3",
  "Subtechnique": "T1087.001",
  "Subtechnique_Name": "Account Discovery: Local Account",
  "TacticGroup": "Discovery",
  "Technique": "T1087",
  "Technique_Name": "Account Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Specific Behavior",
    "Specific Behavior"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed the file create event for updater.dll.",
    "A Specific Behavior alert was generated for a Windows scripting engine creating an executable on disk.",
    "A Specific Behavior alert was generated for a script engine creating/writing a DLL in the system32 folder. The alert was tainted by a parent process injection alert on cmd.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: Built-in upload capability executed to write a DLL payload (updater.dll) to disk on Nimda (10.0.1.6)",
  "ScreenshotDatasources": [],
  "Step": "7. Persistence",
  "Substep": "7.B.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment",
    "Specific Behavior",
    "Specific Behavior"
  ],
  "DetectionModifiers": [
    "Tainted",
    "Tainted",
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed schtasks.exe creating the Resume Viewer Update Checker scheduled task as reboot persistence and as SYSTEM. The telemetry was tainted by a parent process injection alert on cmd.exe.",
    "The capability enriched schtasks.exe creating the Resume Viewer Update Checker scheduled task with the correct ATT&CK Technique (Scheduled Task).",
    "A Specific Behavior alert was generated for a commonly abused host process scheduling a task. The alert was tainted by a parent process injection alert on cmd.exe.",
    "A Specific Behavior alert was generated for the creation of a new scheduled task. The alert was tainted by a parent process injection alert on cmd.exe."
  ],
  "Footnotes": [
    "Vendor stated the capability would have prevented the creation of the scheduled task.",
    "Vendor stated the capability would have prevented the creation of the scheduled task."
  ],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: 'schtasks' via cmd to create scheduled task that executes a DLL payload (updater.dll)",
  "ScreenshotDatasources": [],
  "Step": "7. Persistence",
  "Substep": "7.C.1",
  "Subtechnique": "T1053.005",
  "Subtechnique_Name": "Scheduled Task/Job: Scheduled Task",
  "TacticGroup": "Execution",
  "Technique": "T1053",
  "Technique_Name": "Scheduled Task/Job"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment",
    "Enrichment"
  ],
  "DetectionModifiers": [
    "Tainted",
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed cmd.exe executing dir with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.",
    "A General Behavior alert was generated for a commonly abused process (cmd.exe) spawning out of rundll32.exe. The alert was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.",
    "The capability enriched cmd.exe executing dir with command-line arguments as the execution of the dir command on a network location. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: 'dir -s -b \\\"\\\\conficker\\wormshare\\\"' via cmd",
  "ScreenshotDatasources": [],
  "Step": "8. Collection",
  "Substep": "8.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "Technique_Name": "File and Directory Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed cmd.exe executing tree with command-line arguments. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.",
    "The capability enriched cmd.exe executing tree with command-line arguments with the correct ATT&CK Technique (File and Directory Discovery)."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: 'tree \\\"C:\\Users\\debbie\\\"' via cmd",
  "ScreenshotDatasources": [],
  "Step": "8. Collection",
  "Substep": "8.A.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "Technique_Name": "File and Directory Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Enrichment"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "The capability enriched the execution of a specific API call as process enumeration and suspicious activity. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine."
  ],
  "Footnotes": [
    "The process tree showing taintedness is visible within the same UI but did not fit within the current frame."
  ],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs",
  "ScreenshotDatasources": [],
  "Step": "8. Collection",
  "Substep": "8.B.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "Technique_Name": "Process Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Enrichment"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "The capability enriched the execution of a specific API call as keylogging and suspicious activity. Though it does not count as a detection, the capability also showed code and hook injections into explorer.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: Built-in keylogging capability executed to capture keystrokes of user Debbie",
  "ScreenshotDatasources": [],
  "Step": "8. Collection",
  "Substep": "8.C.1.1",
  "Subtechnique": "T1056.001",
  "Subtechnique_Name": "Input Capture: Keylogging",
  "TacticGroup": "Collection",
  "Technique": "T1056",
  "Technique_Name": "Input Capture"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: Keylogging capability included residual enumeration of application windows",
  "ScreenshotDatasources": [],
  "Step": "8. Collection",
  "Substep": "8.C.1.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1010",
  "Technique_Name": "Application Window Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Enrichment"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "The capability enriched the execution of a specific API call as information gathering using screen capture and suspicious activity."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: Built-in screen capture capability executed to capture screenshot of current window of user Debbie",
  "ScreenshotDatasources": [],
  "Step": "8. Collection",
  "Substep": "8.D.1.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1113",
  "Technique_Name": "Screen Capture"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Enrichment"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "The capability enriched cmd.exe injecting into explorer.exe as code injection via CreateThread."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: Screen capture capability involved process injection into explorer.exe",
  "ScreenshotDatasources": [],
  "Step": "8. Collection",
  "Substep": "8.D.1.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Execution",
  "Technique": "T1055",
  "Technique_Name": "Process Injection"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [
    "Vendor stated that more information would be available if their firewall appliance was installed and activated."
  ],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: 'ls' (List) via Win32 APIs to enumerate a network shared drive (Wormshare) on Conficker (10.0.0.5)",
  "ScreenshotDatasources": [],
  "Step": "9. Exfiltration",
  "Substep": "9.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "Technique_Name": "File and Directory Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed a file read event for the .vsdx file from the network shared drive."
  ],
  "Footnotes": [
    "Vendor stated that more information would be available if their firewall appliance was installed and activated."
  ],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: Built-in download capability executed to a collect file (Shockwave_rackb_diagram.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5)",
  "ScreenshotDatasources": [],
  "Step": "9. Exfiltration",
  "Substep": "9.B.1.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Collection",
  "Technique": "T1039",
  "Technique_Name": "Data from Network Shared Drive"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [
    "Vendor stated that more information would be available if their firewall appliance was installed and activated."
  ],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Cobalt Strike: Download capability exfiltrated data through existing C2 channel",
  "ScreenshotDatasources": [],
  "Step": "9. Exfiltration",
  "Substep": "9.B.1.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Exfiltration",
  "Technique": "T1041",
  "Technique_Name": "Exfiltration Over Command and Control Channel"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed cmd.exe executing autoupdate.bat from the Startup folder."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Batch file (autoupdate.bat) previously written to Startup folder executed when user Debbie logs on to Nimda (10.0.1.6), launching a DLL payload (update.dat) using Rundll32",
  "ScreenshotDatasources": [],
  "Step": "10. Execution of Persistence",
  "Substep": "10.A.1",
  "Subtechnique": "T1547.001",
  "Subtechnique_Name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder",
  "TacticGroup": "Persistence",
  "Technique": "T1547",
  "Technique_Name": "Boot or Logon Autostart Execution"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed the execution sequence for rundll32.exe executing updater.dll with a parent of svchost.exe running with command-line arguments \\\"-k netsvcs -p -s Schedule\\\"."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Scheduled task executed when user Debbie logs on to Nimda (10.0.1.6), launching a DLL payload (updater.dll) using Rundll32",
  "ScreenshotDatasources": [],
  "Step": "10. Execution of Persistence",
  "Substep": "10.A.2",
  "Subtechnique": "T1053.005",
  "Subtechnique_Name": "Scheduled Task/Job: Scheduled Task",
  "TacticGroup": "Execution",
  "Technique": "T1053",
  "Technique_Name": "Scheduled Task/Job"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed userinit.exe as well as explorer.exe spawn as the user Jesse."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "RDP connection to Conficker (10.0.0.5) authenticated using previously added user Jesse",
  "ScreenshotDatasources": [],
  "Step": "10. Execution of Persistence",
  "Substep": "10.B.1.1",
  "Subtechnique": "T1078.003",
  "Subtechnique_Name": "Valid Accounts: Local Accounts",
  "TacticGroup": "Persistence",
  "Technique": "T1078",
  "Technique_Name": "Valid Accounts"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed a successful incoming connection to Conficker (10.0.0.5) over port 3389.",
    "The capability enriched the network connection over port 3389 with the correct ATT&CK Technique (Remote Desktop Protocol)."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "RDP connection made to Conficker (10.0.0.5) as part of execution of persistence mechanism",
  "ScreenshotDatasources": [],
  "Step": "10. Execution of Persistence",
  "Substep": "10.B.1.2",
  "Subtechnique": "T1021.001",
  "Subtechnique_Name": "Remote Services: Remote Desktop Protocol",
  "TacticGroup": "Lateral Movement",
  "Technique": "T1021",
  "Technique_Name": "Remote Services"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Indicator of Compromise",
    "Indicator of Compromise",
    "Specific Behavior",
    "Specific Behavior",
    "Specific Behavior",
    "Specific Behavior"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed wscript.exe executing autoupdate.vbs as well as the resulting powershell.exe execution. The telemetry was tainted by a parent alert on wscript.exe.",
    "Indicator of Compromise alerts were generated for suspicious PowerShell strings.",
    "An Indicator of Compromise alert was generated identifying PowerShell Empire.",
    "A Specific Behavior alert was generated for the execution of the windows script engine The alert was tagged with the correct ATT&CK Technique (Scripting).",
    "A Specific Behavior alert was generated for suspicious PowerShell activity",
    "A Specific Behavior alert was generated for PowerShell execution. The alert was tagged with a related Technique (PowerShell)",
    "A Specific Behavior alert was generated for PowerShell execution with base64 encoded commands."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Legitimate user Bob clicked and executed malicious VBScript (autoupdate.vbs) on 10.0.1.5 (CodeRed)",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.A.1",
  "Subtechnique": "T1059.005",
  "Subtechnique_Name": "Command and Scripting Interpreter: Visual Basic",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment",
    "General Behavior"
  ],
  "DetectionModifiers": [
    "Tainted",
    "Tainted",
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed port 443 network connections to www.freegoogleadsenseinfo.com (C2 domain). The telemetry was tainted by a parent alert on wscript.exe.",
    "The capability enriched the port 443 network connection with the correct ATT&CK Technique (Commonly Used Port). The data was tainted by a parent alert on wscript.exe.",
    "General Behavior alerts were generated for PowerShell making network connections to the internet as well as Wscript connecting to an external network. The alerts were tainted by a parent alert on wscript.exe."
  ],
  "Footnotes": [
    "Vendor stated that more information would be available if their firewall appliance was installed and activated.",
    "Vendor stated that more information would be available if their firewall appliance was installed and activated.",
    "Vendor stated that more information would be available if their firewall appliance was installed and activated."
  ],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: C2 channel established using port 443",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.B.1.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1043",
  "Technique_Name": "Commonly Used Port"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [
    "Vendor stated that more information would be available if their firewall appliance was installed and activated."
  ],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: C2 channel established using HTTPS traffic to freegoogleadsenseinfo.com",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.B.1.2",
  "Subtechnique": "T1071.001",
  "Subtechnique_Name": "Application Layer Protocol: Web Protocols",
  "TacticGroup": "Command and Control",
  "Technique": "T1071",
  "Technique_Name": "Application Layer Protocol"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [
    "Vendor stated that more information would be available if their firewall appliance was installed and activated."
  ],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: Encrypted C2 channel established using HTTPS",
  "ScreenshotDatasources": [],
  "Step": "11. Initial Compromise",
  "Substep": "11.B.1.3",
  "Subtechnique": "T1573.002",
  "Subtechnique_Name": "Encrypted Channel: Asymmetric Cryptography",
  "TacticGroup": "Command and Control",
  "Technique": "T1573",
  "Technique_Name": "Encrypted Channel"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing route.exe with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.",
    "The capability enriched route.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery)."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: 'route print' via PowerShell",
  "ScreenshotDatasources": [],
  "Step": "12. Initial Discovery",
  "Substep": "12.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1016",
  "Technique_Name": "System Network Configuration Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing ipconfig.exe with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.",
    "The capability enriched ipconfig.exe executing with the correct ATT&CK Technique (System Network Configuration Discovery)."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: 'ipconfig -all' via PowerShell",
  "ScreenshotDatasources": [],
  "Step": "12. Initial Discovery",
  "Substep": "12.A.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1016",
  "Technique_Name": "System Network Configuration Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing whoami.exe with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: 'whoami -all -fo list' via PowerShell",
  "ScreenshotDatasources": [],
  "Step": "12. Initial Discovery",
  "Substep": "12.B.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1033",
  "Technique_Name": "System Owner/User Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment",
    "Enrichment"
  ],
  "DetectionModifiers": [
    "Tainted",
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing qprocess.exe with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.",
    "The capability enriched qprocess.exe executing with a related ATT&CK Technique (System Service Discovery).",
    "The capability enriched the execution of qprocess.exe as the enumeration of running processes via the command line. The data was tainted by a parent alert on wscript.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: 'qprocess *' via PowerShell",
  "ScreenshotDatasources": [],
  "Step": "12. Initial Discovery",
  "Substep": "12.C.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1057",
  "Technique_Name": "Process Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment",
    "General Behavior"
  ],
  "DetectionModifiers": [
    "Tainted",
    "Tainted",
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing net.exe with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.",
    "The capability enriched net.exe executing as the execution of an enumeration command. The data was tainted by a parent alert on wscript.exe.",
    "A General Behavior alert was generated for net.exe executing as an enumeration command called by a commonly abused causality group owner (CGO, wscipt.exe). The data was tainted by a parent alert on wscript.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: 'net start' via PowerShell",
  "ScreenshotDatasources": [],
  "Step": "12. Initial Discovery",
  "Substep": "12.D.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1007",
  "Technique_Name": "System Service Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Indicator of Compromise",
    "Specific Behavior"
  ],
  "DetectionModifiers": [
    "Tainted",
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing with command-line arguments as well as PowerShell module (.psm) and script (.ps1) files being written to disk. The telemetry was tainted by a parent alert on wscript.exe.",
    "An Indicator of Compromise alert was generated identifying suspicious PowerShell strings as Empire WinEnum.",
    "A Specific Behavior alert was generated for PowerShell execution with base64 encoded commands. The alert was tainted by a parent alert on wscript.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: Built-in WinEnum module executed to programmatically execute a series of enumeration techniques",
  "ScreenshotDatasources": [],
  "Step": "12. Initial Discovery",
  "Substep": "12.E.1",
  "Subtechnique": "T1059.001",
  "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell",
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Indicator of Compromise"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "An Indicator of Compromise alert was generated identifying suspicious PowerShell strings as Empire UserInfo."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: WinEnum module included enumeration of user information",
  "ScreenshotDatasources": [],
  "Step": "12. Initial Discovery",
  "Substep": "12.E.1.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1033",
  "Technique_Name": "System Owner/User Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: WinEnum module included enumeration of AD group memberships",
  "ScreenshotDatasources": [],
  "Step": "12. Initial Discovery",
  "Substep": "12.E.1.2",
  "Subtechnique": "T1069.002",
  "Subtechnique_Name": "Permission Groups Discovery: Domain Groups",
  "TacticGroup": "Discovery",
  "Technique": "T1069",
  "Technique_Name": "Permission Groups Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: WinEnum module included enumeration of password policy information",
  "ScreenshotDatasources": [],
  "Step": "12. Initial Discovery",
  "Substep": "12.E.1.3",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1201",
  "Technique_Name": "Password Policy Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Enrichment"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "The capability enriched powershell.exe executing with command-line arguments as suspicious and the correct ATT&CK Technique (File and Directory Discovery)."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: WinEnum module included enumeration of recently opened files",
  "ScreenshotDatasources": [],
  "Step": "12. Initial Discovery",
  "Substep": "12.E.1.4.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "Technique_Name": "File and Directory Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Enrichment"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "The capability enriched powershell.exe executing with command-line arguments as suspicious and the correct ATT&CK Technique (File and Directory Discovery)."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: WinEnum module included enumeration of interesting files",
  "ScreenshotDatasources": [],
  "Step": "12. Initial Discovery",
  "Substep": "12.E.1.4.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "Technique_Name": "File and Directory Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Enrichment"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "The capability enriched powershell.exe executing with command-line arguments with the correct ATT&CK Technique (Clipboard Data)."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: WinEnum module included enumeration of clipboard contents",
  "ScreenshotDatasources": [],
  "Step": "12. Initial Discovery",
  "Substep": "12.E.1.5",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Collection",
  "Technique": "T1115",
  "Technique_Name": "Clipboard Data"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Indicator of Compromise"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "An Indicator of Compromise alert was generated identifying suspicious PowerShell strings as Empire SysImfo."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: WinEnum module included enumeration of system information",
  "ScreenshotDatasources": [],
  "Step": "12. Initial Discovery",
  "Substep": "12.E.1.6.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1082",
  "Technique_Name": "System Information Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: WinEnum module included enumeration of Windows update information",
  "ScreenshotDatasources": [],
  "Step": "12. Initial Discovery",
  "Substep": "12.E.1.6.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1082",
  "Technique_Name": "System Information Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Indicator of Compromise",
    "Enrichment"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "An Indicator of Compromise alert was generated identifying suspicious PowerShell strings as Empire SysImfo.",
    "The capability enriched the enumeration of system information via a Registry query as suspicious. The data was tainted by a parent alert on wscript.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: WinEnum module included enumeration of system information via a Registry query",
  "ScreenshotDatasources": [],
  "Step": "12. Initial Discovery",
  "Substep": "12.E.1.7",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1012",
  "Technique_Name": "Query Registry"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Enrichment"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "The capability enriched powershell.exe executing with command-line arguments with the correct ATT&CK Technique (System Service Discovery)."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: WinEnum module included enumeration of services",
  "ScreenshotDatasources": [],
  "Step": "12. Initial Discovery",
  "Substep": "12.E.1.8",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1007",
  "Technique_Name": "System Service Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Enrichment"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "The capability enriched powershell.exe executing with command-line arguments with the correct ATT&CK Technique (Network Share Discovery)."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: WinEnum module included enumeration of available shares",
  "ScreenshotDatasources": [],
  "Step": "12. Initial Discovery",
  "Substep": "12.E.1.9.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1135",
  "Technique_Name": "Network Share Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Enrichment"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "The capability enriched powershell.exe executing with command-line arguments with the correct ATT&CK Technique (Network Share Discovery)."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: WinEnum module included enumeration of mapped network drives",
  "ScreenshotDatasources": [],
  "Step": "12. Initial Discovery",
  "Substep": "12.E.1.9.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1135",
  "Technique_Name": "Network Share Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed an event log for the WMI query of the system AV products."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: WinEnum module included enumeration of AV solutions",
  "ScreenshotDatasources": [],
  "Step": "12. Initial Discovery",
  "Substep": "12.E.1.10.1",
  "Subtechnique": "T1518.001",
  "Subtechnique_Name": "Software Discovery: Security Software Discovery",
  "TacticGroup": "Discovery",
  "Technique": "T1518",
  "Technique_Name": "Software Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Enrichment"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "The capability enriched powershell.exe executing with command-line arguments with the correct ATT&CK Technique (Security Software Discovery)."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: WinEnum module included enumeration of firewall rules",
  "ScreenshotDatasources": [],
  "Step": "12. Initial Discovery",
  "Substep": "12.E.1.10.2",
  "Subtechnique": "T1518.001",
  "Subtechnique_Name": "Software Discovery: Security Software Discovery",
  "TacticGroup": "Discovery",
  "Technique": "T1518",
  "Technique_Name": "Software Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Indicator of Compromise"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "An Indicator of Compromise alert was generated identifying suspicious PowerShell strings as Empire NetInfo."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: WinEnum module included enumeration of network adapters",
  "ScreenshotDatasources": [],
  "Step": "12. Initial Discovery",
  "Substep": "12.E.1.11",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1016",
  "Technique_Name": "System Network Configuration Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Enrichment"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "The capability enriched powershell.exe executing with command-line arguments with the correct ATT&CK Technique (System Network Connections Discovery)."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: WinEnum module included enumeration of established network connections",
  "ScreenshotDatasources": [],
  "Step": "12. Initial Discovery",
  "Substep": "12.E.1.12",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1049",
  "Technique_Name": "System Network Connections Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment",
    "Enrichment",
    "Enrichment"
  ],
  "DetectionModifiers": [
    "Tainted",
    "Tainted",
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing net with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.",
    "The capability enriched net.exe executing with command-line arguments with the correct ATT&CK Technique (Permission Groups Discovery).",
    "The capability enriched the execution of net.exe and net1.exe as an enumeration command. The data was tainted by a parent alert on wscript.exe.",
    "The capability enriched the execution of net.exe and net1.exe as the possible enumeration of administrator groups. The data was tainted by a parent alert on wscript.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: 'net group \\\"Domain Admins\\\" -domain' via PowerShell",
  "ScreenshotDatasources": [],
  "Step": "12. Initial Discovery",
  "Substep": "12.F.1",
  "Subtechnique": "T1069.002",
  "Subtechnique_Name": "Permission Groups Discovery: Domain Groups",
  "TacticGroup": "Discovery",
  "Technique": "T1069",
  "Technique_Name": "Permission Groups Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment",
    "Enrichment"
  ],
  "DetectionModifiers": [
    "Tainted",
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing net with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.",
    "The capability enriched net.exe executing with command-line arguments with the correct ATT&CK Technique (Permission Groups Discovery).",
    "The capability enriched the execution of net.exe and net1.exe as the possible enumeration of administrator groups. The data was tainted by a parent alert on wscript.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: 'Net Localgroup Administrators' via PowerShell",
  "ScreenshotDatasources": [],
  "Step": "12. Initial Discovery",
  "Substep": "12.F.2",
  "Subtechnique": "T1069.001",
  "Subtechnique_Name": "Permission Groups Discovery: Local Groups",
  "TacticGroup": "Discovery",
  "Technique": "T1069",
  "Technique_Name": "Permission Groups Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing net with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.",
    "The capability enriched net.exe executing with command-line arguments with the correct ATT&CK Technique (Account Discovery)."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: 'net user' via PowerShell",
  "ScreenshotDatasources": [],
  "Step": "12. Initial Discovery",
  "Substep": "12.G.1",
  "Subtechnique": "T1087.001",
  "Subtechnique_Name": "Account Discovery: Local Account",
  "TacticGroup": "Discovery",
  "Technique": "T1087",
  "Technique_Name": "Account Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing net with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.",
    "The capability enriched net.exe executing with command-line arguments with the correct ATT&CK Technique (Account Discovery)."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: 'net user -domain' via PowerShell",
  "ScreenshotDatasources": [],
  "Step": "12. Initial Discovery",
  "Substep": "12.G.2",
  "Subtechnique": "T1087.002",
  "Subtechnique_Name": "Account Discovery: Domain Account",
  "TacticGroup": "Discovery",
  "Technique": "T1087",
  "Technique_Name": "Account Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment"
  ],
  "DetectionModifiers": [
    "Tainted",
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing net with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.",
    "The capability enriched the execution of net.exe and net1.exe as an enumeration command. The data was tainted by a parent alert on wscript.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: 'net group \\\"Domain Computers\\\" -domain' via PowerShell",
  "ScreenshotDatasources": [],
  "Step": "13. Discovery for Lateral Movement",
  "Substep": "13.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1018",
  "Technique_Name": "Remote System Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing net with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: 'net use' via PowerShell",
  "ScreenshotDatasources": [],
  "Step": "13. Discovery for Lateral Movement",
  "Substep": "13.B.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1049",
  "Technique_Name": "System Network Connections Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing netstat with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: 'netstat -ano' via PowerShell",
  "ScreenshotDatasources": [],
  "Step": "13. Discovery for Lateral Movement",
  "Substep": "13.B.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1049",
  "Technique_Name": "System Network Connections Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing reg with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.",
    "The capability enriched reg.exe executing with command-line arguments with the correct ATT&CK Technique (Query Registry)."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire:'reg query' via PowerShell to enumerate a specific Registry key",
  "ScreenshotDatasources": [],
  "Step": "13. Discovery for Lateral Movement",
  "Substep": "13.C.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1012",
  "Technique_Name": "Query Registry"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Indicator of Compromise"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed a process integrity level change from parent powershell.exe (medium / 8192) to child powershell.exe (high / 12288).",
    "An Indicator of Compromise alert was generated identifying a PowerShell Empire script performing the bypass UAC attack."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: Built-in UAC bypass token duplication module executed to launch new callback with elevated process integrity level",
  "ScreenshotDatasources": [],
  "Step": "14. Privilege Escalation",
  "Substep": "14.A.1.1",
  "Subtechnique": "T1548.002",
  "Subtechnique_Name": "Abuse Elevation Control Mechanism: Bypass User Account Control",
  "TacticGroup": "Privilege Escalation",
  "Technique": "T1548",
  "Technique_Name": "Abuse Elevation Control Mechanism"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: UAC bypass module downloaded and wrote a new Empire stager (wdbypass) to disk",
  "ScreenshotDatasources": [],
  "Step": "14. Privilege Escalation",
  "Substep": "14.A.1.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "None"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Minimum detection criteria was not met for this procedure."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: UAC bypass module downloaded a new Empire stager (wdbypass) over HTTP",
  "ScreenshotDatasources": [],
  "Step": "14. Privilege Escalation",
  "Substep": "14.A.1.3",
  "Subtechnique": "T1071.001",
  "Subtechnique_Name": "Application Layer Protocol: Web Protocols",
  "TacticGroup": "Command and Control",
  "Technique": "T1071",
  "Technique_Name": "Application Layer Protocol"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed an outgoing network connection to www.freegoogleadsenseinfo.com (C2 domain) over port 8080."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: UAC bypass module downloaded a new Empire stager (wdbypass) over port 8080",
  "ScreenshotDatasources": [],
  "Step": "14. Privilege Escalation",
  "Substep": "14.A.1.4",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1043",
  "Technique_Name": "Commonly Used Port"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Indicator of Compromise",
    "Enrichment"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "An Indicator of Compromise alert was generated identifying a PowerShell Empire script logging keys pressed, time, and the active window.",
    "The capability enriched the execution of a specific API call as keylogging and suspicious activity."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: Built-in keylogging module executed to capture keystrokes of user Bob",
  "ScreenshotDatasources": [],
  "Step": "15. Credential Access",
  "Substep": "15.A.1.1",
  "Subtechnique": "T1059.001",
  "Subtechnique_Name": "Command and Scripting Interpreter: PowerShell",
  "TacticGroup": "Collection",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Indicator of Compromise"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed the decoded PowerShell script, which includes the API call GetForegroundWindow to enumerate the active window.",
    "An Indicator of Compromise alert was generated identifying a PowerShell Empire script logging keys pressed, time, and the active window."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: Built-in keylogging module included residual enumeration of application windows",
  "ScreenshotDatasources": [],
  "Step": "15. Credential Access",
  "Substep": "15.A.1.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1010",
  "Technique_Name": "Application Window Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed a file read event for IT_tasks.txt."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: 'get-content' via PowerShell to collect sensitive file (it_tasks.txt) from a network shared drive (Wormshare) on Conficker (10.0.0.5)",
  "ScreenshotDatasources": [],
  "Step": "15. Credential Access",
  "Substep": "15.B.1",
  "Subtechnique": "T1552.001",
  "Subtechnique_Name": "Unsecured Credentials: Credentials in Files",
  "TacticGroup": "Credential Access",
  "Technique": "T1552",
  "Technique_Name": "Unsecured Credentials"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "General Behavior"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed repeated logon attempts via net.exe and command-line arguments indicative of password spraying. The telemetry was tainted by a parent alert on wscript.exe.",
    "A General Behavior alert was generated for sensitive administrative shares mapping with unexpected parent."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: 'net use' via PowerShell to brute force password spraying authentication attempts to Morris (10.0.1.4) and Nimda (10.0.1.6) targeting credentials of usersKmitnick, Bob, and Frieda",
  "ScreenshotDatasources": [],
  "Step": "16. Lateral Movement",
  "Substep": "16.A.1.1",
  "Subtechnique": "T1110.003",
  "Subtechnique_Name": "Brute Force: Password Spraying",
  "TacticGroup": "Credential Access",
  "Technique": "T1110",
  "Technique_Name": "Brute Force"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Specific Behavior"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed repeated logon attempts via net.exe and command-line arguments indicative of password spraying. The telemetry was tainted by a parent alert on wscript.exe.",
    "A Specific Behavior alert was generated for a net.exe logon attempt to ADMIN$. The alert was tagged with the correct ATT&CK Technique (Windows Admin Shares)."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: Brute force password spraying attempts targeted Windows admin shares on Morris (10.0.1.4) and Nimda (10.0.1.6)",
  "ScreenshotDatasources": [],
  "Step": "16. Lateral Movement",
  "Substep": "16.A.1.2",
  "Subtechnique": "T1021.002",
  "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares",
  "TacticGroup": "Lateral Movement",
  "Technique": "T1021",
  "Technique_Name": "Remote Services"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed a net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) using valid credentials for user Kmitnick followed by an event for the credentials being validated by the DC. The telemetry was tainted by a parent alert on wscript.exe.",
    "The capability enriched an lsass.exe event with the correct ATT&CK Technique (Valid Accounts)."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: 'net use' via PowerShell to successfully authenticate to Conficker (10.0.0.5) using credentials of user Kmitnick",
  "ScreenshotDatasources": [],
  "Step": "16. Lateral Movement",
  "Substep": "16.B.1.1",
  "Subtechnique": "T1078.003",
  "Subtechnique_Name": "Valid Accounts: Local Accounts",
  "TacticGroup": "Privilege Escalation",
  "Technique": "T1078",
  "Technique_Name": "Valid Accounts"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed a net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) as local Kmitnick. The telemetry was tainted by a parent alert on wscript.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: Successful authentication targeted Windows admin share on Conficker (10.0.0.5)",
  "ScreenshotDatasources": [],
  "Step": "16. Lateral Movement",
  "Substep": "16.B.1.2",
  "Subtechnique": "T1021.002",
  "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares",
  "TacticGroup": "Lateral Movement",
  "Technique": "T1021",
  "Technique_Name": "Remote Services"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed a net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) as local user Kmitnick followed by an event for the credentials being validated by the DC. The telemetry was tainted by a parent alert on wscript.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: Successful authentication to Conficker (10.0.0.5) using credentials of user Kmitnick as a result of the brute force password spraying",
  "ScreenshotDatasources": [],
  "Step": "16. Lateral Movement",
  "Substep": "16.B.1.3",
  "Subtechnique": "T1110.003",
  "Subtechnique_Name": "Brute Force: Password Spraying",
  "TacticGroup": "Credential Access",
  "Technique": "T1110",
  "Technique_Name": "Brute Force"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing net with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.",
    "The capability enriched net.exe executing with command-line arguments with the correct ATT&CK Technique (Network Share Connection Removal)."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: 'net use -delete' via PowerShell",
  "ScreenshotDatasources": [],
  "Step": "16. Lateral Movement",
  "Substep": "16.C.1",
  "Subtechnique": "T1070.005",
  "Subtechnique_Name": "Indicator Removal on Host: Network Share Connection Removal",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1070",
  "Technique_Name": "Indicator Removal on Host"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed a net.exe logon attempt to C$ on 10.0.0.4 (Creeper) using valid credentials for user Kmitnick. The telemetry was tainted by a parent alert on wscript.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: Successful authentication targeted Windows admin shares on Conficker (10.0.0.5)",
  "ScreenshotDatasources": [],
  "Step": "16. Lateral Movement",
  "Substep": "16.D.1.1",
  "Subtechnique": "T1021.002",
  "Subtechnique_Name": "Remote Services: SMB/Windows Admin Shares",
  "TacticGroup": "Lateral Movement",
  "Technique": "T1021",
  "Technique_Name": "Remote Services"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed a net.exe logon attempt to C$ on 10.0.0.4 (Creeper) using valid credentials for user Kmitnick followed by a event for a successful login. The telemetry was tainted by a parent alert on wscript.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: 'net use' via PowerShell to successfully authenticate to Creeper (10.0.0.4) using credentials of user Kmitnick",
  "ScreenshotDatasources": [],
  "Step": "16. Lateral Movement",
  "Substep": "16.D.1.2",
  "Subtechnique": "T1078.002",
  "Subtechnique_Name": "Valid Accounts: Domain Accounts",
  "TacticGroup": "Initial Access",
  "Technique": "T1078",
  "Technique_Name": "Valid Accounts"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed file create and write events for autoupdate.vbs."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: Built-in upload module executed to write malicious VBScript (autoupdate.vbs) to disk on CodeRed (10.0.1.5)",
  "ScreenshotDatasources": [],
  "Step": "16. Lateral Movement",
  "Substep": "16.E.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Indicator of Compromise",
    "Enrichment"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed cmd.exe executing autoupdate.vbs. The telemetry was tainted by a parent alert on wscript.exe.",
    "An Indicator of Compromise Alert was generated identify PowerShell Empire using the Runas functionality.",
    "The capability enriched wscript.exe executing autoupdate.vbs with a related ATT&CK Technique (Scripting)."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: Built-in runas module executed to launch malicious VBScript (autoupdate.vbs) as user Kmitnick",
  "ScreenshotDatasources": [],
  "Step": "16. Lateral Movement",
  "Substep": "16.F.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Execution",
  "Technique": "T1059",
  "Technique_Name": "Command and Scripting Interpreter"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Specific Behavior"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed file create and write events for update.vbs.",
    "A Specific Behavior alert was generated for a script being modified/moved to a remote location. The alert was tainted by a parent alert on wscript.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: Built-in move capability executed to write malicious VBScript (update.vbs) to disk on Creeper (10.0.0.4)",
  "ScreenshotDatasources": [],
  "Step": "16. Lateral Movement",
  "Substep": "16.G.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Lateral Movement",
  "Technique": "T1570",
  "Technique_Name": "Lateral Tool Transfer"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment",
    "General Behavior"
  ],
  "DetectionModifiers": [
    "Tainted",
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing sc with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.",
    "The capability enriched sc.exe executing with command-line arguments with the correct ATT&CK Technique (System Service Discovery).",
    "A General Behavior alert was generated for the sc utility be used to perform actions of remote services. The alert was tainted by a parent alert on wscript.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: 'sc query' via PowerShell to remotely enumerate services on Creeper (10.0.0.4)",
  "ScreenshotDatasources": [],
  "Step": "16. Lateral Movement",
  "Substep": "16.H.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1007",
  "Technique_Name": "System Service Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment",
    "Specific Behavior"
  ],
  "DetectionModifiers": [
    "Tainted",
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed execution of sc.exe with command-line arguments to create a new AdobeUpdater service containing a binPath pointed to cmd.exe with arguments to execute update.vbs. Telemetry also showed the creation of Registry keys associated with this new service. The telemetry was tainted by a parent alert on wscript.exe.",
    "The capability enriched sc.exe executing with the correct ATT&CK Technique (New Service).",
    "A Specific Behavior alert was generated for a new service created via the command line. The alert was tainted by a parent alert on wscript.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: 'sc create' via PowerShell to remotely create a service on Creeper (10.0.0.4)",
  "ScreenshotDatasources": [],
  "Step": "16. Lateral Movement",
  "Substep": "16.I.1.1",
  "Subtechnique": "T1543.003",
  "Subtechnique_Name": "Create or Modify System Process: Windows Service",
  "TacticGroup": "Privilege Escalation",
  "Technique": "T1543",
  "Technique_Name": "Create or Modify System Process"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed execution of sc.exe with command-line arguments to set the service description. An analyst could use this information to determine it is not a legitimate service. The telemetry was tainted by a parent alert on wscript.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: 'sc description' via PowerShell to remotely disguise a service on Creeper (10.0.0.4)",
  "ScreenshotDatasources": [],
  "Step": "16. Lateral Movement",
  "Substep": "16.I.1.2",
  "Subtechnique": "T1036.004",
  "Subtechnique_Name": "Masquerading: Masquerade Task or Service",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1036",
  "Technique_Name": "Masquerading"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment"
  ],
  "DetectionModifiers": [
    "Tainted",
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing sc.exe with command-line arguments. The telemetry was tainted by a parent alert on wscript.exe.",
    "The capability enriched powershell.exe executing sc.exe as enumeration of services via the command line. The data was tainted by a parent alert on wscript.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: 'sc qc' via PowerShell to remotely enumerate a specific service on Creeper (10.0.0.4)",
  "ScreenshotDatasources": [],
  "Step": "16. Lateral Movement",
  "Substep": "16.J.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1007",
  "Technique_Name": "System Service Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed a file read event for update.vbs. The telemetry was tainted by a parent alert on wscript.exe"
  ],
  "Footnotes": [
    "The process tree showing taintedness is visible within the same UI but did not fit within the current frame."
  ],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: 'type' via PowerShell to remotely enumerate a specific file (update.vbs) on Creeper (10.0.0.4)",
  "ScreenshotDatasources": [],
  "Step": "16. Lateral Movement",
  "Substep": "16.K.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "Technique_Name": "File and Directory Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing sc with command-line arguments. As part of the service, telemetry also showed cmd.exe executing update.vbs on 10.0.0.4 (Creeper). The telemetry was tainted by a parent alert on wscript.exe.",
    "The capability enriched sc.exe executing with command-line arguments with the correct ATT&CK Technique (Service Execution)."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: 'sc start' via PowerShell to remotely launch a specific service on Creeper (10.0.0.4)",
  "ScreenshotDatasources": [],
  "Step": "16. Lateral Movement",
  "Substep": "16.L.1",
  "Subtechnique": "T1569.002",
  "Subtechnique_Name": "System Services: Service Execution",
  "TacticGroup": "Execution",
  "Technique": "T1569",
  "Technique_Name": "System Services"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment",
    "Enrichment"
  ],
  "DetectionModifiers": [
    "Tainted",
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing reg with command-line arguments. The telemetry was tainted by a parent alert on cmd.exe.",
    "The capability enriched reg.exe executing with command-line arguments with the correct ATT&CK Technique (System Service Discovery).",
    "The capability enriched reg.exe executing with command-line arguments as the terminal server key queried by the reg utility. The data was tainted by a parent alert on cmd.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: 'reg query' via PowerShell to enumerate a specific Registry key associated with terminal services",
  "ScreenshotDatasources": [],
  "Step": "17. Persistence",
  "Substep": "17.A.1.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1007",
  "Technique_Name": "System Service Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment",
    "Enrichment"
  ],
  "DetectionModifiers": [
    "Tainted",
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing reg with command-line arguments to check if terminal services were enabled. The telemetry was tainted by a parent alert on cmd.exe.",
    "The capability enriched reg.exe executing with command-line arguments as the terminal server key queried by the reg utility. The data was tainted by a parent alert on cmd.exe.",
    "The capability enriched reg.exe executing with command-line arguments with a related ATT&CK Technique (System Service Discovery)."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: 'reg query' via PowerShell to enumerate a specific Registry key",
  "ScreenshotDatasources": [],
  "Step": "17. Persistence",
  "Substep": "17.A.1.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1012",
  "Technique_Name": "Query Registry"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment",
    "Enrichment"
  ],
  "DetectionModifiers": [
    "Tainted",
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing takeown with command-line arguments. The telemetry was tainted by a parent alert on cmd.exe.",
    "The capability enriched takeown.exe executing with command-line arguments as changing permission or ownership of a file or folder. The data was tainted by a parent alert on cmd.exe.",
    "The capability enriched reg.exe executing with command-line arguments with the correct ATT&CK Technique (File Permissions Modification)."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: 'takeown' via PowerShell to obtain ownership of magnify.exe",
  "ScreenshotDatasources": [],
  "Step": "17. Persistence",
  "Substep": "17.B.1",
  "Subtechnique": "T1222.001",
  "Subtechnique_Name": "File and Directory Permissions Modification: Windows File and Directory Permissions Modification",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1222",
  "Technique_Name": "File and Directory Permissions Modification"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed powershell.exe executing icalcs with command-line arguments. The telemetry was tainted by a parent alert on cmd.exe.",
    "The capability enriched icalcs.exe executing with command-line arguments with the correct ATT&CK Technique (File Permissions Modification)."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: 'icacls' via PowerShell to modify the DACL for magnify.exe",
  "ScreenshotDatasources": [],
  "Step": "17. Persistence",
  "Substep": "17.B.2",
  "Subtechnique": "T1222.001",
  "Subtechnique_Name": "File and Directory Permissions Modification: Windows File and Directory Permissions Modification",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1222",
  "Technique_Name": "File and Directory Permissions Modification"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed file write events overwriting magnify.exe in the system directory as well as the change in the hash of the file. The telemetry was tainted by a parent alert on cmd.exe."
  ],
  "Footnotes": [
    "The process tree showing taintedness is visible within the same UI but did not fit within the current frame."
  ],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: 'copy' via PowerShell to overwrite magnify.exe with cmd.exe",
  "ScreenshotDatasources": [],
  "Step": "17. Persistence",
  "Substep": "17.C.1",
  "Subtechnique": "T1546.008",
  "Subtechnique_Name": "Event Triggered Execution: Accessibility Features",
  "TacticGroup": "Persistence",
  "Technique": "T1546",
  "Technique_Name": "Event Triggered Execution"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed an event with the execution of the Get-ChildItem command. The telemetry was tainted by a parent alert on wscript.exe."
  ],
  "Footnotes": [
    "The process tree showing taintedness is visible within the same UI but did not fit within the current frame."
  ],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: 'Get-ChildItem' via PowerShell to enumerate a network shared drive (Wormshare) on Conficker (10.0.0.5)",
  "ScreenshotDatasources": [],
  "Step": "18. Collection",
  "Substep": "18.A.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1083",
  "Technique_Name": "File and Directory Discovery"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed file read and write events for the .vsdx file from the network shared drive on 10.0.0.5 (Conficker) to the Recycle Bin. The telemetry was tainted by a parent alert on wscript.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: 'copy' via PowerShell staged a file (Shockwave_network.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5) in the Recycle Bin (C:\\$Recycle.Bin) on CodeRed (10.0.1.5)",
  "ScreenshotDatasources": [],
  "Step": "18. Collection",
  "Substep": "18.B.1.1",
  "Subtechnique": "T1074.002",
  "Subtechnique_Name": "Data Staged: Remote Data Staging",
  "TacticGroup": "Collection",
  "Technique": "T1074",
  "Technique_Name": "Data Staged"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Specific Behavior"
  ],
  "DetectionModifiers": [
    "Tainted",
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed a file read event for the .vsdx file from the network shared drive on 10.0.0.5 (Conficker). The telemetry was tainted by a parent alert on wscript.exe.",
    "A Specific Behavior alert was generated for a script engine reading files from network locations. The alert was tainted by a parent alert on wscript.exe."
  ],
  "Footnotes": [
    "The process tree showing taintedness is visible within the same UI but did not fit within the current frame."
  ],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: 'copy' via PowerShell collected a file (Shockwave_network.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5)",
  "ScreenshotDatasources": [],
  "Step": "18. Collection",
  "Substep": "18.B.1.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Collection",
  "Technique": "T1039",
  "Technique_Name": "Data from Network Shared Drive"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed the MD5 and SHA256 hash values of recycler.exe when it was written to disk, which an analyst could use to determine recycler.exe was actually WinRAR. The telemetry was tainted by a parent alert on wscript.exe."
  ],
  "Footnotes": [
    "The process tree showing taintedness is visible within the same UI but did not fit within the current frame."
  ],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: File dropped to disk is a renamed copy of the WinRAR binary",
  "ScreenshotDatasources": [],
  "Step": "19. Exfiltration",
  "Substep": "19.A.1.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Defense Evasion",
  "Technique": "T1036",
  "Technique_Name": "Masquerading"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "General Behavior",
    "General Behavior"
  ],
  "DetectionModifiers": [
    "Tainted",
    "Tainted",
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed the file create and write events for recycler.exe. The telemetry was tainted by a parent alert on wscript.exe.",
    "A General Behavior alert was generated for executables created to disk by the Windows scripting engine. The alert was tainted by a parent alert on wscript.exe.",
    "A General Behavior alert was generated for PowerShell dropping an executable file to disk. The alert was tainted by a parent alert on wscript.exe."
  ],
  "Footnotes": [
    "The process tree showing taintedness is visible within the same UI but did not fit within the current frame."
  ],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: Built-in upload module executed to write binary (recycler.exe) to disk on CodeRed (10.0.1.5)",
  "ScreenshotDatasources": [],
  "Step": "19. Exfiltration",
  "Substep": "19.A.1.2",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Command and Control",
  "Technique": "T1105",
  "Technique_Name": "Ingress Tool Transfer"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed recycler.exe with full command-line arguments, including the use of the -hp flag to encrypt and compress data, indicating the WinRAR utility was in use. The telemetry was tainted by a parent alert on wscript.exe"
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: Executed binary (recycler.exe) created compressed archive (old.rar) of previously collected file",
  "ScreenshotDatasources": [],
  "Step": "19. Exfiltration",
  "Substep": "19.B.1.1",
  "Subtechnique": "T1560.001",
  "Subtechnique_Name": "Archive Collected Data: Archive via Utility",
  "TacticGroup": "Collection",
  "Technique": "T1560",
  "Technique_Name": "Archive Collected Data"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed recycler.exe with full command-line arguments, including the use of the -hp flag to encrypt and compress data, indicating the WinRAR utility was in use. tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine"
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: Executed binary (recycler.exe) created encrypted archive (old.rar) of previously collected file",
  "ScreenshotDatasources": [],
  "Step": "19. Exfiltration",
  "Substep": "19.B.1.2",
  "Subtechnique": "T1560.001",
  "Subtechnique_Name": "Archive Collected Data: Archive via Utility",
  "TacticGroup": "Collection",
  "Technique": "T1560",
  "Technique_Name": "Archive Collected Data"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed recycler.exe with full command-line arguments, including the use of the -hp flag to encrypt and compress data, indicating the WinRAR utility was in use. The telemetry was tainted by a parent alert on wscript.exe",
    "The capability enriched recylcer.exe executing with command-line arguments with a related ATT&CK Technique (Masquerading)."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: Executed binary (recycler.exe) is a renamed copy of the WinRAR binary",
  "ScreenshotDatasources": [],
  "Step": "19. Exfiltration",
  "Substep": "19.B.1.3",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Defense Evasion",
  "Technique": "T1036",
  "Technique_Name": "Masquerading"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment"
  ],
  "DetectionModifiers": [
    "Tainted",
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed the execution of ftp.exe and command-line arguments as well as a an outbound FTP connection to 192.168.0.4 (C2 server) on TCP port 21. The telemetry was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine.",
    "The capability enriched ftp.exe as the execution of a CLI file transfer/copy utility. The data was tainted by a parent alert related to Resume Viewer.exe and suspicious execution of the Windows Scripting Engine."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: Sequence of 'echo' commands via PowerShell to populate commands in text file (ftp.txt), which is then executed by FTP to exfil data through network connection separate of existing C2 channel",
  "ScreenshotDatasources": [],
  "Step": "19. Exfiltration",
  "Substep": "19.C.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Exfiltration",
  "Technique": "T1048",
  "Technique_Name": "Exfiltration Over Alternative Protocol"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed the file delete event for old.rar. The telemetry was tainted by a parent alert on wscript.exe."
  ],
  "Footnotes": [
    "The process tree showing taintedness is visible within the same UI but did not fit within the current frame."
  ],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: 'del C:\\\\\"$\\\"Recycle.bin\\old.rar'",
  "ScreenshotDatasources": [],
  "Step": "19. Exfiltration",
  "Substep": "19.D.1",
  "Subtechnique": "T1070.004",
  "Subtechnique_Name": "Indicator Removal on Host: File Deletion",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1070",
  "Technique_Name": "Indicator Removal on Host"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [
    "Tainted"
  ],
  "DetectionText": [
    "Telemetry showed the file delete event for recycler.exe. The telemetry was tainted by a parent alert on wscript.exe."
  ],
  "Footnotes": [
    "The process tree showing taintedness is visible within the same UI but did not fit within the current frame."
  ],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Empire: 'del recycler.exe'",
  "ScreenshotDatasources": [],
  "Step": "19. Exfiltration",
  "Substep": "19.D.2",
  "Subtechnique": "T1070.004",
  "Subtechnique_Name": "Indicator Removal on Host: File Deletion",
  "TacticGroup": "Defense Evasion",
  "Technique": "T1070",
  "Technique_Name": "Indicator Removal on Host"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed magnify.exe executing from utilman.exe."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "magnifer.exe previously overwritten by cmd.exe launched through RDP connection made to Creeper (10.0.0.4)",
  "ScreenshotDatasources": [],
  "Step": "20. Execution of Persistence",
  "Substep": "20.A.1.1",
  "Subtechnique": "T1546.008",
  "Subtechnique_Name": "Event Triggered Execution: Accessibility Features",
  "TacticGroup": "Persistence",
  "Technique": "T1546",
  "Technique_Name": "Event Triggered Execution"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": "",
  "Datasources": [],
  "Detection": [
    "Telemetry"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed an inbound connection to Creeper (10.0.0.4) on port 3389."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "RDP connection made to Creeper (10.0.0.4) as part of execution of persistence mechanism",
  "ScreenshotDatasources": [],
  "Step": "20. Execution of Persistence",
  "Substep": "20.A.1.2",
  "Subtechnique": "T1021.001",
  "Subtechnique_Name": "Remote Services: Remote Desktop Protocol",
  "TacticGroup": "Lateral Movement",
  "Technique": "T1021",
  "Technique_Name": "Remote Services"
}
{
  "Adversary": "apt3",
  "Capability_Requirements": [],
  "Criteria": null,
  "Datasources": [],
  "Detection": [
    "Telemetry",
    "Enrichment"
  ],
  "DetectionModifiers": [],
  "DetectionText": [
    "Telemetry showed magnify.exe executing whoami.exe.",
    "The capability enriched whoami.exe executing as an enumeration command."
  ],
  "Footnotes": [],
  "Participant_Name": "paloaltonetworks",
  "Procedure": "Executed 'whoami' via cmd persistence mechanism through RDP connection made to Creeper (10.0.0.4)",
  "ScreenshotDatasources": [],
  "Step": "20. Execution of Persistence",
  "Substep": "20.B.1",
  "Subtechnique": null,
  "Subtechnique_Name": null,
  "TacticGroup": "Discovery",
  "Technique": "T1033",
  "Technique_Name": "System Owner/User Discovery"
}
